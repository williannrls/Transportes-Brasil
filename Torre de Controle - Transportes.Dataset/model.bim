{
  "compatibilityLevel": 1567,
  "model": {
    "annotations": [
      {
        "name": "__PBI_TimeIntelligenceEnabled",
        "value": "0"
      },
      {
        "name": "PBIDesktopVersion",
        "value": "2.124.1554.0 (23.12)"
      },
      {
        "name": "PBI_QueryOrder",
        "value": "[\"fato_nf\",\"fato_cte\",\"fato_carta_frete\",\"dimSOURCE\",\"dimFROTA\",\"dimROTAS_DISTANCIAS\",\"Erros em dimROTAS_DISTANCIAS\",\"dim_UNIDADES\",\"dimPLACA_FROTA\",\"fato_meta_frota\",\"fato_meta_plano\",\"Base_Alelo_A\",\"Base_Alelo_M\",\"Base_Alelo_Nordeste\",\"fato_alelo\",\"fato_despesa_frota_plano\",\"dimDEXPARA_PLACAS_FROTA\",\"fato_despesa_carta_frete\",\"dim_VEICULOS\",\"dim_MERCADORIA\",\"dimMOTORISTA\",\"dim_CONHECIMENTO_NF\",\"Erros em fato_cte\",\"dim_nf_cte_CC\",\"fato_cte_ajuste_cc\"]"
      },
      {
        "name": "PBI_ProTooling",
        "value": "[\"DaxQueryView_Desktop\",\"CalcGroup\",\"DevMode\"]"
      }
    ],
    "culture": "pt-BR",
    "cultures": [
      {
        "name": "pt-BR",
        "linguisticMetadata": {
          "content": {
            "DynamicImprovement": "HighConfidence",
            "Language": "en-US",
            "Version": "1.0.0"
          },
          "contentType": "json"
        }
      }
    ],
    "dataAccessOptions": {
      "legacyRedirects": true,
      "returnErrorValuesAsNull": true
    },
    "defaultPowerBIDataSourceVersion": "powerBI_V3",
    "discourageImplicitMeasures": true,
    "expressions": [
      {
        "name": "Erros em dimROTAS_DISTANCIAS",
        "annotations": [
          {
            "name": "PBI_NavigationStepName",
            "value": "Navegação"
          },
          {
            "name": "PBI_ResultType",
            "value": "Table"
          }
        ],
        "expression": [
          "let",
          "Fonte = dimROTAS_DISTANCIAS,",
          "  #\"Incompatibilidades de Tipo Detectadas\" = let",
          "    tableWithOnlyPrimitiveTypes = Table.SelectColumns(Fonte, Table.ColumnsOfType(Fonte, {type nullable number, type nullable text, type nullable logical, type nullable date, type nullable datetime, type nullable datetimezone, type nullable time, type nullable duration})),",
          "    recordTypeFields = Type.RecordFields(Type.TableRow(Value.Type(tableWithOnlyPrimitiveTypes))),",
          "    fieldNames = Record.FieldNames(recordTypeFields),",
          "    fieldTypes = List.Transform(Record.ToList(recordTypeFields), each [Type]),",
          "    pairs = List.Transform(List.Positions(fieldNames), (i) => {fieldNames{i}, (v) => if v = null or Value.Is(v, fieldTypes{i}) then v else error [Message = \"O tipo do valor não corresponde ao tipo da coluna.\", Detail = v], fieldTypes{i}})",
          "in",
          "    Table.TransformColumns(Fonte, pairs),",
          "  #\"Índice Adicionado\" = Table.AddIndexColumn(#\"Incompatibilidades de Tipo Detectadas\", \"Número da Linha\" ,1),",
          "  #\"Erros Mantidos\" = Table.SelectRowsWithErrors(#\"Índice Adicionado\", {\"Local_coleta\", \"Local_entrega\", \"Rota\", \"Lat_origem\", \"Lon_origem\", \"Lat_destino\", \"Lon_destino\", \"Distancia (KM)\", \"Distancia (M)\"}),",
          "  #\"Colunas Reordenadas\" = Table.ReorderColumns(#\"Erros Mantidos\", {\"Número da Linha\", \"Local_coleta\", \"Local_entrega\", \"Rota\", \"Lat_origem\", \"Lon_origem\", \"Lat_destino\", \"Lon_destino\", \"Distancia (KM)\", \"Distancia (M)\"})",
          "in",
          "  #\"Colunas Reordenadas\""
        ],
        "kind": "m",
        "lineageTag": "c10f5998-b136-41f1-8af1-64721294946c",
        "queryGroup": "Erros na Consulta - 07/02/2023 15:25:06"
      },
      {
        "name": "Base_Alelo_A",
        "annotations": [
          {
            "name": "PBI_NavigationStepName",
            "value": "Navegação"
          },
          {
            "name": "PBI_ResultType",
            "value": "Table"
          }
        ],
        "expression": [
          "let",
          "    Fonte = PowerPlatform.Dataflows(null),",
          "    Workspaces = Fonte{[Id=\"Workspaces\"]}[Data],",
          "    #\"a1ef6347-b59b-4726-8b63-60a42715d9c5\" = Workspaces{[workspaceId=\"a1ef6347-b59b-4726-8b63-60a42715d9c5\"]}[Data],",
          "    #\"2ec40300-0fd5-4b07-9134-9a36473d39b0\" = #\"a1ef6347-b59b-4726-8b63-60a42715d9c5\"{[dataflowId=\"2ec40300-0fd5-4b07-9134-9a36473d39b0\"]}[Data],",
          "    Base_Alelo_A_ = #\"2ec40300-0fd5-4b07-9134-9a36473d39b0\"{[entity=\"Base_Alelo_A\",version=\"\"]}[Data]",
          "in",
          "    Base_Alelo_A_"
        ],
        "kind": "m",
        "lineageTag": "d1e4d121-1fb3-4ae3-a39f-f8aadaf79b1d"
      },
      {
        "name": "Base_Alelo_M",
        "annotations": [
          {
            "name": "PBI_NavigationStepName",
            "value": "Navegação"
          },
          {
            "name": "PBI_ResultType",
            "value": "Table"
          }
        ],
        "expression": [
          "let",
          "    Fonte = PowerPlatform.Dataflows(null),",
          "    Workspaces = Fonte{[Id=\"Workspaces\"]}[Data],",
          "    #\"a1ef6347-b59b-4726-8b63-60a42715d9c5\" = Workspaces{[workspaceId=\"a1ef6347-b59b-4726-8b63-60a42715d9c5\"]}[Data],",
          "    #\"2ec40300-0fd5-4b07-9134-9a36473d39b0\" = #\"a1ef6347-b59b-4726-8b63-60a42715d9c5\"{[dataflowId=\"2ec40300-0fd5-4b07-9134-9a36473d39b0\"]}[Data],",
          "    Base_Alelo_M_ = #\"2ec40300-0fd5-4b07-9134-9a36473d39b0\"{[entity=\"Base_Alelo_M\",version=\"\"]}[Data]",
          "in",
          "    Base_Alelo_M_"
        ],
        "kind": "m",
        "lineageTag": "9bb52489-5835-4db7-b56c-92afc9607f22"
      },
      {
        "name": "Base_Alelo_Nordeste",
        "annotations": [
          {
            "name": "PBI_NavigationStepName",
            "value": "Navegação"
          },
          {
            "name": "PBI_ResultType",
            "value": "Table"
          }
        ],
        "expression": [
          "let",
          "    Fonte = PowerPlatform.Dataflows(null),",
          "    Workspaces = Fonte{[Id=\"Workspaces\"]}[Data],",
          "    #\"a1ef6347-b59b-4726-8b63-60a42715d9c5\" = Workspaces{[workspaceId=\"a1ef6347-b59b-4726-8b63-60a42715d9c5\"]}[Data],",
          "    #\"2ec40300-0fd5-4b07-9134-9a36473d39b0\" = #\"a1ef6347-b59b-4726-8b63-60a42715d9c5\"{[dataflowId=\"2ec40300-0fd5-4b07-9134-9a36473d39b0\"]}[Data],",
          "    Base_Alelo_Nordeste_ = #\"2ec40300-0fd5-4b07-9134-9a36473d39b0\"{[entity=\"Base_Alelo_Nordeste\",version=\"\"]}[Data]",
          "in",
          "    Base_Alelo_Nordeste_"
        ],
        "kind": "m",
        "lineageTag": "2639caa7-bb35-42fb-bca1-4a86737193f8"
      },
      {
        "name": "dimDEXPARA_PLACAS_FROTA",
        "annotations": [
          {
            "name": "PBI_NavigationStepName",
            "value": "Navegação"
          },
          {
            "name": "PBI_ResultType",
            "value": "Table"
          }
        ],
        "expression": [
          "let",
          "    Fonte = Table.FromRows(Json.Document(Binary.Decompress(Binary.FromText(\"Tc9LDsIwDEXRvXTcQZw4TjMs0C9FCBADVHX/28D5uZldHT3Vzb43w/g0WvmmjXXlOlrWz9c5iso1U9JxWLSzyBpq5spq0JqkZuDKisrnLfZetkhOZZ24TgVRqBRF6y+QKJ1KrijXqZ1ol/Q9E0Lccg2Qto/tBxrDi0NdMb34tW58zbKGmrii3mcNKvxvqIuCU0EUKtWiulIraiv1or7oAsrrqAv0XEUNFb2RqPH52mJWucaKoiiKqmyxD9vjDw==\", BinaryEncoding.Base64), Compression.Deflate)), let _t = ((type nullable text) meta [Serialized.Text = true]) in type table [DE = _t, PARA = _t]),",
          "    #\"Tipo Alterado\" = Table.TransformColumnTypes(Fonte,{{\"DE\", type text}, {\"PARA\", type text}})",
          "in",
          "    #\"Tipo Alterado\""
        ],
        "kind": "m",
        "lineageTag": "3afb8452-3503-45af-bb1b-0ad79ff6d70c"
      },
      {
        "name": "Erros em fato_cte",
        "annotations": [
          {
            "name": "PBI_NavigationStepName",
            "value": "Navegação"
          },
          {
            "name": "PBI_ResultType",
            "value": "Table"
          }
        ],
        "expression": [
          "let",
          "Fonte = fato_cte,",
          "  #\"Incompatibilidades de Tipo Detectadas\" = let",
          "    tableWithOnlyPrimitiveTypes = Table.SelectColumns(Fonte, Table.ColumnsOfType(Fonte, {type nullable number, type nullable text, type nullable logical, type nullable date, type nullable datetime, type nullable datetimezone, type nullable time, type nullable duration})),",
          "    recordTypeFields = Type.RecordFields(Type.TableRow(Value.Type(tableWithOnlyPrimitiveTypes))),",
          "    fieldNames = Record.FieldNames(recordTypeFields),",
          "    fieldTypes = List.Transform(Record.ToList(recordTypeFields), each [Type]),",
          "    pairs = List.Transform(List.Positions(fieldNames), (i) => {fieldNames{i}, (v) => if v = null or Value.Is(v, fieldTypes{i}) then v else error [Message = \"O tipo do valor não corresponde ao tipo da coluna.\", Detail = v], fieldTypes{i}})",
          "in",
          "    Table.TransformColumns(Fonte, pairs),",
          "  #\"Índice Adicionado\" = Table.AddIndexColumn(#\"Incompatibilidades de Tipo Detectadas\", \"Número da Linha\" ,1),",
          "  #\"Erros Mantidos\" = Table.SelectRowsWithErrors(#\"Índice Adicionado\", {\"UNIDADE_NEGOCIO\", \"PRESTADOR_SERVICO_RAZAO_SOCIAL\", \"COD_CENTRO_CUSTO_GERENCIAL\", \"CENTRO_CUSTO_GERENCIAL\", \"OPERACAO\", \"CENTRO_CUSTO\", \"NUM_ROMANEIO\", \"NUM_CONHECIMENTO\", \"SERIE\", \"DATA_EMISSAO\", \"NOTAS_FISCAIS\", \"COB_CNPJ_CPF\", \"COB_RAZAO_SOCIAL\", \"VALOR_TOTAL_MERCADORIA\", \"GRIS\", \"VALOR_ICMS\", \"TOTAL_CONHECIMENTO\", \"TOTAL_CONHECIMENTO_LIQUIDO\", \"TOTAL_CONHECIMENTO_SEM_IMPOSTO\", \"SIGLA_UF_COLETA\", \"NOME_LOCAL_COLETA\", \"SIGLA_UF_ENTREGA\", \"NOME_LOCAL_ENTREGA\", \"TIPO_VEICULO\", \"PLACA_TRACAO\", \"PROP_CNPJ_CPF\", \"PROP_RAZAO_SOCIAL\", \"NOME_MOTORISTA\", \"MERCADORIA\", \"PESO\", \"VOLUME\", \"NATUREZA_OPERACAO\", \"CONHECIMENTO_TIPO\", \"STATUS_CTE\", \"VALOR_FATURAMENTO\", \"FRETE_VALOR\", \"VALOR_ADVALOREM\", \"VALOR_PEDAGIO\", \"VALOR_ESTACIONAMENTO\", \"VALOR_ESCOLTA\", \"VALOR_TAXA_EMISSAO\", \"VALOR_RCTRC\", \"OUTROS\", \"VALOR_DTA_AEREA\", \"VALOR_AJUDANTE\", \"VALOR_OUTROS\", \"VALOR_EXCESSO_PESO\", \"VALOR_DEVOLUCAO_ME\", \"VALOR_DEV_MD\", \"ADICIONAL_IMO\", \"VALOR_COLETA_ME\", \"VALOR_IMO\", \"source\", \"ROTA\", \"DATA_EMISSAO_BACKUP\", \"Lat_origem\", \"Lon_origem\", \"Lat_destino\", \"Lon_destino\", \"Distancia (KM)\", \"Distancia (M)\", \"CC Resumido\"}),",
          "  #\"Colunas Reordenadas\" = Table.ReorderColumns(#\"Erros Mantidos\", {\"Número da Linha\", \"UNIDADE_NEGOCIO\", \"PRESTADOR_SERVICO_RAZAO_SOCIAL\", \"COD_CENTRO_CUSTO_GERENCIAL\", \"CENTRO_CUSTO_GERENCIAL\", \"OPERACAO\", \"CENTRO_CUSTO\", \"NUM_ROMANEIO\", \"NUM_CONHECIMENTO\", \"SERIE\", \"DATA_EMISSAO\", \"NOTAS_FISCAIS\", \"COB_CNPJ_CPF\", \"COB_RAZAO_SOCIAL\", \"VALOR_TOTAL_MERCADORIA\", \"GRIS\", \"VALOR_ICMS\", \"TOTAL_CONHECIMENTO\", \"TOTAL_CONHECIMENTO_LIQUIDO\", \"TOTAL_CONHECIMENTO_SEM_IMPOSTO\", \"SIGLA_UF_COLETA\", \"NOME_LOCAL_COLETA\", \"SIGLA_UF_ENTREGA\", \"NOME_LOCAL_ENTREGA\", \"TIPO_VEICULO\", \"PLACA_TRACAO\", \"PROP_CNPJ_CPF\", \"PROP_RAZAO_SOCIAL\", \"NOME_MOTORISTA\", \"MERCADORIA\", \"PESO\", \"VOLUME\", \"NATUREZA_OPERACAO\", \"CONHECIMENTO_TIPO\", \"STATUS_CTE\", \"VALOR_FATURAMENTO\", \"FRETE_VALOR\", \"VALOR_ADVALOREM\", \"VALOR_PEDAGIO\", \"VALOR_ESTACIONAMENTO\", \"VALOR_ESCOLTA\", \"VALOR_TAXA_EMISSAO\", \"VALOR_RCTRC\", \"OUTROS\", \"VALOR_DTA_AEREA\", \"VALOR_AJUDANTE\", \"VALOR_OUTROS\", \"VALOR_EXCESSO_PESO\", \"VALOR_DEVOLUCAO_ME\", \"VALOR_DEV_MD\", \"ADICIONAL_IMO\", \"VALOR_COLETA_ME\", \"VALOR_IMO\", \"source\", \"ROTA\", \"DATA_EMISSAO_BACKUP\", \"Lat_origem\", \"Lon_origem\", \"Lat_destino\", \"Lon_destino\", \"Distancia (KM)\", \"Distancia (M)\", \"CC Resumido\"})",
          "in",
          "  #\"Colunas Reordenadas\""
        ],
        "kind": "m",
        "lineageTag": "3374eeab-0158-4b4c-8912-183967584b59",
        "queryGroup": "Erros na Consulta - 14/12/2023 13:43:21"
      },
      {
        "name": "dim_nf_cte_CC",
        "annotations": [
          {
            "name": "PBI_NavigationStepName",
            "value": "Navegação"
          },
          {
            "name": "PBI_ResultType",
            "value": "Table"
          }
        ],
        "expression": [
          "let",
          "    Fonte = Value.NativeQuery(Databricks.Catalogs(\"adb-1220993250695902.2.azuredatabricks.net\", \"/sql/1.0/warehouses/6b94e3b6ef796336\", [Catalog=\"hive_metastore\", Database=null, EnableAutomaticProxyDiscovery=null]){[Name=\"hive_metastore\",Kind=\"Database\"]}[Data], \"",
          "select ",
          "UNIDADE_NEGOCIO,",
          "PRESTADOR_SERVICO_RAZAO_SOCIAL,",
          "case ",
          "  when trim(DESCRICAO_ORGANIZACIONAL) = '' and source regexp 'LOGIX|logix' then 'C.C Indefinido'",
          "  else coalesce(DESCRICAO_ORGANIZACIONAL, 'C.C Indefinido')",
          "  end as DESCRICAO_ORGANIZACIONAL,",
          "CENTRO_CUSTO,",
          "upper(OPERACAO) as OPERACAO,",
          "NUM_ROMANEIO,",
          "NUM_NOTA_FISCAL,",
          "SERIE,",
          "DATA_EMISSAO,",
          "NOTAS_FISCAIS,",
          "upper(COB_RAZAO_SOCIAL) as COB_RAZAO_SOCIAL,",
          "CALC_VALOR_TOTAL_PRODUTOS,",
          "GRIS,",
          "SERV_ISS_VALOR,",
          "CALC_VALOR_TOTAL_NOTA,",
          "PEDAGIO,",
          "upper(SIGLA_UF_COLETA) as SIGLA_UF_COLETA,",
          "upper(SIGLA_UF_ENTREGA) as SIGLA_UF_ENTREGA,",
          "upper(NOME_LOCAL_COLETA) as NOME_LOCAL_COLETA,",
          "upper(NOME_LOCAL_ENTREGA) as NOME_LOCAL_ENTREGA,",
          "TIPO_VEICULO,",
          "replace(upper(PLACA_TRACAO), '-', '') as PLACA_TRACAO,",
          "replace(replace(replace(PROP_CNPJ_CPF, '-', ''),'/',''),'.','') as PROP_CNPJ_CPF,",
          "PROP_RAZAO_SOCIAL,",
          "upper(NOME_MOTORISTA) as NOME_MOTORISTA,",
          "MERCADORIA,",
          "PESO,",
          "VOLUME,",
          "FRETE,",
          "FRETE_PESO,",
          "VALOR_ADVALOREM,",
          "VALOR_PEDAGIO,",
          "VALOR_ESTACIONAMENTO,",
          "VALOR_ESCOLTA,",
          "VALOR_TAXA_EMISSAO,",
          "VALOR_RCTRC,",
          "FRETE_VALOR,",
          "OUTROS,",
          "VALOR_DTA_AEREA,",
          "VALOR_AJUDANTE,",
          "VALOR_OUTROS,",
          "VALOR_EXCESSO_PESO,",
          "VALOR_IMO,",
          "VALOR_COLETA_ME,",
          "VALOR_DECOLUCAO_ME,",
          "TOTAL_VIAGEM,",
          "CONHECIMENTO_TIPO,",
          "FRETE_UNITARIO,",
          "upper(source) as source,",
          "TIPO_NOTA_FISCAL,",
          "upper(replace( trim( concat(NOME_LOCAL_COLETA,'/', SIGLA_UF_COLETA, 'X', NOME_LOCAL_ENTREGA, '/', SIGLA_UF_ENTREGA)) ,' ', '')) AS ROTA",
          "from ouro_transportes.fato_nf ",
          "where CANCELADA = 'Não' ",
          "and DATA_EMISSAO >= '2021-01-01'\", null, [EnableFolding=true]),",
          "    #\"Coluna Duplicada\" = Table.DuplicateColumn(Fonte, \"DATA_EMISSAO\", \"DATA_EMISSAO - Copiar\"),",
          "    #\"Colunas Renomeadas\" = Table.RenameColumns(#\"Coluna Duplicada\",{{\"DATA_EMISSAO - Copiar\", \"DATA_EMISSAO_BACKUP\"}}),",
          "    #\"DATA_EMISSAO p/ data\" = Table.TransformColumnTypes(#\"Colunas Renomeadas\",{{\"DATA_EMISSAO\", type date}}),",
          "    #\"Duplicatas Removidas\" = Table.Distinct(#\"DATA_EMISSAO p/ data\", {\"DESCRICAO_ORGANIZACIONAL\",\"NUM_ROMANEIO\",\"UNIDADE_NEGOCIO\",\"DATA_EMISSAO\"}),",
          "    #\"Linhas Agrupadas\" = Table.Group(#\"Duplicatas Removidas\", {\"UNIDADE_NEGOCIO\", \"PRESTADOR_SERVICO_RAZAO_SOCIAL\", \"NUM_ROMANEIO\", \"DATA_EMISSAO\"}, {{\"Tabelatodaslinhas\", each _, type table [UNIDADE_NEGOCIO=nullable text, PRESTADOR_SERVICO_RAZAO_SOCIAL=nullable text, DESCRICAO_ORGANIZACIONAL=nullable text, CENTRO_CUSTO=nullable text, OPERACAO=nullable text, NUM_ROMANEIO=nullable text, NUM_NOTA_FISCAL=nullable text, SERIE=nullable text, DATA_EMISSAO=nullable date, NOTAS_FISCAIS=nullable text, COB_RAZAO_SOCIAL=nullable text, CALC_VALOR_TOTAL_PRODUTOS=nullable number, GRIS=nullable number, SERV_ISS_VALOR=nullable number, CALC_VALOR_TOTAL_NOTA=nullable number, PEDAGIO=nullable number, SIGLA_UF_COLETA=nullable text, SIGLA_UF_ENTREGA=nullable text, NOME_LOCAL_COLETA=nullable text, NOME_LOCAL_ENTREGA=nullable text, TIPO_VEICULO=nullable text, PLACA_TRACAO=nullable text, PROP_CNPJ_CPF=nullable text, PROP_RAZAO_SOCIAL=nullable text, NOME_MOTORISTA=nullable text, MERCADORIA=nullable text, PESO=nullable number, VOLUME=nullable number, FRETE=nullable number, FRETE_PESO=nullable number, VALOR_ADVALOREM=nullable number, VALOR_PEDAGIO=nullable number, VALOR_ESTACIONAMENTO=nullable number, VALOR_ESCOLTA=nullable number, VALOR_TAXA_EMISSAO=nullable number, VALOR_RCTRC=nullable number, FRETE_VALOR=nullable number, OUTROS=nullable number, VALOR_DTA_AEREA=nullable number, VALOR_AJUDANTE=nullable number, VALOR_OUTROS=nullable number, VALOR_EXCESSO_PESO=nullable number, VALOR_IMO=nullable number, VALOR_COLETA_ME=nullable number, VALOR_DECOLUCAO_ME=nullable number, TOTAL_VIAGEM=nullable number, CONHECIMENTO_TIPO=nullable text, FRETE_UNITARIO=nullable number, source=nullable text, TIPO_NOTA_FISCAL=nullable text, ROTA=nullable text, DATA_EMISSAO_BACKUP=nullable datetime]}}),",
          "    #\"Personalização Adicionada\" = Table.AddColumn(#\"Linhas Agrupadas\", \"colunahistoricosozinha\", each Table.SelectColumns([Tabelatodaslinhas],{\"DESCRICAO_ORGANIZACIONAL\"})),",
          "    #\"Personalização Adicionada1\" = Table.AddColumn(#\"Personalização Adicionada\", \"TabelaParaLista\", each Table.ToList([colunahistoricosozinha])),",
          "    #\"Valores Extraídos\" = Table.TransformColumns(#\"Personalização Adicionada1\", {\"TabelaParaLista\", each Text.Combine(List.Transform(_, Text.From), \" x \"), type text}),",
          "    #\"Colunas Removidas\" = Table.RemoveColumns(#\"Valores Extraídos\",{\"Tabelatodaslinhas\", \"colunahistoricosozinha\"}),",
          "    #\"Consulta Acrescentada\" = Table.Combine({#\"Colunas Removidas\", fato_cte_ajuste_cc})",
          "in",
          "    #\"Consulta Acrescentada\""
        ],
        "kind": "m",
        "lineageTag": "9de49902-960f-437f-a7fb-c0a40edba4cf"
      },
      {
        "name": "fato_cte_ajuste_cc",
        "annotations": [
          {
            "name": "PBI_NavigationStepName",
            "value": "Navegação"
          },
          {
            "name": "PBI_ResultType",
            "value": "Table"
          }
        ],
        "expression": [
          "let",
          "    Fonte = Value.NativeQuery(Databricks.Catalogs(\"adb-1220993250695902.2.azuredatabricks.net\", \"/sql/1.0/warehouses/6b94e3b6ef796336\", [Catalog=\"hive_metastore\", Database=null, EnableAutomaticProxyDiscovery=null]){[Name=\"hive_metastore\",Kind=\"Database\"]}[Data], \"",
          "    select ",
          "UNIDADE_NEGOCIO,",
          "PRESTADOR_SERVICO_RAZAO_SOCIAL,",
          "COD_CENTRO_CUSTO_GERENCIAL,",
          "case ",
          "  when trim(CENTRO_CUSTO_GERENCIAL) = '' and source = 'LOGIX' then 'C.C Indefinido'",
          "  else coalesce(CENTRO_CUSTO_GERENCIAL, 'C.C Indefinido')",
          "  end as CENTRO_CUSTO_GERENCIAL,",
          "upper(OPERACAO) as OPERACAO,",
          "CENTRO_CUSTO,",
          "NUM_ROMANEIO,",
          "NUM_CONHECIMENTO,",
          "SERIE,",
          "DATA_EMISSAO,",
          "NOTAS_FISCAIS,",
          "COB_CNPJ_CPF,",
          "upper(COB_RAZAO_SOCIAL) as COB_RAZAO_SOCIAL,",
          "try_divide(VALOR_TOTAL_MERCADORIA, regexp_count(NOTAS_FISCAIS, ',') + 1) as VALOR_TOTAL_MERCADORIA,",
          "GRIS,",
          "VALOR_ICMS,",
          "TOTAL_CONHECIMENTO,",
          "TOTAL_CONHECIMENTO_LIQUIDO,",
          "TOTAL_CONHECIMENTO_SEM_IMPOSTO,",
          "SIGLA_UF_COLETA,",
          "upper(NOME_LOCAL_COLETA) as NOME_LOCAL_COLETA,",
          "upper(SIGLA_UF_ENTREGA) as SIGLA_UF_ENTREGA,",
          "upper(NOME_LOCAL_ENTREGA) as NOME_LOCAL_ENTREGA,",
          "TIPO_VEICULO,",
          "replace(upper(PLACA_TRACAO), '-', '') as PLACA_TRACAO,",
          "replace(replace(replace(PROP_CNPJ_CPF, '-', ''),'/',''),'.','') as PROP_CNPJ_CPF,",
          "upper(PROP_RAZAO_SOCIAL) as PROP_RAZAO_SOCIAL,",
          "upper(NOME_MOTORISTA) as NOME_MOTORISTA,",
          "MERCADORIA,",
          "PESO,",
          "VOLUME,",
          "NATUREZA_OPERACAO,",
          "CONHECIMENTO_TIPO,",
          "STATUS_CTE,",
          "VALOR_FATURAMENTO,",
          "FRETE_VALOR,",
          "VALOR_ADVALOREM,",
          "VALOR_PEDAGIO,",
          "VALOR_ESTACIONAMENTO,",
          "VALOR_ESCOLTA,",
          "VALOR_TAXA_EMISSAO,",
          "VALOR_RCTRC,",
          "OUTROS,",
          "VALOR_DTA_AEREA,",
          "VALOR_AJUDANTE,",
          "VALOR_OUTROS,",
          "VALOR_EXCESSO_PESO,",
          "VALOR_DEVOLUCAO_ME,",
          "VALOR_DEV_MD,",
          "ADICIONAL_IMO,",
          "VALOR_COLETA_ME,",
          "VALOR_IMO,",
          "source,",
          "upper(replace( trim( concat(NOME_LOCAL_COLETA,'/', SIGLA_UF_COLETA, 'X', NOME_LOCAL_ENTREGA, '/', SIGLA_UF_ENTREGA)) ,' ', '')) AS ROTA",
          "from ouro_transportes.fato_cte ",
          "where CANCELADA = 'Não' ",
          "and DATA_EMISSAO >= '2021-01-01'",
          "and STATUS_CTE IN ( 'Autorizado o uso do CT-e', 'Autorizado o uso do CTe','Autorizado o uso do CT-e.')",
          "",
          "    \", null, [EnableFolding=true]),",
          "    #\"Coluna Duplicada\" = Table.DuplicateColumn(Fonte, \"DATA_EMISSAO\", \"DATA_EMISSAO - Copiar\"),",
          "    #\"Colunas Renomeadas\" = Table.RenameColumns(#\"Coluna Duplicada\",{{\"DATA_EMISSAO - Copiar\", \"DATA_EMISSAO_BACKUP\"}}),",
          "    #\"DATA_EMISSAO p/ data\" = Table.TransformColumnTypes(#\"Colunas Renomeadas\",{{\"DATA_EMISSAO\", type date}}),",
          "    #\"Texto Limpo\" = Table.TransformColumns(#\"DATA_EMISSAO p/ data\",{{\"NOME_LOCAL_COLETA\", Text.Clean, type text}, {\"SIGLA_UF_COLETA\", Text.Clean, type text}, {\"SIGLA_UF_ENTREGA\", Text.Clean, type text}, {\"NOME_LOCAL_ENTREGA\", Text.Clean, type text}}),",
          "    #\"CONHECIMENTO Normal\" = Table.ReplaceValue(#\"Texto Limpo\",\"Conhecimento Normal\",\"Normal\",Replacer.ReplaceText,{\"CONHECIMENTO_TIPO\"}),",
          "    #\"Linhas Filtradas\" = Table.SelectRows(#\"CONHECIMENTO Normal\", each [NUM_ROMANEIO] = \"734408\"),",
          "    #\"Duplicatas Removidas\" = Table.Distinct(#\"Linhas Filtradas\", {\"UNIDADE_NEGOCIO\", \"CENTRO_CUSTO_GERENCIAL\", \"NUM_ROMANEIO\",\"DATA_EMISSAO\"}),",
          "    #\"Linhas Agrupadas\" = Table.Group(#\"Duplicatas Removidas\", {\"UNIDADE_NEGOCIO\", \"PRESTADOR_SERVICO_RAZAO_SOCIAL\", \"NUM_ROMANEIO\", \"DATA_EMISSAO\"}, {{\"Tabelatodaslinhas\", each _, type table [UNIDADE_NEGOCIO=nullable text, PRESTADOR_SERVICO_RAZAO_SOCIAL=nullable text, COD_CENTRO_CUSTO_GERENCIAL=nullable text, CENTRO_CUSTO_GERENCIAL=nullable text, OPERACAO=nullable text, CENTRO_CUSTO=nullable text, NUM_ROMANEIO=nullable text, NUM_CONHECIMENTO=nullable text, SERIE=nullable text, DATA_EMISSAO=nullable date, NOTAS_FISCAIS=nullable text, COB_CNPJ_CPF=nullable text, COB_RAZAO_SOCIAL=nullable text, VALOR_TOTAL_MERCADORIA=nullable number, GRIS=nullable number, VALOR_ICMS=nullable number, TOTAL_CONHECIMENTO=nullable number, TOTAL_CONHECIMENTO_LIQUIDO=nullable number, TOTAL_CONHECIMENTO_SEM_IMPOSTO=nullable number, SIGLA_UF_COLETA=text, NOME_LOCAL_COLETA=text, SIGLA_UF_ENTREGA=text, NOME_LOCAL_ENTREGA=text, TIPO_VEICULO=nullable text, PLACA_TRACAO=nullable text, PROP_CNPJ_CPF=nullable text, PROP_RAZAO_SOCIAL=nullable text, NOME_MOTORISTA=nullable text, MERCADORIA=nullable text, PESO=nullable number, VOLUME=nullable number, NATUREZA_OPERACAO=nullable text, CONHECIMENTO_TIPO=nullable text, STATUS_CTE=nullable text, VALOR_FATURAMENTO=nullable number, FRETE_VALOR=nullable number, VALOR_ADVALOREM=nullable number, VALOR_PEDAGIO=nullable number, VALOR_ESTACIONAMENTO=nullable number, VALOR_ESCOLTA=nullable number, VALOR_TAXA_EMISSAO=nullable number, VALOR_RCTRC=nullable number, OUTROS=nullable number, VALOR_DTA_AEREA=nullable number, VALOR_AJUDANTE=nullable number, VALOR_OUTROS=nullable number, VALOR_EXCESSO_PESO=nullable number, VALOR_DEVOLUCAO_ME=nullable number, VALOR_DEV_MD=nullable number, ADICIONAL_IMO=nullable number, VALOR_COLETA_ME=nullable number, VALOR_IMO=nullable number, source=nullable text, ROTA=nullable text, DATA_EMISSAO_BACKUP=nullable datetime]}}),",
          "    #\"Personalização Adicionada\" = Table.AddColumn(#\"Linhas Agrupadas\", \"colunahistoricosozinha\", each Table.SelectColumns([Tabelatodaslinhas],{\"CENTRO_CUSTO_GERENCIAL\"})),",
          "    #\"Personalização Adicionada1\" = Table.AddColumn(#\"Personalização Adicionada\", \"TabelaParaLista\", each Table.ToList([colunahistoricosozinha])),",
          "    #\"Valores Extraídos\" = Table.TransformColumns(#\"Personalização Adicionada1\", {\"TabelaParaLista\", each Text.Combine(List.Transform(_, Text.From), \" x \"), type text}),",
          "    #\"Colunas Removidas\" = Table.RemoveColumns(#\"Valores Extraídos\",{\"Tabelatodaslinhas\", \"colunahistoricosozinha\"})",
          "in",
          "    #\"Colunas Removidas\""
        ],
        "kind": "m",
        "lineageTag": "811ddf3c-7f6f-43c6-89ce-937307971db6"
      }
    ],
    "queryGroups": [
      {
        "annotations": [
          {
            "name": "PBI_QueryGroupOrder",
            "value": "0"
          }
        ],
        "description": "Erros nas consultas que foram carregadas em 07/02/2023 15:25:06.",
        "folder": "Erros na Consulta - 07/02/2023 15:25:06"
      },
      {
        "annotations": [
          {
            "name": "PBI_QueryGroupOrder",
            "value": "1"
          }
        ],
        "description": "Erros nas consultas que foram carregadas em 14/12/2023 13:43:21.",
        "folder": "Erros na Consulta - 14/12/2023 13:43:21"
      }
    ],
    "relationships": [
      {
        "name": "fbea3dd5-87fb-4968-8f31-3edb30a61168",
        "fromColumn": "source",
        "fromTable": "fato_carta_frete",
        "toColumn": "source",
        "toTable": "dimSOURCE"
      },
      {
        "name": "297195e3-8c13-4a9d-804b-f717c4980d7d",
        "fromColumn": "source",
        "fromTable": "fato_cte",
        "toColumn": "source",
        "toTable": "dimSOURCE"
      },
      {
        "name": "fa70aca2-e35b-47ad-9719-e29a243eae5a",
        "fromColumn": "source",
        "fromTable": "fato_nf",
        "toColumn": "source",
        "toTable": "dimSOURCE"
      },
      {
        "name": "d7b9cbda-eb71-4042-b098-85cb4846a6bd",
        "fromColumn": "PLACA_TRACAO",
        "fromTable": "fato_nf",
        "toColumn": "CAVALO",
        "toTable": "dimPLACA"
      },
      {
        "name": "a8966a2d-18b4-476d-845a-37f10119d0f6",
        "fromColumn": "CAVALO",
        "fromTable": "fato_carta_frete",
        "toColumn": "CAVALO",
        "toTable": "dimPLACA"
      },
      {
        "name": "966de3eb-bcaa-4096-987a-9ec5a81ffc74",
        "fromColumn": "PLACA_TRACAO",
        "fromTable": "fato_cte",
        "toColumn": "CAVALO",
        "toTable": "dimPLACA"
      },
      {
        "name": "a20a78ee-d078-49ca-af3d-4772de24fcbe",
        "fromColumn": "UNIDADE_NEGOCIO",
        "fromTable": "fato_carta_frete",
        "toColumn": "UNIDADE_NEGOCIO",
        "toTable": "dim_UNIDADES"
      },
      {
        "name": "db994b0f-d526-462a-9d0b-567e39203568",
        "fromColumn": "UNIDADE_NEGOCIO",
        "fromTable": "fato_cte",
        "toColumn": "UNIDADE_NEGOCIO",
        "toTable": "dim_UNIDADES"
      },
      {
        "name": "85e88215-a182-4f56-8f63-7406fa2e2420",
        "fromColumn": "UNIDADE_NEGOCIO",
        "fromTable": "fato_nf",
        "toColumn": "UNIDADE_NEGOCIO",
        "toTable": "dim_UNIDADES"
      },
      {
        "name": "96638778-22a0-45eb-b936-af6d2bc1952a",
        "fromColumn": "ROTA",
        "fromTable": "fato_cte",
        "toColumn": "Rota",
        "toTable": "dimROTAS_DISTANCIAS"
      },
      {
        "name": "541db746-281e-4dc6-a893-1a0a4ef246bf",
        "fromColumn": "ROTA",
        "fromTable": "fato_carta_frete",
        "toColumn": "Rota",
        "toTable": "dimROTAS_DISTANCIAS"
      },
      {
        "name": "e713d1c1-8f4f-4402-a548-c7c333ead91e",
        "fromColumn": "ROTA",
        "fromTable": "fato_nf",
        "toColumn": "Rota",
        "toTable": "dimROTAS_DISTANCIAS"
      },
      {
        "name": "749826a7-fdc0-433e-99ff-586090157e8d",
        "fromColumn": "CAVALO",
        "fromTable": "fato_carta_frete",
        "toColumn": "Placa",
        "toTable": "dimPLACA_FROTA"
      },
      {
        "name": "d47df191-4c4f-4a81-bac5-c7e560b951c9",
        "fromColumn": "PLACA_TRACAO",
        "fromTable": "fato_cte",
        "toColumn": "Placa",
        "toTable": "dimPLACA_FROTA"
      },
      {
        "name": "d919c9ed-2fb5-46fc-b108-d2327a69bc19",
        "fromColumn": "PLACA_TRACAO",
        "fromTable": "fato_nf",
        "toColumn": "Placa",
        "toTable": "dimPLACA_FROTA"
      },
      {
        "name": "3262d21b-ec72-4bd0-9852-bfb352168866",
        "fromColumn": "Unidade Negocio",
        "fromTable": "fato_meta_frota",
        "toColumn": "UNIDADE_NEGOCIO",
        "toTable": "dim_UNIDADES"
      },
      {
        "name": "46a58349-e42e-4c0f-8c62-bad9fd163fef",
        "fromColumn": "Placa",
        "fromTable": "fato_meta_frota",
        "toColumn": "Placa",
        "toTable": "dimPLACA_FROTA"
      },
      {
        "name": "5e8368cb-16d7-4e29-93d9-e2cc956eea43",
        "fromColumn": "TIPO_NOTA_FISCAL",
        "fromTable": "fato_nf",
        "toColumn": "TIPO_AUX",
        "toTable": "dimTIPO_DOC_AUX"
      },
      {
        "name": "2392343b-4b76-454e-b946-5dd5e9a1df26",
        "fromColumn": "TIPO_AUX",
        "fromTable": "fato_carta_frete",
        "toColumn": "TIPO_AUX",
        "toTable": "dimTIPO_DOC_AUX"
      },
      {
        "name": "38c56ef1-3f04-49d5-9bed-77250239fc0f",
        "fromColumn": "CONHECIMENTO_TIPO",
        "fromTable": "fato_cte",
        "toColumn": "TIPO_AUX",
        "toTable": "dimTIPO_DOC_AUX"
      },
      {
        "name": "31b0ad25-9be1-42a7-bccb-90e2b5d57b25",
        "fromColumn": "Frota?",
        "fromTable": "fato_nf",
        "toColumn": "frota",
        "toTable": "dimFROTA"
      },
      {
        "name": "ff8ad53d-a08c-46be-8c83-707307d2e0e6",
        "fromColumn": "Frota?",
        "fromTable": "fato_cte",
        "toColumn": "frota",
        "toTable": "dimFROTA"
      },
      {
        "name": "b8fd4552-fd49-49ef-af13-22a3dd1d944e",
        "fromColumn": "Frota?",
        "fromTable": "fato_carta_frete",
        "toColumn": "frota",
        "toTable": "dimFROTA"
      },
      {
        "name": "4e34d2ca-2f69-4882-b152-41ed279493aa",
        "fromColumn": "NUM_ROMANEIO",
        "fromTable": "fato_cte",
        "toColumn": "NUM_ROMANEIO",
        "toTable": "dimROMANEIO"
      },
      {
        "name": "bf3fe828-e429-4ed0-a5d5-e5eae2af662d",
        "fromColumn": "NUM_ROMANEIO",
        "fromTable": "fato_carta_frete",
        "toColumn": "NUM_ROMANEIO",
        "toTable": "dimROMANEIO"
      },
      {
        "name": "1a950d50-2083-4d8a-b439-11fac664938c",
        "fromColumn": "NUM_ROMANEIO",
        "fromTable": "fato_nf",
        "toColumn": "NUM_ROMANEIO",
        "toTable": "dimROMANEIO"
      },
      {
        "name": "25547539-1332-4248-bcec-86c0014c0157",
        "fromColumn": "Unidade Negocio",
        "fromTable": "dimPLACA_FROTA",
        "isActive": false,
        "toColumn": "UNIDADE_NEGOCIO",
        "toTable": "dim_UNIDADES"
      },
      {
        "name": "9e460072-3d32-4ebc-a16a-cd7e0da07051",
        "fromColumn": "UNIDADE_NEGOCIO_F",
        "fromTable": "fato_meta_plano",
        "toColumn": "UNIDADE_NEGOCIO",
        "toTable": "dim_UNIDADES"
      },
      {
        "name": "608e1379-a28f-447f-b78d-d60d94a5ba80",
        "fromColumn": "source",
        "fromTable": "fato_meta_plano",
        "toColumn": "source",
        "toTable": "dimSOURCE"
      },
      {
        "name": "84f2afa9-1a3f-4c4c-9879-2249640e703b",
        "fromColumn": "Placa",
        "fromTable": "fato_alelo",
        "toColumn": "Placa",
        "toTable": "dimPLACA_FROTA"
      },
      {
        "name": "5aee35a5-d82c-475a-aaee-9534531a9dd7",
        "fromColumn": "UNIDADE_NEGOCIO_F",
        "fromTable": "fato_despesa_frota_plano",
        "toColumn": "UNIDADE_NEGOCIO",
        "toTable": "dim_UNIDADES"
      },
      {
        "name": "7d245203-f12c-40cc-afbc-e51bb3693a19",
        "fromColumn": "Unidade Negocio",
        "fromTable": "fato_alelo",
        "toColumn": "UNIDADE_NEGOCIO",
        "toTable": "dim_UNIDADES"
      },
      {
        "name": "2ad88be7-bfca-45fc-8572-0a3e5f98a9f7",
        "fromColumn": "COB_RAZAO_SOCIAL",
        "fromTable": "fato_cte",
        "toColumn": "COB_RAZAO_SOCIAL",
        "toTable": "dimCLIENTES"
      },
      {
        "name": "d7797274-0db0-4d3f-9136-cc22a8b07bec",
        "fromColumn": "COB_RAZAO_SOCIAL",
        "fromTable": "fato_nf",
        "toColumn": "COB_RAZAO_SOCIAL",
        "toTable": "dimCLIENTES"
      },
      {
        "name": "e24fbdaf-2bfe-4e9c-8b73-5f3fc99aa32b",
        "fromColumn": "CLIENTE_COBRANCA",
        "fromTable": "fato_carta_frete",
        "toColumn": "COB_RAZAO_SOCIAL",
        "toTable": "dimCLIENTES"
      },
      {
        "name": "a72ce084-a6f3-4de8-beed-42ac196584ef",
        "fromColumn": "NUM_ROMANEIO",
        "fromTable": "fato_despesa_carta_frete",
        "toColumn": "NUM_ROMANEIO",
        "toTable": "dimROMANEIO"
      },
      {
        "name": "56fad0b6-40a2-4d1f-bd2e-fba527d77236",
        "fromColumn": "source_C",
        "fromTable": "fato_despesa_carta_frete",
        "toColumn": "source",
        "toTable": "dimSOURCE"
      },
      {
        "name": "99fb4094-5951-4411-89d4-b5868a137a0f",
        "fromColumn": "UNIDADE_NEGOCIO_C",
        "fromTable": "fato_despesa_carta_frete",
        "toColumn": "UNIDADE_NEGOCIO",
        "toTable": "dim_UNIDADES"
      },
      {
        "name": "67c5d569-89e8-45bd-8c35-3478eb0f38bb",
        "fromColumn": "COB_RAZAO_SOCIAL_C",
        "fromTable": "fato_despesa_carta_frete",
        "toColumn": "COB_RAZAO_SOCIAL",
        "toTable": "dimCLIENTES"
      },
      {
        "name": "9e98bbfe-d7c6-4283-b070-03ffb25743bb",
        "fromColumn": "PLACA_TRACAO_C",
        "fromTable": "fato_despesa_carta_frete",
        "toColumn": "Placa",
        "toTable": "dimPLACA_FROTA"
      },
      {
        "name": "29a3ba77-889a-4b9a-91a1-4ee204500960",
        "fromColumn": "DESCRICAO_ORGANIZACIONAL",
        "fromTable": "fato_nf",
        "toColumn": "CENTRO_CUSTO_GERENCIAL",
        "toTable": "dimCENTRO_CUSTO_GERENCIAL"
      },
      {
        "name": "616937cf-3112-473a-b692-505aebae1ba2",
        "fromColumn": "CENTRO_CUSTO_GERENCIAL",
        "fromTable": "fato_carta_frete",
        "toColumn": "CENTRO_CUSTO_GERENCIAL",
        "toTable": "dimCENTRO_CUSTO_GERENCIAL"
      },
      {
        "name": "54180b17-738c-410d-943e-a3b3f041cd59",
        "fromColumn": "CENTRO_CUSTO_GERENCIAL",
        "fromTable": "fato_cte",
        "toColumn": "CENTRO_CUSTO_GERENCIAL",
        "toTable": "dimCENTRO_CUSTO_GERENCIAL"
      },
      {
        "name": "c4459509-3e0f-4783-ba25-71491320de24",
        "fromColumn": "CENTRO_CUSTO_GERENCIAL_C",
        "fromTable": "fato_despesa_carta_frete",
        "toColumn": "CENTRO_CUSTO_GERENCIAL",
        "toTable": "dimCENTRO_CUSTO_GERENCIAL"
      },
      {
        "name": "76f7a43c-bfb1-439a-ba30-60e0bce7ed29",
        "fromColumn": "CENTRO_CUSTO",
        "fromTable": "fato_cte",
        "toColumn": "CENTRO_CUSTO",
        "toTable": "dimCENTRO_CUSTO"
      },
      {
        "name": "67b271d4-44a8-4f80-bd6d-6babf5fcf0b5",
        "fromColumn": "CENTRO_CUSTO",
        "fromTable": "fato_nf",
        "toColumn": "CENTRO_CUSTO",
        "toTable": "dimCENTRO_CUSTO"
      },
      {
        "name": "54f8a36f-2d77-458f-9061-19d2429e46d6",
        "fromColumn": "Frota?",
        "fromTable": "fato_despesa_carta_frete",
        "toColumn": "frota",
        "toTable": "dimFROTA"
      },
      {
        "name": "7b47ca9a-f40e-40af-b06f-adb1cf283087",
        "fromColumn": "CENTRO_CUSTO_C",
        "fromTable": "fato_despesa_carta_frete",
        "toColumn": "CENTRO_CUSTO",
        "toTable": "dimCENTRO_CUSTO"
      },
      {
        "name": "8bb62fd6-2296-472d-8f77-a89bbcdc2728",
        "fromColumn": "OPERACAO",
        "fromTable": "fato_cte",
        "toColumn": "OPERACAO",
        "toTable": "dimOPERACAO"
      },
      {
        "name": "00323f5b-4f9b-4f86-9525-7b8d8229fe9c",
        "fromColumn": "OPERACAO",
        "fromTable": "fato_carta_frete",
        "toColumn": "OPERACAO",
        "toTable": "dimOPERACAO"
      },
      {
        "name": "544728bc-7ce8-414a-bb88-d71b90206e27",
        "fromColumn": "OPERACAO",
        "fromTable": "fato_nf",
        "toColumn": "OPERACAO",
        "toTable": "dimOPERACAO"
      },
      {
        "name": "53aa0b89-759c-4293-9b2d-b7e39e909509",
        "fromColumn": "Frota?",
        "fromTable": "dimPLACA_FROTA",
        "isActive": false,
        "toColumn": "frota",
        "toTable": "dimFROTA"
      },
      {
        "name": "6ddf3dc6-5a01-4309-bf14-bceb9b9bcce2",
        "fromColumn": "PROP_CNPJ_CPF",
        "fromTable": "fato_cte",
        "toColumn": "PROP_CNPJ_CPF",
        "toTable": "dimPROP_CNPJ_CPF"
      },
      {
        "name": "8110b313-61b7-4a91-b224-d981fa090db1",
        "fromColumn": "PROP_CNPJ_CPF",
        "fromTable": "fato_nf",
        "toColumn": "PROP_CNPJ_CPF",
        "toTable": "dimPROP_CNPJ_CPF"
      },
      {
        "name": "1a66e9c0-7cb2-43f7-b104-4545d2fc0205",
        "fromColumn": "CNPJ_CPF_PROPRIETARIO_VEICULO",
        "fromTable": "fato_carta_frete",
        "toColumn": "PROP_CNPJ_CPF",
        "toTable": "dimPROP_CNPJ_CPF"
      },
      {
        "name": "3d647891-b41d-411e-953c-b911cd137c6d",
        "fromColumn": "PROP_RAZAO_SOCIAL",
        "fromTable": "fato_cte",
        "toColumn": "PROP_RAZAO_SOCIAL",
        "toTable": "dimPROP_RAZAO_SOCIAL"
      },
      {
        "name": "88ffca69-e1fb-42c0-af71-09c1346d741c",
        "fromColumn": "PROP_RAZAO_SOCIAL",
        "fromTable": "fato_nf",
        "toColumn": "PROP_RAZAO_SOCIAL",
        "toTable": "dimPROP_RAZAO_SOCIAL"
      },
      {
        "name": "7206e035-1dc5-4e4e-95d8-99626f76b18f",
        "fromColumn": "RAZAO_SOCIAL_PROPRIETARIO",
        "fromTable": "fato_carta_frete",
        "toColumn": "PROP_RAZAO_SOCIAL",
        "toTable": "dimPROP_RAZAO_SOCIAL"
      },
      {
        "name": "7802c36f-179a-4423-a109-18a7baed6a99",
        "fromColumn": "TIPO_VEICULO",
        "fromTable": "fato_cte",
        "toColumn": "TIPO_VEICULO",
        "toTable": "dim_VEICULOS"
      },
      {
        "name": "77a02769-d462-4507-9177-3e1a0bfdb689",
        "fromColumn": "TIPO_VEICULO",
        "fromTable": "fato_nf",
        "toColumn": "TIPO_VEICULO",
        "toTable": "dim_VEICULOS"
      },
      {
        "name": "e679f30d-2a14-4c6c-8a35-4a232c3f34b3",
        "fromColumn": "MERCADORIA",
        "fromTable": "fato_cte",
        "toColumn": "MERCADORIA",
        "toTable": "dim_MERCADORIA"
      },
      {
        "name": "3037e56d-3ad6-4a03-a95d-561bb1618b78",
        "fromColumn": "MERCADORIA",
        "fromTable": "fato_nf",
        "toColumn": "MERCADORIA",
        "toTable": "dim_MERCADORIA"
      },
      {
        "name": "b628a5a2-c35e-414e-a0c7-5f5282819533",
        "fromColumn": "NOME_MOTORISTA",
        "fromTable": "fato_cte",
        "toColumn": "NOME_MOTORISTA",
        "toTable": "dimMOTORISTA"
      },
      {
        "name": "cbc2efe0-25c2-4a6a-80f6-3cd434d24bc6",
        "fromColumn": "NOME_MOTORISTA",
        "fromTable": "fato_nf",
        "toColumn": "NOME_MOTORISTA",
        "toTable": "dimMOTORISTA"
      },
      {
        "name": "63cfba1b-2d4c-4c1b-8c28-69f9896ac714",
        "fromColumn": "NOME_MOTORISTA",
        "fromTable": "fato_carta_frete",
        "toColumn": "NOME_MOTORISTA",
        "toTable": "dimMOTORISTA"
      },
      {
        "name": "e6e12334-9d06-4e4b-b15c-09e274bbdcf1",
        "fromColumn": "CHAVE_CONHECIMENTO_NF",
        "fromTable": "fato_carta_frete",
        "toColumn": "CHAVE_CONHECIMENTO_NF",
        "toTable": "dim_CONHECIMENTO_NF"
      },
      {
        "name": "2604521e-b436-48e2-8731-9b67eba590ee",
        "fromColumn": "CENTROS_CUSTO_ROMANEIO",
        "fromTable": "fato_cte",
        "toColumn": "CENTROS_CUSTO_ROMANEIO",
        "toTable": "dimCENTRO_CUSTO_ROMANEIO"
      },
      {
        "name": "5be9f951-9c4d-47ed-bdb1-ca609df59b6f",
        "fromColumn": "CENTROS_CUSTO_ROMANEIO",
        "fromTable": "fato_nf",
        "toColumn": "CENTROS_CUSTO_ROMANEIO",
        "toTable": "dimCENTRO_CUSTO_ROMANEIO"
      },
      {
        "name": "1a12060c-7f98-4279-8cd9-14532f24416b",
        "fromColumn": "DATA_EMISSAO",
        "fromTable": "fato_cte",
        "toColumn": "Date",
        "toTable": "Calendario"
      },
      {
        "name": "966980d9-9250-4a38-989c-3def5df952d3",
        "fromColumn": "DATA_EMISSAO",
        "fromTable": "fato_nf",
        "toColumn": "Date",
        "toTable": "Calendario"
      },
      {
        "name": "42a02fa1-fcc4-418b-85ab-c221304612e9",
        "fromColumn": "DATA_EMISSAO",
        "fromTable": "fato_carta_frete",
        "toColumn": "Date",
        "toTable": "Calendario"
      },
      {
        "name": "bd819018-01a2-41db-a924-0c65a55d57d3",
        "fromColumn": "Data Conclusao",
        "fromTable": "fato_meta_frota",
        "toColumn": "Date",
        "toTable": "Calendario"
      },
      {
        "name": "47965b59-42ef-4253-ab64-3578f222200e",
        "fromColumn": "DATA_PLANO",
        "fromTable": "fato_meta_plano",
        "toColumn": "Date",
        "toTable": "Calendario"
      },
      {
        "name": "98a3c4ec-148b-4f74-bc5d-c0cb6a5c2188",
        "fromColumn": "Data Utilizacao",
        "fromTable": "fato_alelo",
        "toColumn": "Date",
        "toTable": "Calendario"
      },
      {
        "name": "d7596246-c5f4-4f5e-a6c9-c28a4068bd3f",
        "fromColumn": "DATA_DESPESA",
        "fromTable": "fato_despesa_frota_plano",
        "toColumn": "Date",
        "toTable": "Calendario"
      },
      {
        "name": "036ab93d-8c42-4588-bb62-c46182b4228b",
        "fromColumn": "DATA_EMISSAO_C",
        "fromTable": "fato_despesa_carta_frete",
        "toColumn": "Date",
        "toTable": "Calendario"
      },
      {
        "name": "2aef10e3-7001-4f91-a108-6bfa66678a84",
        "fromColumn": "DATA_EMISSAO_M",
        "fromTable": "fato_despesa_carta_frete",
        "isActive": false,
        "toColumn": "Date",
        "toTable": "Calendario"
      },
      {
        "name": "a5454474-b911-4d6c-9d82-cb89a3e35d65",
        "fromColumn": "DATA_EMISSAO_MINIMA_AJUSTADA",
        "fromTable": "fato_cte",
        "isActive": false,
        "toColumn": "Date",
        "toTable": "Calendario"
      },
      {
        "name": "9e347af4-c6ff-484a-a550-90c85f68ed30",
        "fromColumn": "DATA_EMISSAO_MINIMA_AJUSTADA",
        "fromTable": "fato_nf",
        "isActive": false,
        "toColumn": "Date",
        "toTable": "Calendario"
      },
      {
        "name": "4793da19-73bd-47fd-8af1-5d16fa4b92d4",
        "fromColumn": "CENTROS_CUSTO_ROMANEIO",
        "fromTable": "fato_carta_frete",
        "toColumn": "CENTROS_CUSTO_ROMANEIO",
        "toTable": "dimCENTRO_CUSTO_ROMANEIO"
      }
    ],
    "sourceQueryCulture": "pt-BR",
    "tables": [
      {
        "name": "fato_carta_frete",
        "annotations": [
          {
            "name": "PBI_ResultType",
            "value": "Table"
          },
          {
            "name": "PBI_NavigationStepName",
            "value": "Navegação"
          }
        ],
        "changedProperties": [
          {
            "property": "IsHidden"
          }
        ],
        "columns": [
          {
            "name": "UNIDADE_NEGOCIO",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "isHidden": true,
            "lineageTag": "860a7dc0-c1cd-4ef9-bf33-e0e726a4b419",
            "sourceColumn": "UNIDADE_NEGOCIO",
            "summarizeBy": "none"
          },
          {
            "name": "PRESTADOR_SERVICO_CNPJ",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "isHidden": true,
            "lineageTag": "624c957f-129e-455d-b1ad-8f3cb6dd43e4",
            "sourceColumn": "PRESTADOR_SERVICO_CNPJ",
            "summarizeBy": "none"
          },
          {
            "name": "PRESTADOR_SERVICO_RAZAO_SOCIAL",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "isHidden": true,
            "lineageTag": "50a9bab6-e757-4de9-be3d-f9b991e00f4b",
            "sourceColumn": "PRESTADOR_SERVICO_RAZAO_SOCIAL",
            "summarizeBy": "none"
          },
          {
            "name": "ACRESCIMOS",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "double",
            "isHidden": true,
            "lineageTag": "eb573588-b776-4a3b-ae00-5aca0d401118",
            "sourceColumn": "ACRESCIMOS",
            "summarizeBy": "sum"
          },
          {
            "name": "AVULSA",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "isHidden": true,
            "lineageTag": "534ca720-7818-4b6f-ac87-ce9f899987d1",
            "sourceColumn": "AVULSA",
            "summarizeBy": "none"
          },
          {
            "name": "CARRETA",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "isHidden": true,
            "lineageTag": "1a98c8d5-eaa2-4f42-b3ae-d35b7827529d",
            "sourceColumn": "CARRETA",
            "summarizeBy": "none"
          },
          {
            "name": "CAVALO",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "isHidden": true,
            "lineageTag": "a5fa6418-bc0b-4401-9072-d4386f636113",
            "sourceColumn": "CAVALO",
            "summarizeBy": "none"
          },
          {
            "name": "CENTRO_CUSTO",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "isHidden": true,
            "lineageTag": "36612b45-7d2a-4fbf-95ac-512668c7518c",
            "sourceColumn": "CENTRO_CUSTO",
            "summarizeBy": "none"
          },
          {
            "name": "CENTRO_CUSTO_GERENCIAL",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "isHidden": true,
            "lineageTag": "abb37233-9c88-49e4-a995-70db01af12a3",
            "sourceColumn": "CENTRO_CUSTO_GERENCIAL",
            "summarizeBy": "none"
          },
          {
            "name": "CNPJ_CPF_MOTORISTA",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "isHidden": true,
            "lineageTag": "2d1b8070-b324-4436-b9c9-20ce46f87fa7",
            "sourceColumn": "CNPJ_CPF_MOTORISTA",
            "summarizeBy": "none"
          },
          {
            "name": "CNPJ_CPF_PROPRIETARIO_VEICULO",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "isHidden": true,
            "lineageTag": "c4500e6e-86aa-4e0b-ac86-c61fc170c642",
            "sourceColumn": "CNPJ_CPF_PROPRIETARIO_VEICULO",
            "summarizeBy": "none"
          },
          {
            "name": "COLETA",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "isHidden": true,
            "lineageTag": "aa351e39-c351-4163-a391-08afb85efac0",
            "sourceColumn": "COLETA",
            "summarizeBy": "none"
          },
          {
            "name": "DATA_CANCELAMENTO",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "dateTime",
            "formatString": "General Date",
            "isHidden": true,
            "lineageTag": "540e9d12-261e-4f41-a4da-e4e8fd8c09b4",
            "sourceColumn": "DATA_CANCELAMENTO",
            "summarizeBy": "none"
          },
          {
            "name": "DATA_EMISSAO",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "UnderlyingDateTimeDataType",
                "value": "Date"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "dateTime",
            "formatString": "Short Date",
            "isHidden": true,
            "lineageTag": "3824f28a-f58e-4f19-aaa7-271229d04ec8",
            "sourceColumn": "DATA_EMISSAO",
            "summarizeBy": "none"
          },
          {
            "name": "DATE_INSERT",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "dateTime",
            "formatString": "General Date",
            "isHidden": true,
            "lineageTag": "e6b63c3b-823a-4637-92b2-35aa9f2c9d5b",
            "sourceColumn": "DATE_INSERT",
            "summarizeBy": "none"
          },
          {
            "name": "DATE_UPDATE",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "dateTime",
            "formatString": "General Date",
            "isHidden": true,
            "lineageTag": "edd8525f-42e3-44a4-bfdf-973d09d291fc",
            "sourceColumn": "DATE_UPDATE",
            "summarizeBy": "none"
          },
          {
            "name": "DESCONTOS",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "double",
            "lineageTag": "fc679189-0e84-4530-a9bd-d7edabc49711",
            "sourceColumn": "DESCONTOS",
            "summarizeBy": "sum"
          },
          {
            "name": "DESCRICAO_TIPO_CONTRATO",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "isHidden": true,
            "lineageTag": "8416d66f-8403-45fc-912c-259ace96c452",
            "sourceColumn": "DESCRICAO_TIPO_CONTRATO",
            "summarizeBy": "none"
          },
          {
            "name": "FRETE_CARRETEIRO",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "double",
            "lineageTag": "336686b5-4cb1-4f53-826e-cade8476643e",
            "sourceColumn": "FRETE_CARRETEIRO",
            "summarizeBy": "sum"
          },
          {
            "name": "KM_CARREGADO",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "double",
            "lineageTag": "768150ea-3d4c-4a81-9160-997619278766",
            "sourceColumn": "KM_CARREGADO",
            "summarizeBy": "sum"
          },
          {
            "name": "KM_VAZIO",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "double",
            "lineageTag": "5ee03abc-32d5-4ce1-9a0d-42996d3df5b3",
            "sourceColumn": "KM_VAZIO",
            "summarizeBy": "sum"
          },
          {
            "name": "LANCTO_ID",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "double",
            "isHidden": true,
            "lineageTag": "a96d8b3c-f20a-4f90-9833-fdb708509d74",
            "sourceColumn": "LANCTO_ID",
            "summarizeBy": "count"
          },
          {
            "name": "MODALIDADE_VEICULO",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "isHidden": true,
            "lineageTag": "1cc234a8-b534-45b2-8765-a1cf21e8eed0",
            "sourceColumn": "MODALIDADE_VEICULO",
            "summarizeBy": "none"
          },
          {
            "name": "MOTIVO_CANCELAMENTO",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "isHidden": true,
            "lineageTag": "be3ddb41-d357-4bac-bbf3-425322d1dddf",
            "sourceColumn": "MOTIVO_CANCELAMENTO",
            "summarizeBy": "none"
          },
          {
            "name": "NOME_MOTORISTA",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "isHidden": true,
            "lineageTag": "c4f5a677-16b3-4d49-a8b0-aa9587461111",
            "sourceColumn": "NOME_MOTORISTA",
            "summarizeBy": "none"
          },
          {
            "name": "NUM_CONHECIMENTO",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "isHidden": true,
            "lineageTag": "a619d981-daf3-471c-b29c-75fc65022c20",
            "sourceColumn": "NUM_CONHECIMENTO",
            "summarizeBy": "none"
          },
          {
            "name": "NUM_ROMANEIO",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "isHidden": true,
            "lineageTag": "c2de867e-dd53-4cf5-850c-897d4e8954df",
            "sourceColumn": "NUM_ROMANEIO",
            "summarizeBy": "none"
          },
          {
            "name": "NUM_VIAGEM_CTRC_CLIENTE",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "isHidden": true,
            "lineageTag": "62a7d8cb-d9cb-49c5-9f07-02ca697db844",
            "sourceColumn": "NUM_VIAGEM_CTRC_CLIENTE",
            "summarizeBy": "none"
          },
          {
            "name": "OPERACAO",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "isHidden": true,
            "lineageTag": "7eabaf6d-6758-4a13-9133-cf98d031bb90",
            "sourceColumn": "OPERACAO",
            "summarizeBy": "none"
          },
          {
            "name": "OUTRAS_TAXAS",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "double",
            "lineageTag": "4434e846-75ae-4e8a-bc6d-9d8a77fb4315",
            "sourceColumn": "OUTRAS_TAXAS",
            "summarizeBy": "sum"
          },
          {
            "name": "PEDAGIO_COBRADO",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "double",
            "lineageTag": "2273867b-3f71-4267-9b6f-aac517370385",
            "sourceColumn": "PEDAGIO_COBRADO",
            "summarizeBy": "sum"
          },
          {
            "name": "PESO",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "double",
            "lineageTag": "34f993c1-0b34-4b87-b5dd-808922eb43a4",
            "sourceColumn": "PESO",
            "summarizeBy": "sum"
          },
          {
            "name": "RAZAO_SOCIAL_PROPRIETARIO",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "isHidden": true,
            "lineageTag": "3d04719c-10cf-4d24-ad74-cba68d01740d",
            "sourceColumn": "RAZAO_SOCIAL_PROPRIETARIO",
            "summarizeBy": "none"
          },
          {
            "name": "REPOM_CONTRATO_AUTORIZADO",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "ca78cf97-e85e-47d1-97a1-40fee2843e1c",
            "sourceColumn": "REPOM_CONTRATO_AUTORIZADO",
            "summarizeBy": "sum"
          },
          {
            "name": "REPOM_CONTRATO_QUITADO",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "e7a35116-8f18-420e-a5b9-4124041b9f80",
            "sourceColumn": "REPOM_CONTRATO_QUITADO",
            "summarizeBy": "sum"
          },
          {
            "name": "REPOM_CONTRATO_SITUACAO",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "isHidden": true,
            "lineageTag": "24eda1c9-fd91-4a96-8522-7f5a55372c72",
            "sourceColumn": "REPOM_CONTRATO_SITUACAO",
            "summarizeBy": "none"
          },
          {
            "name": "REPOM_DATA_AUTORIZACAO",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "dateTime",
            "formatString": "General Date",
            "isHidden": true,
            "lineageTag": "53982edf-dcb6-48bc-a776-11aa9f6e7efb",
            "sourceColumn": "REPOM_DATA_AUTORIZACAO",
            "summarizeBy": "none"
          },
          {
            "name": "ROTA",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "isHidden": true,
            "lineageTag": "f1b2e59f-c3af-4ac5-bb1d-87d3bec51a06",
            "sourceColumn": "ROTA",
            "summarizeBy": "none"
          },
          {
            "name": "SERIE_FORMULARIO",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "isHidden": true,
            "lineageTag": "dbf93e2b-d15e-4377-aaf6-99bb5817a1d4",
            "sourceColumn": "SERIE_FORMULARIO",
            "summarizeBy": "none"
          },
          {
            "name": "TIPO_CONTRATO",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "isHidden": true,
            "lineageTag": "b4b8b6f3-3f10-45ea-8e9e-17408810f202",
            "sourceColumn": "TIPO_CONTRATO",
            "summarizeBy": "none"
          },
          {
            "name": "TOTAL_ACRESCIMOS",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "double",
            "lineageTag": "6cf157ce-71f3-4136-9619-ac9d181a5d10",
            "sourceColumn": "TOTAL_ACRESCIMOS",
            "summarizeBy": "sum"
          },
          {
            "name": "TOTAL_CONHECIMENTO",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "double",
            "lineageTag": "a57e85a5-04bc-42aa-9305-041a7c82826f",
            "sourceColumn": "TOTAL_CONHECIMENTO",
            "summarizeBy": "sum"
          },
          {
            "name": "TOTAL_CONHECIMENTO_BRUTO",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "double",
            "lineageTag": "c4e1d52b-46b9-41df-8495-992c8e053855",
            "sourceColumn": "TOTAL_CONHECIMENTO_BRUTO",
            "summarizeBy": "sum"
          },
          {
            "name": "TOTAL_DESCONTOS",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "double",
            "lineageTag": "c60af05e-0fd9-4750-8ee3-61e485537fce",
            "sourceColumn": "TOTAL_DESCONTOS",
            "summarizeBy": "sum"
          },
          {
            "name": "USER_INSERT",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "isHidden": true,
            "lineageTag": "b85fdc97-82e1-42ff-8044-feb1f8fa86df",
            "sourceColumn": "USER_INSERT",
            "summarizeBy": "none"
          },
          {
            "name": "USER_UPDATE",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "isHidden": true,
            "lineageTag": "5a458adf-de8d-4c24-ab13-3b28709b8ebb",
            "sourceColumn": "USER_UPDATE",
            "summarizeBy": "none"
          },
          {
            "name": "VALOR_ADTO",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "double",
            "lineageTag": "505a3386-7432-4ea1-9c62-69be698ffec8",
            "sourceColumn": "VALOR_ADTO",
            "summarizeBy": "sum"
          },
          {
            "name": "VALOR_ADTO_COMB",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "double",
            "lineageTag": "b7dc0aa0-77e8-4c36-a821-2e47b61f21a6",
            "sourceColumn": "VALOR_ADTO_COMB",
            "summarizeBy": "sum"
          },
          {
            "name": "VALOR_ADTO_PEDAGIO",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "double",
            "lineageTag": "4147eaf7-bbdc-44f4-8a41-4c9f77515173",
            "sourceColumn": "VALOR_ADTO_PEDAGIO",
            "summarizeBy": "sum"
          },
          {
            "name": "VALOR_BASE_INSS",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "double",
            "lineageTag": "fc0be4fd-61d4-4bf1-a241-e90e06e1a5f6",
            "sourceColumn": "VALOR_BASE_INSS",
            "summarizeBy": "sum"
          },
          {
            "name": "VALOR_CARGA_DESCARGA",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "double",
            "lineageTag": "15f5404a-23ee-43af-9a04-fc5b8dffdb52",
            "sourceColumn": "VALOR_CARGA_DESCARGA",
            "summarizeBy": "sum"
          },
          {
            "name": "VALOR_FRETE_BRUTO",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "double",
            "lineageTag": "48306353-6634-4cae-9b60-6c248e2b773c",
            "sourceColumn": "VALOR_FRETE_BRUTO",
            "summarizeBy": "sum"
          },
          {
            "name": "VALOR_FRETE_LIQUIDO",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "double",
            "lineageTag": "29621120-1463-49e3-9ade-928b8c7e9a32",
            "sourceColumn": "VALOR_FRETE_LIQUIDO",
            "summarizeBy": "sum"
          },
          {
            "name": "VALOR_ICMS",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "double",
            "lineageTag": "7cbe4102-5c43-46d6-8c86-eb1cea2e143b",
            "sourceColumn": "VALOR_ICMS",
            "summarizeBy": "sum"
          },
          {
            "name": "VALOR_ISS",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "double",
            "lineageTag": "00bac31d-1826-449d-8563-3e8156788c2c",
            "sourceColumn": "VALOR_ISS",
            "summarizeBy": "sum"
          },
          {
            "name": "VALOR_INSS",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "double",
            "lineageTag": "6ae1a475-1d95-49c2-895c-f3412bd6bf46",
            "sourceColumn": "VALOR_INSS",
            "summarizeBy": "sum"
          },
          {
            "name": "VALOR_IRRF",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "double",
            "lineageTag": "60c072a3-20b2-4288-99f9-5d633406b6f9",
            "sourceColumn": "VALOR_IRRF",
            "summarizeBy": "sum"
          },
          {
            "name": "VALOR_MERCADORIA_CONHECIMENTO",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "double",
            "lineageTag": "d86c7b4a-8759-4d51-bf81-101753f3f64e",
            "sourceColumn": "VALOR_MERCADORIA_CONHECIMENTO",
            "summarizeBy": "sum"
          },
          {
            "name": "VALOR_OUTROS_ITENS",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "double",
            "lineageTag": "8f5941e8-f5d8-48cd-a4a4-abc88adfb8db",
            "sourceColumn": "VALOR_OUTROS_ITENS",
            "summarizeBy": "sum"
          },
          {
            "name": "VALOR_PAGAR",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "double",
            "lineageTag": "a9a5b8e4-83cc-4574-a636-f4a16fc5485d",
            "sourceColumn": "VALOR_PAGAR",
            "summarizeBy": "sum"
          },
          {
            "name": "VALOR_PEDAGIO",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "double",
            "lineageTag": "4a52447c-0e96-419a-b427-0a824646c312",
            "sourceColumn": "VALOR_PEDAGIO",
            "summarizeBy": "sum"
          },
          {
            "name": "VALOR_PEDAGIO_PAMCARD",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "double",
            "lineageTag": "371a5d78-9e14-48a1-a016-bdad35b39483",
            "sourceColumn": "VALOR_PEDAGIO_PAMCARD",
            "summarizeBy": "sum"
          },
          {
            "name": "VALOR_SALDO_CONTRATO",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "double",
            "lineageTag": "86577d17-4d62-4a71-924d-d02b62219bb8",
            "sourceColumn": "VALOR_SALDO_CONTRATO",
            "summarizeBy": "sum"
          },
          {
            "name": "VALOR_SENAT",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "double",
            "lineageTag": "95053f77-46d6-4e9e-9d7e-4af74e92a907",
            "sourceColumn": "VALOR_SENAT",
            "summarizeBy": "sum"
          },
          {
            "name": "VALOR_SEST",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "double",
            "lineageTag": "9c70f2f0-20a3-49f8-b060-b8962eb6a76f",
            "sourceColumn": "VALOR_SEST",
            "summarizeBy": "sum"
          },
          {
            "name": "VALOR_SEST_SENAT",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "double",
            "lineageTag": "00a23fab-7350-43ef-bc20-04e07a6472ec",
            "sourceColumn": "VALOR_SEST_SENAT",
            "summarizeBy": "sum"
          },
          {
            "name": "VALOR_UNITARIO",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "double",
            "lineageTag": "fcf4fda2-9f7a-438c-bcb6-32cf706466e7",
            "sourceColumn": "VALOR_UNITARIO",
            "summarizeBy": "sum"
          },
          {
            "name": "PERCENTUAL_RECEITA",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "fabc6376-a592-4b31-b270-374af2203ffa",
            "sourceColumn": "PERCENTUAL_RECEITA",
            "summarizeBy": "sum"
          },
          {
            "name": "TOTAL_CF",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "5e29015b-13e9-4c36-9bfd-7004f976eb7f",
            "sourceColumn": "TOTAL_CF",
            "summarizeBy": "sum"
          },
          {
            "name": "TOTAL_IMPOSTOS",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "73dd51ad-18f5-4208-83d6-010a445b8d12",
            "sourceColumn": "TOTAL_IMPOSTOS",
            "summarizeBy": "sum"
          },
          {
            "name": "TOTAL_NOTA_FISCAL",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "a48dfcce-46c9-4347-aed2-3f19d31f8a7f",
            "sourceColumn": "TOTAL_NOTA_FISCAL",
            "summarizeBy": "sum"
          },
          {
            "name": "TOTAL_PEDAGIO",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "bc58d6a0-6335-49d0-b79a-f2ce8cc9f62e",
            "sourceColumn": "TOTAL_PEDAGIO",
            "summarizeBy": "sum"
          },
          {
            "name": "TOTAL_RECEITA",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "c60a93ec-b490-4f9e-8330-dd9b04808b40",
            "sourceColumn": "TOTAL_RECEITA",
            "summarizeBy": "sum"
          },
          {
            "name": "VALOR_MERCADORIA",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "674cd84a-9e86-4387-81bf-87050c25ea4b",
            "sourceColumn": "VALOR_MERCADORIA",
            "summarizeBy": "sum"
          },
          {
            "name": "VALOR_MERCADORIA_NF",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "f6003087-063d-48fb-ae4b-1cb75afdedfb",
            "sourceColumn": "VALOR_MERCADORIA_NF",
            "summarizeBy": "sum"
          },
          {
            "name": "VALOR_SALDO",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "double",
            "lineageTag": "354c11cc-29b4-439e-a097-9f13fcd88dcc",
            "sourceColumn": "VALOR_SALDO",
            "summarizeBy": "sum"
          },
          {
            "name": "VALOR_SEGURO",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "f3414334-c0f2-491e-b11e-bed362824eb0",
            "sourceColumn": "VALOR_SEGURO",
            "summarizeBy": "sum"
          },
          {
            "name": "source",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "isHidden": true,
            "lineageTag": "27a3291e-9dc6-4130-bc8b-a4e103bc680e",
            "sourceColumn": "source",
            "summarizeBy": "none"
          },
          {
            "name": "Lat_origem",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "double",
            "isHidden": true,
            "lineageTag": "ab1f9d73-4439-4320-a51a-099d615334f4",
            "sourceColumn": "Lat_origem",
            "summarizeBy": "sum"
          },
          {
            "name": "Lon_origem",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "double",
            "isHidden": true,
            "lineageTag": "2853118a-e963-4176-8ba9-85c90d11d907",
            "sourceColumn": "Lon_origem",
            "summarizeBy": "sum"
          },
          {
            "name": "Lat_destino",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "double",
            "isHidden": true,
            "lineageTag": "e11cf73d-e30b-44ff-b586-3030c4812a34",
            "sourceColumn": "Lat_destino",
            "summarizeBy": "sum"
          },
          {
            "name": "Lon_destino",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "double",
            "isHidden": true,
            "lineageTag": "48128502-38b3-4093-b4e9-b7c6fb4f2b0e",
            "sourceColumn": "Lon_destino",
            "summarizeBy": "sum"
          },
          {
            "name": "Distancia (KM)",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "double",
            "isHidden": true,
            "lineageTag": "c37ef1a6-99a8-4ecd-b6ec-fa830fa6af94",
            "sourceColumn": "Distancia (KM)",
            "summarizeBy": "sum"
          },
          {
            "name": "Distancia (M)",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "isHidden": true,
            "lineageTag": "c37476f2-49c9-4ba0-8c98-9e6908c8db36",
            "sourceColumn": "Distancia (M)",
            "summarizeBy": "none"
          },
          {
            "name": "Frota?",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "expression": [
              "",
              "VAR frota_ou_terceiro = RELATED( dimPLACA_FROTA[Placa] )",
              "RETURN",
              "IF( ",
              "    NOT ISBLANK( frota_ou_terceiro ), -- Se encontrar a placa na tabela de placas frota, retorna Frota",
              "    \"Frota\",",
              "    IF( LEN( fato_carta_frete[CNPJ_CPF_PROPRIETARIO_VEICULO]) = 11, -- Se o numero de caracteres na razao social proprietario for igual a 11 é CPF, caso contrário é CNPJ.",
              "        \"Motorista\", -- Se for CPF, Retorna Motorista",
              "        \"Transportadora\" -- Caso contrário é CNPJ, e retorna Transortadora",
              ")",
              ")"
            ],
            "isDataTypeInferred": true,
            "isHidden": true,
            "lineageTag": "df8f1ec5-562c-4aab-a6e9-9634741cd0b7",
            "summarizeBy": "none",
            "type": "calculated"
          },
          {
            "name": "TIPO_AUX",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "expression": "\"Normal\"",
            "isDataTypeInferred": true,
            "isHidden": true,
            "lineageTag": "32b9bb20-6be3-4f78-8878-5553f86ee02d",
            "summarizeBy": "none",
            "type": "calculated"
          },
          {
            "name": "CLIENTE_COBRANCA",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "isHidden": true,
            "lineageTag": "d82b503f-32c7-4f01-9d1e-b7a558def973",
            "sourceColumn": "CLIENTE_COBRANCA",
            "summarizeBy": "none"
          },
          {
            "name": "MUNICIPIO_DESTINO",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "isHidden": true,
            "lineageTag": "4221a22b-0d64-47f3-aa58-67840da13aea",
            "sourceColumn": "MUNICIPIO_DESTINO",
            "summarizeBy": "none"
          },
          {
            "name": "ROTA_ID",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "isHidden": true,
            "lineageTag": "71d559d8-2798-47f5-9014-827bf52eef3c",
            "sourceColumn": "ROTA_ID",
            "summarizeBy": "none"
          },
          {
            "name": "CHAVE_CONHECIMENTO_NF",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "expression": "fato_carta_frete[NUM_ROMANEIO] & fato_carta_frete[UNIDADE_NEGOCIO] & fato_carta_frete[NUM_CONHECIMENTO]",
            "isDataTypeInferred": true,
            "isHidden": true,
            "lineageTag": "3b2c4d08-2be8-4322-b2f3-90bd7826b75d",
            "summarizeBy": "none",
            "type": "calculated"
          },
          {
            "name": "DATA_EMISSAO_BACKUP",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "UnderlyingDateTimeDataType",
                "value": "Date"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "dateTime",
            "formatString": "Long Date",
            "isHidden": true,
            "lineageTag": "82511c3c-470f-42ad-bed3-b1ee2fe32a5b",
            "sourceColumn": "DATA_EMISSAO_BACKUP",
            "summarizeBy": "none"
          },
          {
            "name": "CENTROS_CUSTO_ROMANEIO",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "isHidden": true,
            "lineageTag": "afd0f2b9-78ee-4f1b-951a-492ab7c6cf76",
            "sourceColumn": "CENTROS_CUSTO_ROMANEIO",
            "summarizeBy": "none"
          },
          {
            "name": "DATA_EMISSAO_MINIMA_AJUSTADA",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "dateTime",
            "formatString": "General Date",
            "isHidden": true,
            "lineageTag": "afa90b61-e631-4e29-b686-4f85bc19bb1f",
            "sourceColumn": "DATA_EMISSAO_MINIMA_AJUSTADA",
            "summarizeBy": "none"
          }
        ],
        "lineageTag": "e3da0c43-134e-41fb-8062-1a3c0f2d6a33",
        "partitions": [
          {
            "name": "fato_carta_frete-3dc023ea-3d71-458c-98df-caf877ff61e3",
            "mode": "import",
            "source": {
              "expression": [
                "let",
                "    Fonte = Value.NativeQuery(Databricks.Catalogs(\"adb-1220993250695902.2.azuredatabricks.net\", \"/sql/1.0/warehouses/6b94e3b6ef796336\", [Catalog=\"hive_metastore\", Database=null, EnableAutomaticProxyDiscovery=null]){[Name=\"hive_metastore\",Kind=\"Database\"]}[Data], \"select ",
                "UNIDADE_NEGOCIO,",
                "PRESTADOR_SERVICO_CNPJ,",
                "PRESTADOR_SERVICO_RAZAO_SOCIAL,",
                "ACRESCIMOS,",
                "AVULSA,",
                "CARRETA,",
                "REPLACE(UPPER(CAVALO),'-','') AS CAVALO,",
                "CENTRO_CUSTO,",
                "CENTRO_CUSTO_GERENCIAL,",
                "CNPJ_CPF_MOTORISTA,",
                "REPLACE(REPLACE(REPLACE(CNPJ_CPF_PROPRIETARIO_VEICULO, '.',''), '/', ''), '-', '') AS CNPJ_CPF_PROPRIETARIO_VEICULO,",
                "COLETA,",
                "DATA_CANCELAMENTO,",
                "DATA_EMISSAO,",
                "DATE_INSERT,",
                "DATE_UPDATE,",
                "DESCONTOS,",
                "DESCRICAO_TIPO_CONTRATO,",
                "FRETE_CARRETEIRO,",
                "KM_CARREGADO,",
                "KM_VAZIO,",
                "LANCTO_ID,",
                "MODALIDADE_VEICULO,",
                "MOTIVO_CANCELAMENTO,",
                "NOME_MOTORISTA,",
                "NUM_CONHECIMENTO,",
                "NUM_ROMANEIO,",
                "NUM_VIAGEM_CTRC_CLIENTE,",
                "OPERACAO,",
                "OUTRAS_TAXAS,",
                "PEDAGIO_COBRADO,",
                "PESO,",
                "RAZAO_SOCIAL_PROPRIETARIO,",
                "REPOM_CONTRATO_AUTORIZADO,",
                "REPOM_CONTRATO_QUITADO,",
                "REPOM_CONTRATO_SITUACAO,",
                "REPOM_DATA_AUTORIZACAO,",
                "ROTA,",
                "SERIE_FORMULARIO,",
                "TIPO_CONTRATO,",
                "TOTAL_ACRESCIMOS,",
                "TOTAL_CONHECIMENTO,",
                "TOTAL_CONHECIMENTO_BRUTO,",
                "TOTAL_DESCONTOS,",
                "USER_INSERT,",
                "USER_UPDATE,",
                "VALOR_ADTO,",
                "VALOR_ADTO_COMB,",
                "VALOR_ADTO_PEDAGIO,",
                "VALOR_BASE_INSS,",
                "VALOR_CARGA_DESCARGA,",
                "VALOR_FRETE_BRUTO,",
                "VALOR_FRETE_LIQUIDO,",
                "VALOR_ICMS,",
                "VALOR_ISS,",
                "VALOR_INSS,",
                "VALOR_IRRF,",
                "VALOR_MERCADORIA_CONHECIMENTO,",
                "VALOR_OUTROS_ITENS,",
                "VALOR_PAGAR,",
                "VALOR_PEDAGIO,",
                "VALOR_PEDAGIO_PAMCARD,",
                "VALOR_SALDO_CONTRATO,",
                "VALOR_SENAT,",
                "VALOR_SEST,",
                "VALOR_SEST_SENAT,",
                "VALOR_UNITARIO,",
                "PERCENTUAL_RECEITA,",
                "TOTAL_CF,",
                "TOTAL_IMPOSTOS,",
                "TOTAL_NOTA_FISCAL,",
                "TOTAL_PEDAGIO,",
                "TOTAL_RECEITA,",
                "VALOR_MERCADORIA,",
                "VALOR_MERCADORIA_NF,",
                "VALOR_SALDO,",
                "VALOR_SEGURO,",
                "MUNICIPIO_DESTINO,",
                "CLIENTE_COBRANCA,",
                "source,",
                "ROTA_ID,",
                "cast(DATA_EMISSAO as date) as DATA_EMISSAO_BACKUP,",
                "case ",
                "  when NUM_ROMANEIO is null then replace(replace(replace(cast(CENTRO_CUSTO_GERENCIAL as string), 'Padrão /', ''), '[', ''), ']', '')",
                "  else replace(replace(replace(cast(collect_set( CENTRO_CUSTO_GERENCIAL ) OVER (PARTITION BY NUM_ROMANEIO,UNIDADE_NEGOCIO,SOURCE ) as string), 'Padrão /', ''), '[', ''), ']', '')",
                "  end as CENTROS_CUSTO_ROMANEIO,",
                "MIN(DATA_EMISSAO)  OVER (PARTITION BY NUM_ROMANEIO, UNIDADE_NEGOCIO, source ) AS DATA_EMISSAO_MINIMA_AJUSTADA",
                "from ouro_transportes.fato_carta_frete",
                "where DATA_CANCELAMENTO is null ",
                "and DATA_EMISSAO >= '2022-01-01'\", null, [EnableFolding=true]),",
                "    #\"DATA_EMISSAO p/ data\" = Table.TransformColumnTypes(Fonte,{{\"DATA_EMISSAO\", type date}}),",
                "    #\"CAVALO p/ Maiúscula\" = Table.TransformColumns(#\"DATA_EMISSAO p/ data\",{{\"CAVALO\", Text.Upper, type text}, {\"NOME_MOTORISTA\", Text.Upper, type text}, {\"OPERACAO\", Text.Upper, type text}, {\"RAZAO_SOCIAL_PROPRIETARIO\", Text.Upper, type text}, {\"ROTA\", Text.Upper, type text}, {\"source\", Text.Upper, type text}}),",
                "    #\"ROTA espaços Removidos\" = Table.ReplaceValue(#\"CAVALO p/ Maiúscula\",\" \",\"\",Replacer.ReplaceText,{\"ROTA\"}),",
                "    #\"Consultas Mescladas\" = Table.NestedJoin(#\"ROTA espaços Removidos\", {\"ROTA\"}, dimROTAS_DISTANCIAS, {\"Rota\"}, \"dimROTAS_DISTANCIAS\", JoinKind.LeftOuter),",
                "    #\"dimROTAS_DISTANCIAS Expandido\" = Table.ExpandTableColumn(#\"Consultas Mescladas\", \"dimROTAS_DISTANCIAS\", {\"Lat_origem\", \"Lon_origem\", \"Lat_destino\", \"Lon_destino\", \"Distancia (KM)\", \"Distancia (M)\"}, {\"Lat_origem\", \"Lon_origem\", \"Lat_destino\", \"Lon_destino\", \"Distancia (KM)\", \"Distancia (M)\"})",
                "in",
                "    #\"dimROTAS_DISTANCIAS Expandido\""
              ],
              "type": "m"
            }
          }
        ]
      },
      {
        "name": "fato_cte",
        "annotations": [
          {
            "name": "PBI_ResultType",
            "value": "Table"
          },
          {
            "name": "PBI_NavigationStepName",
            "value": "Navegação"
          }
        ],
        "columns": [
          {
            "name": "UNIDADE_NEGOCIO",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "isHidden": true,
            "lineageTag": "734c1f07-2a8c-4266-a4ce-d3636b442265",
            "sourceColumn": "UNIDADE_NEGOCIO",
            "summarizeBy": "none"
          },
          {
            "name": "PRESTADOR_SERVICO_RAZAO_SOCIAL",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "isHidden": true,
            "lineageTag": "7b9599b8-682e-42b7-9003-8e07c5ac5f4e",
            "sourceColumn": "PRESTADOR_SERVICO_RAZAO_SOCIAL",
            "summarizeBy": "none"
          },
          {
            "name": "COD_CENTRO_CUSTO_GERENCIAL",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "isHidden": true,
            "lineageTag": "6b1d4981-72f6-442d-a21b-280ed7a4c32b",
            "sourceColumn": "COD_CENTRO_CUSTO_GERENCIAL",
            "summarizeBy": "none"
          },
          {
            "name": "CENTRO_CUSTO_GERENCIAL",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "isHidden": true,
            "lineageTag": "ada81075-6ffc-44ad-bbbe-ec20c8b318b8",
            "sourceColumn": "CENTRO_CUSTO_GERENCIAL",
            "summarizeBy": "none"
          },
          {
            "name": "OPERACAO",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "isHidden": true,
            "lineageTag": "1ea601bb-ca54-4732-8536-9632c95c7ced",
            "sourceColumn": "OPERACAO",
            "summarizeBy": "none"
          },
          {
            "name": "CENTRO_CUSTO",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "isHidden": true,
            "lineageTag": "d6cd6f53-fc87-4b31-af7a-caa3cbaaeafa",
            "sourceColumn": "CENTRO_CUSTO",
            "summarizeBy": "none"
          },
          {
            "name": "NUM_ROMANEIO",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "isHidden": true,
            "lineageTag": "174ecc07-c57a-48e6-8eb5-e054db61251d",
            "sourceColumn": "NUM_ROMANEIO",
            "summarizeBy": "none"
          },
          {
            "name": "NUM_CONHECIMENTO",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "afaadcd5-9747-4ab5-aeb1-3a9adb8d7f92",
            "sourceColumn": "NUM_CONHECIMENTO",
            "summarizeBy": "none"
          },
          {
            "name": "SERIE",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "isHidden": true,
            "lineageTag": "9e2a77e4-1871-42ee-bd5d-c030c238ab9e",
            "sourceColumn": "SERIE",
            "summarizeBy": "none"
          },
          {
            "name": "DATA_EMISSAO",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "UnderlyingDateTimeDataType",
                "value": "Date"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "dateTime",
            "formatString": "Short Date",
            "isHidden": true,
            "lineageTag": "7f76d596-9773-4168-bf39-5a472167e883",
            "sourceColumn": "DATA_EMISSAO",
            "summarizeBy": "none"
          },
          {
            "name": "NOTAS_FISCAIS",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "isHidden": true,
            "lineageTag": "88ffcd00-04bc-4fab-a81e-bd95f0e717b7",
            "sourceColumn": "NOTAS_FISCAIS",
            "summarizeBy": "none"
          },
          {
            "name": "COB_CNPJ_CPF",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "isHidden": true,
            "lineageTag": "493757f4-8208-42bc-96cb-64154278765e",
            "sourceColumn": "COB_CNPJ_CPF",
            "summarizeBy": "none"
          },
          {
            "name": "COB_RAZAO_SOCIAL",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "isHidden": true,
            "lineageTag": "ac0060db-d498-445c-8983-535765c3e4a1",
            "sourceColumn": "COB_RAZAO_SOCIAL",
            "summarizeBy": "none"
          },
          {
            "name": "VALOR_TOTAL_MERCADORIA",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "9882cf39-8121-413f-90c1-c4b50cbdf18e",
            "sourceColumn": "VALOR_TOTAL_MERCADORIA",
            "summarizeBy": "sum"
          },
          {
            "name": "GRIS",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "20388587-f2b7-44e0-842b-515107c2740b",
            "sourceColumn": "GRIS",
            "summarizeBy": "sum"
          },
          {
            "name": "VALOR_ICMS",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "fd70aee2-179a-468d-a757-bca517d31999",
            "sourceColumn": "VALOR_ICMS",
            "summarizeBy": "sum"
          },
          {
            "name": "TOTAL_CONHECIMENTO",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "21eb8036-b1a4-422a-8d14-5782434dfcf3",
            "sourceColumn": "TOTAL_CONHECIMENTO",
            "summarizeBy": "sum"
          },
          {
            "name": "TOTAL_CONHECIMENTO_LIQUIDO",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "0ea5ab1f-f244-4bf4-a03d-ee6af45d9c14",
            "sourceColumn": "TOTAL_CONHECIMENTO_LIQUIDO",
            "summarizeBy": "sum"
          },
          {
            "name": "TOTAL_CONHECIMENTO_SEM_IMPOSTO",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "0a643653-4199-4187-99d3-f62ca3390b66",
            "sourceColumn": "TOTAL_CONHECIMENTO_SEM_IMPOSTO",
            "summarizeBy": "sum"
          },
          {
            "name": "SIGLA_UF_COLETA",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "isHidden": true,
            "lineageTag": "def9ca74-2060-40bf-b60a-ac400e62c85e",
            "sourceColumn": "SIGLA_UF_COLETA",
            "summarizeBy": "none"
          },
          {
            "name": "NOME_LOCAL_COLETA",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "isHidden": true,
            "lineageTag": "40c9f93d-2f93-4d44-abaf-2c60438e1144",
            "sourceColumn": "NOME_LOCAL_COLETA",
            "summarizeBy": "none"
          },
          {
            "name": "SIGLA_UF_ENTREGA",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "isHidden": true,
            "lineageTag": "f0b24f3a-aa4e-4f44-9df6-afc1b95781a1",
            "sourceColumn": "SIGLA_UF_ENTREGA",
            "summarizeBy": "none"
          },
          {
            "name": "NOME_LOCAL_ENTREGA",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "isHidden": true,
            "lineageTag": "c5b4973f-17a5-48f3-97c7-3c358ddfb5c2",
            "sourceColumn": "NOME_LOCAL_ENTREGA",
            "summarizeBy": "none"
          },
          {
            "name": "TIPO_VEICULO",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "isHidden": true,
            "lineageTag": "921525a5-96b0-42df-a593-7e2a4c419c12",
            "sourceColumn": "TIPO_VEICULO",
            "summarizeBy": "none"
          },
          {
            "name": "PLACA_TRACAO",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "isHidden": true,
            "lineageTag": "ccbc25d2-b2a6-469f-8af7-fb518fbb6496",
            "sourceColumn": "PLACA_TRACAO",
            "summarizeBy": "none"
          },
          {
            "name": "PROP_CNPJ_CPF",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "isHidden": true,
            "lineageTag": "e5bf6480-e7d2-46a7-a507-f8b71a9fe7b3",
            "sourceColumn": "PROP_CNPJ_CPF",
            "summarizeBy": "none"
          },
          {
            "name": "PROP_RAZAO_SOCIAL",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "isHidden": true,
            "lineageTag": "5c4acd19-a6d9-4b48-8b99-b84dd51d753a",
            "sourceColumn": "PROP_RAZAO_SOCIAL",
            "summarizeBy": "none"
          },
          {
            "name": "NOME_MOTORISTA",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "isHidden": true,
            "lineageTag": "6053cf5b-0899-4eb6-8a66-05abafe278cd",
            "sourceColumn": "NOME_MOTORISTA",
            "summarizeBy": "none"
          },
          {
            "name": "MERCADORIA",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "isHidden": true,
            "lineageTag": "56bc4b4d-f531-483b-92fb-f122102b0039",
            "sourceColumn": "MERCADORIA",
            "summarizeBy": "none"
          },
          {
            "name": "PESO",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "b440b796-1097-49af-8565-1f944d41567c",
            "sourceColumn": "PESO",
            "summarizeBy": "sum"
          },
          {
            "name": "VOLUME",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "0d08a2d9-352a-44fe-bf2e-d95a562d0520",
            "sourceColumn": "VOLUME",
            "summarizeBy": "sum"
          },
          {
            "name": "NATUREZA_OPERACAO",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "isHidden": true,
            "lineageTag": "e9f8f734-2a92-4135-9c5c-fb48d707f22e",
            "sourceColumn": "NATUREZA_OPERACAO",
            "summarizeBy": "none"
          },
          {
            "name": "CONHECIMENTO_TIPO",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "isHidden": true,
            "lineageTag": "77eabf9e-740b-4034-8bb4-41f4b7eec796",
            "sourceColumn": "CONHECIMENTO_TIPO",
            "summarizeBy": "none"
          },
          {
            "name": "STATUS_CTE",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "isHidden": true,
            "lineageTag": "74125781-d3e6-4fd3-8594-58c246e9bf27",
            "sourceColumn": "STATUS_CTE",
            "summarizeBy": "none"
          },
          {
            "name": "VALOR_FATURAMENTO",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "8e5562ad-a85f-4a34-82e3-a7e0e8b7f5c5",
            "sourceColumn": "VALOR_FATURAMENTO",
            "summarizeBy": "sum"
          },
          {
            "name": "FRETE_VALOR",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "acd7c995-db17-47ee-ae6a-3364d7f14092",
            "sourceColumn": "FRETE_VALOR",
            "summarizeBy": "sum"
          },
          {
            "name": "VALOR_ADVALOREM",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "0ed7acb1-9df0-45da-92cc-16b3da9ab411",
            "sourceColumn": "VALOR_ADVALOREM",
            "summarizeBy": "sum"
          },
          {
            "name": "VALOR_PEDAGIO",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "238caf6c-6cec-470b-933a-cb3f0c833753",
            "sourceColumn": "VALOR_PEDAGIO",
            "summarizeBy": "sum"
          },
          {
            "name": "VALOR_ESTACIONAMENTO",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "9589bde8-f1fe-4e3d-8ee8-55f7ef0208a9",
            "sourceColumn": "VALOR_ESTACIONAMENTO",
            "summarizeBy": "sum"
          },
          {
            "name": "VALOR_ESCOLTA",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "448ad43c-9c73-4746-8ec7-82c9dd117ea5",
            "sourceColumn": "VALOR_ESCOLTA",
            "summarizeBy": "sum"
          },
          {
            "name": "VALOR_TAXA_EMISSAO",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "e78a3292-267d-49ec-bda5-eecbc1e72175",
            "sourceColumn": "VALOR_TAXA_EMISSAO",
            "summarizeBy": "sum"
          },
          {
            "name": "VALOR_RCTRC",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "d86c0a2e-f8dd-4ab1-b7c3-53b363668e47",
            "sourceColumn": "VALOR_RCTRC",
            "summarizeBy": "sum"
          },
          {
            "name": "OUTROS",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "double",
            "isHidden": true,
            "lineageTag": "eeb7fb2d-0090-4ce7-a208-a8c3651507bc",
            "sourceColumn": "OUTROS",
            "summarizeBy": "sum"
          },
          {
            "name": "VALOR_DTA_AEREA",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "60bf450e-f0ce-4cf7-8055-84f52e0fa3fc",
            "sourceColumn": "VALOR_DTA_AEREA",
            "summarizeBy": "sum"
          },
          {
            "name": "VALOR_AJUDANTE",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "5caab95f-a972-4ab7-95cd-167e01e67d67",
            "sourceColumn": "VALOR_AJUDANTE",
            "summarizeBy": "sum"
          },
          {
            "name": "VALOR_OUTROS",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "7deb9d37-d720-4384-b2aa-7b3d085c69d9",
            "sourceColumn": "VALOR_OUTROS",
            "summarizeBy": "sum"
          },
          {
            "name": "VALOR_EXCESSO_PESO",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "73f5445c-8a4b-48c9-9675-280311fe24a8",
            "sourceColumn": "VALOR_EXCESSO_PESO",
            "summarizeBy": "sum"
          },
          {
            "name": "VALOR_DEVOLUCAO_ME",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "906aa1a5-7f6e-4342-8f6b-4a052aa622d0",
            "sourceColumn": "VALOR_DEVOLUCAO_ME",
            "summarizeBy": "sum"
          },
          {
            "name": "VALOR_DEV_MD",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "d9ea4e6c-f8d3-4557-9327-503aef8cfaa4",
            "sourceColumn": "VALOR_DEV_MD",
            "summarizeBy": "sum"
          },
          {
            "name": "ADICIONAL_IMO",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "a64a33f0-66f4-4942-abc5-1fc04a36b1bc",
            "sourceColumn": "ADICIONAL_IMO",
            "summarizeBy": "sum"
          },
          {
            "name": "VALOR_COLETA_ME",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "a5e5f701-ceaf-4f1c-8a02-c656b50d6dd9",
            "sourceColumn": "VALOR_COLETA_ME",
            "summarizeBy": "sum"
          },
          {
            "name": "VALOR_IMO",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "54fedb45-3075-4048-b6b3-72545f580a11",
            "sourceColumn": "VALOR_IMO",
            "summarizeBy": "sum"
          },
          {
            "name": "source",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "isHidden": true,
            "lineageTag": "87e8963f-a0da-4261-8c41-e3e9337f41f5",
            "sourceColumn": "source",
            "summarizeBy": "none"
          },
          {
            "name": "ROTA",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "isHidden": true,
            "lineageTag": "cb12c940-6a29-491b-b8da-dd79b6db6753",
            "sourceColumn": "ROTA",
            "summarizeBy": "none"
          },
          {
            "name": "Lat_origem",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "double",
            "isHidden": true,
            "lineageTag": "8ea12c30-cf3d-4675-b52e-f5ef754b4bc1",
            "sourceColumn": "Lat_origem",
            "summarizeBy": "sum"
          },
          {
            "name": "Lon_origem",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "double",
            "isHidden": true,
            "lineageTag": "71180c7c-9968-4ed4-9704-9929c2148ca9",
            "sourceColumn": "Lon_origem",
            "summarizeBy": "sum"
          },
          {
            "name": "Lat_destino",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "double",
            "isHidden": true,
            "lineageTag": "e2397739-9ad6-455a-9e20-0b7961cafaba",
            "sourceColumn": "Lat_destino",
            "summarizeBy": "sum"
          },
          {
            "name": "Lon_destino",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "double",
            "isHidden": true,
            "lineageTag": "ad74978c-6449-469a-97c8-6e4dd47530c9",
            "sourceColumn": "Lon_destino",
            "summarizeBy": "sum"
          },
          {
            "name": "Distancia (KM)",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "double",
            "isHidden": true,
            "lineageTag": "c9f8277f-483a-40c0-8c04-5b9f943cc926",
            "sourceColumn": "Distancia (KM)",
            "summarizeBy": "sum"
          },
          {
            "name": "Distancia (M)",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "isHidden": true,
            "lineageTag": "e278d9fc-1ad5-41b0-a6a2-5a4106603f04",
            "sourceColumn": "Distancia (M)",
            "summarizeBy": "none"
          },
          {
            "name": "Frota?",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "expression": [
              "",
              "VAR frota_ou_terceiro = RELATED( dimPLACA_FROTA[Placa] )",
              "RETURN",
              "IF( ",
              "    NOT ISBLANK( frota_ou_terceiro ), -- Se encontrar a placa na tabela de placas frota, retorna Frota",
              "    \"Frota\",",
              "    IF( LEN( fato_cte[PROP_CNPJ_CPF]) = 11, -- Se o numero de caracteres na razao social proprietario for igual a 11 é CPF, caso contrário é CNPJ.",
              "        \"Motorista\", -- Se for CPF, Retorna Motorista",
              "        \"Transportadora\" -- Caso contrário é CNPJ, e retorna Transortadora",
              ")",
              ")"
            ],
            "isDataTypeInferred": true,
            "lineageTag": "e0cd769a-4627-4a51-8b7d-72f91a685ca4",
            "summarizeBy": "none",
            "type": "calculated"
          },
          {
            "name": "Operacao Unificada",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "expression": [
              "",
              "LOOKUPVALUE( dimOPERACAO[Operacao Unificada], dimOPERACAO[OPERACAO], fato_cte[OPERACAO])"
            ],
            "isDataTypeInferred": true,
            "isHidden": true,
            "lineageTag": "15e55538-189b-48a2-9632-0f1e4d3d1332",
            "summarizeBy": "none",
            "type": "calculated"
          },
          {
            "name": "DATA_EMISSAO_BACKUP",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "dateTime",
            "formatString": "General Date",
            "isHidden": true,
            "lineageTag": "906f26ae-5888-44cb-b0fd-7ef2b3624525",
            "sourceColumn": "DATA_EMISSAO_BACKUP",
            "summarizeBy": "none"
          },
          {
            "name": "ExisteCartaFrete?",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "expression": [
              "",
              "",
              "VAR romaneio_procurado = LOOKUPVALUE( fato_carta_frete[NUM_ROMANEIO], fato_carta_frete[NUM_ROMANEIO], fato_cte[NUM_ROMANEIO])",
              "",
              "-- Procura pelo romaneio na tabela de fato_carta_frete",
              "RETURN",
              "IF ( ISBLANK( romaneio_procurado ) , ",
              "    \"Não\", -- Se não encontrar, retorna nulo, ou seja, não tem carta frete, está em aberto",
              "    \"Sim\") -- Se encontrar, retorna Sim"
            ],
            "isDataTypeInferred": true,
            "isHidden": true,
            "lineageTag": "d626655e-c7f2-470a-8885-5ccb71d995d0",
            "summarizeBy": "none",
            "type": "calculated"
          },
          {
            "name": "Super_chave",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "expression": "fato_cte[NUM_ROMANEIO] & fato_cte[UNIDADE_NEGOCIO] & fato_cte[ROTA]",
            "isDataTypeInferred": true,
            "isHidden": true,
            "lineageTag": "a52935bd-dd92-4742-adbc-9e2f04c375c8",
            "summarizeBy": "none",
            "type": "calculated"
          },
          {
            "name": "Chave_faturamento",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "expression": "fato_cte[NUM_ROMANEIO] & \"|\" & fato_cte[NUM_CONHECIMENTO]",
            "isDataTypeInferred": true,
            "isHidden": true,
            "lineageTag": "5bd438fc-8e3b-4907-939c-9d1ef4445825",
            "summarizeBy": "none",
            "type": "calculated"
          },
          {
            "name": "chave_viagem_centro",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "expression": [
              "",
              " fato_cte[NUM_ROMANEIO] & \"|\" & fato_cte[CENTRO_CUSTO] & \"|\" & fato_cte[DATA_EMISSAO]"
            ],
            "isDataTypeInferred": true,
            "isHidden": true,
            "lineageTag": "13679a6b-8ca7-4b84-aa2b-8815a42abe6f",
            "summarizeBy": "none",
            "type": "calculated"
          },
          {
            "name": "CENTROS_CUSTO_ROMANEIO",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "isHidden": true,
            "lineageTag": "cc486a5b-40d6-4cd2-abde-a18ec2fb1627",
            "sourceColumn": "CENTROS_CUSTO_ROMANEIO",
            "summarizeBy": "none"
          },
          {
            "name": "DATA_EMISSAO_MINIMA_AJUSTADA",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "UnderlyingDateTimeDataType",
                "value": "Date"
              }
            ],
            "dataType": "dateTime",
            "formatString": "Long Date",
            "lineageTag": "083c9f6b-ccb9-40a5-ba15-985020c02d78",
            "sourceColumn": "DATA_EMISSAO_MINIMA_AJUSTADA",
            "summarizeBy": "none"
          }
        ],
        "lineageTag": "f83e7af1-923c-4a9f-a6b1-2727bf4ad649",
        "partitions": [
          {
            "name": "fato_cte-7f2caece-c4b3-4056-b107-2a17fe0baf7c",
            "mode": "import",
            "source": {
              "expression": [
                "let",
                "    Fonte = Value.NativeQuery(Databricks.Catalogs(\"adb-1220993250695902.2.azuredatabricks.net\", \"/sql/1.0/warehouses/6b94e3b6ef796336\", [Catalog=\"hive_metastore\", Database=null, EnableAutomaticProxyDiscovery=null]){[Name=\"hive_metastore\",Kind=\"Database\"]}[Data], \"select ",
                "UNIDADE_NEGOCIO,",
                "PRESTADOR_SERVICO_RAZAO_SOCIAL,",
                "COD_CENTRO_CUSTO_GERENCIAL,",
                "case ",
                "  when trim(CENTRO_CUSTO_GERENCIAL) = '' and source = 'LOGIX' then 'C.C Indefinido'",
                "  else coalesce(CENTRO_CUSTO_GERENCIAL, 'C.C Indefinido')",
                "  end as CENTRO_CUSTO_GERENCIAL,",
                "case ",
                "  when OPERACAO is null then 'Sem Centro'",
                "  else upper(OPERACAO)",
                "  end as OPERACAO,",
                "CENTRO_CUSTO,",
                "NUM_ROMANEIO,",
                "NUM_CONHECIMENTO,",
                "SERIE,",
                "DATA_EMISSAO,",
                "NOTAS_FISCAIS,",
                "COB_CNPJ_CPF,",
                "upper(COB_RAZAO_SOCIAL) as COB_RAZAO_SOCIAL,",
                "try_divide(VALOR_TOTAL_MERCADORIA, regexp_count(NOTAS_FISCAIS, ',') + 1) as VALOR_TOTAL_MERCADORIA,",
                "GRIS,",
                "VALOR_ICMS,",
                "TOTAL_CONHECIMENTO,",
                "TOTAL_CONHECIMENTO_LIQUIDO,",
                "TOTAL_CONHECIMENTO_SEM_IMPOSTO,",
                "SIGLA_UF_COLETA,",
                "upper(NOME_LOCAL_COLETA) as NOME_LOCAL_COLETA,",
                "upper(SIGLA_UF_ENTREGA) as SIGLA_UF_ENTREGA,",
                "upper(NOME_LOCAL_ENTREGA) as NOME_LOCAL_ENTREGA,",
                "TIPO_VEICULO,",
                "replace(upper(PLACA_TRACAO), '-', '') as PLACA_TRACAO,",
                "replace(replace(replace(PROP_CNPJ_CPF, '-', ''),'/',''),'.','') as PROP_CNPJ_CPF,",
                "upper(PROP_RAZAO_SOCIAL) as PROP_RAZAO_SOCIAL,",
                "upper(NOME_MOTORISTA) as NOME_MOTORISTA,",
                "MERCADORIA,",
                "PESO,",
                "VOLUME,",
                "NATUREZA_OPERACAO,",
                "CONHECIMENTO_TIPO,",
                "STATUS_CTE,",
                "VALOR_FATURAMENTO,",
                "FRETE_VALOR,",
                "VALOR_ADVALOREM,",
                "VALOR_PEDAGIO,",
                "VALOR_ESTACIONAMENTO,",
                "VALOR_ESCOLTA,",
                "VALOR_TAXA_EMISSAO,",
                "VALOR_RCTRC,",
                "OUTROS,",
                "VALOR_DTA_AEREA,",
                "VALOR_AJUDANTE,",
                "VALOR_OUTROS,",
                "VALOR_EXCESSO_PESO,",
                "VALOR_DEVOLUCAO_ME,",
                "VALOR_DEV_MD,",
                "ADICIONAL_IMO,",
                "VALOR_COLETA_ME,",
                "VALOR_IMO,",
                "source,",
                "upper(replace( trim( concat(NOME_LOCAL_COLETA,'/', SIGLA_UF_COLETA, 'X', NOME_LOCAL_ENTREGA, '/', SIGLA_UF_ENTREGA)) ,' ', '')) AS ROTA,",
                "case ",
                "  when NUM_ROMANEIO is null then replace(replace(replace(cast(CENTRO_CUSTO_GERENCIAL as string), 'Padrão /', ''), '[', ''), ']', '')",
                "  else replace(replace(replace(cast(collect_set( CENTRO_CUSTO_GERENCIAL ) OVER (PARTITION BY NUM_ROMANEIO,UNIDADE_NEGOCIO,SOURCE ) as string), 'Padrão /', ''), '[', ''), ']', '')",
                "  end as CENTROS_CUSTO_ROMANEIO,",
                "MIN(DATA_EMISSAO)  OVER (PARTITION BY NUM_ROMANEIO, UNIDADE_NEGOCIO, source ) AS DATA_EMISSAO_MINIMA_AJUSTADA",
                "from ouro_transportes.fato_cte ",
                "where CANCELADA = 'Não' ",
                "and DATA_EMISSAO >= '2021-01-01'",
                "and STATUS_CTE IN ( 'Autorizado o uso do CT-e', 'Autorizado o uso do CTe','Autorizado o uso do CT-e.')\", null, [EnableFolding=true]),",
                "    #\"Coluna Duplicada\" = Table.DuplicateColumn(Fonte, \"DATA_EMISSAO\", \"DATA_EMISSAO - Copiar\"),",
                "    #\"Colunas Renomeadas\" = Table.RenameColumns(#\"Coluna Duplicada\",{{\"DATA_EMISSAO - Copiar\", \"DATA_EMISSAO_BACKUP\"}}),",
                "    #\"DATA_EMISSAO p/ data\" = Table.TransformColumnTypes(#\"Colunas Renomeadas\",{{\"DATA_EMISSAO\", type date}}),",
                "    #\"Texto Limpo\" = Table.TransformColumns(#\"DATA_EMISSAO p/ data\",{{\"NOME_LOCAL_COLETA\", Text.Clean, type text}, {\"SIGLA_UF_COLETA\", Text.Clean, type text}, {\"SIGLA_UF_ENTREGA\", Text.Clean, type text}, {\"NOME_LOCAL_ENTREGA\", Text.Clean, type text}}),",
                "    #\"Consultas Mescladas\" = Table.NestedJoin(#\"Texto Limpo\", {\"ROTA\"}, dimROTAS_DISTANCIAS, {\"Rota\"}, \"dimROTAS_DISTANCIAS\", JoinKind.LeftOuter),",
                "    #\"dimROTAS_DISTANCIAS Expandido\" = Table.ExpandTableColumn(#\"Consultas Mescladas\", \"dimROTAS_DISTANCIAS\", {\"Lat_origem\", \"Lon_origem\", \"Lat_destino\", \"Lon_destino\", \"Distancia (KM)\", \"Distancia (M)\"}, {\"Lat_origem\", \"Lon_origem\", \"Lat_destino\", \"Lon_destino\", \"Distancia (KM)\", \"Distancia (M)\"}),",
                "    #\"CONHECIMENTO Normal\" = Table.ReplaceValue(#\"dimROTAS_DISTANCIAS Expandido\",\"Conhecimento Normal\",\"Normal\",Replacer.ReplaceText,{\"CONHECIMENTO_TIPO\"}),",
                "    #\"CENTRO CUSTO VAZIO SUBSTITUIDO\" = Table.ReplaceValue(#\"CONHECIMENTO Normal\",\"    \",\"C.C Indefinido\",Replacer.ReplaceText,{\"CENTROS_CUSTO_ROMANEIO\"}),",
                "    #\"Tipo Alterado\" = Table.TransformColumnTypes(#\"CENTRO CUSTO VAZIO SUBSTITUIDO\",{{\"DATA_EMISSAO_MINIMA_AJUSTADA\", type date}})",
                "in",
                "    #\"Tipo Alterado\""
              ],
              "type": "m"
            }
          }
        ]
      },
      {
        "name": "fato_nf",
        "annotations": [
          {
            "name": "PBI_ResultType",
            "value": "Table"
          },
          {
            "name": "PBI_NavigationStepName",
            "value": "Navegação"
          }
        ],
        "columns": [
          {
            "name": "UNIDADE_NEGOCIO",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "isHidden": true,
            "lineageTag": "94a073cd-981b-4927-92a0-ea64950b9ce7",
            "sourceColumn": "UNIDADE_NEGOCIO",
            "summarizeBy": "none"
          },
          {
            "name": "PRESTADOR_SERVICO_RAZAO_SOCIAL",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "isHidden": true,
            "lineageTag": "1ab9a054-7fea-4567-b101-1230b03ba7b7",
            "sourceColumn": "PRESTADOR_SERVICO_RAZAO_SOCIAL",
            "summarizeBy": "none"
          },
          {
            "name": "DESCRICAO_ORGANIZACIONAL",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "isHidden": true,
            "lineageTag": "b2e16885-5331-4bef-9eaf-9ad92d28e66f",
            "sourceColumn": "DESCRICAO_ORGANIZACIONAL",
            "summarizeBy": "none"
          },
          {
            "name": "CENTRO_CUSTO",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "isHidden": true,
            "lineageTag": "a1c9ce09-c04a-432d-ac2a-3f3cc83a9f13",
            "sourceColumn": "CENTRO_CUSTO",
            "summarizeBy": "none"
          },
          {
            "name": "OPERACAO",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "isHidden": true,
            "lineageTag": "8881f7cb-17c1-45f1-b618-f41ad006e360",
            "sourceColumn": "OPERACAO",
            "summarizeBy": "none"
          },
          {
            "name": "NUM_ROMANEIO",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "isHidden": true,
            "lineageTag": "4e603fe5-2565-444a-987a-4ffadbfa358f",
            "sourceColumn": "NUM_ROMANEIO",
            "summarizeBy": "none"
          },
          {
            "name": "NUM_NOTA_FISCAL",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "bc47c38b-ccbb-4535-ad94-7846bf4c34e4",
            "sourceColumn": "NUM_NOTA_FISCAL",
            "summarizeBy": "none"
          },
          {
            "name": "SERIE",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "isHidden": true,
            "lineageTag": "81604231-7ef7-4bfe-a86e-19eaf0cdf066",
            "sourceColumn": "SERIE",
            "summarizeBy": "none"
          },
          {
            "name": "DATA_EMISSAO",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "UnderlyingDateTimeDataType",
                "value": "Date"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "dateTime",
            "formatString": "Short Date",
            "isHidden": true,
            "lineageTag": "813e0965-3b17-4347-a2df-c2cd2ea03d05",
            "sourceColumn": "DATA_EMISSAO",
            "summarizeBy": "none"
          },
          {
            "name": "NOTAS_FISCAIS",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "isHidden": true,
            "lineageTag": "be63ebf4-3624-4cab-a9c0-8180b69743d4",
            "sourceColumn": "NOTAS_FISCAIS",
            "summarizeBy": "none"
          },
          {
            "name": "COB_RAZAO_SOCIAL",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "isHidden": true,
            "lineageTag": "7bc533a7-7d0a-488a-aef7-8508d0acd54b",
            "sourceColumn": "COB_RAZAO_SOCIAL",
            "summarizeBy": "none"
          },
          {
            "name": "CALC_VALOR_TOTAL_PRODUTOS",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "double",
            "isHidden": true,
            "lineageTag": "1f1fa3ed-484f-469f-b8b0-f8adb8e4edff",
            "sourceColumn": "CALC_VALOR_TOTAL_PRODUTOS",
            "summarizeBy": "sum"
          },
          {
            "name": "GRIS",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "37591060-79b4-41d2-97eb-d70f8591611d",
            "sourceColumn": "GRIS",
            "summarizeBy": "sum"
          },
          {
            "name": "SERV_ISS_VALOR",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "6171a55a-ff18-4dd2-974c-8af161baa9dd",
            "sourceColumn": "SERV_ISS_VALOR",
            "summarizeBy": "sum"
          },
          {
            "name": "CALC_VALOR_TOTAL_NOTA",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "double",
            "isHidden": true,
            "lineageTag": "495fa8b1-23cb-4183-ba82-90ba38d2b1f9",
            "sourceColumn": "CALC_VALOR_TOTAL_NOTA",
            "summarizeBy": "sum"
          },
          {
            "name": "PEDAGIO",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "627ff0c7-55ff-45c8-a5ff-9b6938fa2b71",
            "sourceColumn": "PEDAGIO",
            "summarizeBy": "sum"
          },
          {
            "name": "SIGLA_UF_COLETA",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "isHidden": true,
            "lineageTag": "46521a90-8d81-4403-8df6-d9dc461748e7",
            "sourceColumn": "SIGLA_UF_COLETA",
            "summarizeBy": "none"
          },
          {
            "name": "SIGLA_UF_ENTREGA",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "isHidden": true,
            "lineageTag": "cf46b6cb-5fd9-407f-96b9-2fdb8c46af37",
            "sourceColumn": "SIGLA_UF_ENTREGA",
            "summarizeBy": "none"
          },
          {
            "name": "NOME_LOCAL_COLETA",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "isHidden": true,
            "lineageTag": "00c26667-96a6-4ec0-827b-af6951fdb5b0",
            "sourceColumn": "NOME_LOCAL_COLETA",
            "summarizeBy": "none"
          },
          {
            "name": "NOME_LOCAL_ENTREGA",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "isHidden": true,
            "lineageTag": "6ccb1816-4a72-4c5b-905b-1b8f42010f7c",
            "sourceColumn": "NOME_LOCAL_ENTREGA",
            "summarizeBy": "none"
          },
          {
            "name": "TIPO_VEICULO",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "isHidden": true,
            "lineageTag": "557f18ba-d65d-414b-b146-0d06e4ff6bfc",
            "sourceColumn": "TIPO_VEICULO",
            "summarizeBy": "none"
          },
          {
            "name": "PLACA_TRACAO",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "isHidden": true,
            "lineageTag": "0d4aa457-8271-4952-a4c4-649796ca3688",
            "sourceColumn": "PLACA_TRACAO",
            "summarizeBy": "none"
          },
          {
            "name": "PROP_CNPJ_CPF",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "isHidden": true,
            "lineageTag": "46cedb50-1951-4e04-b369-931e5d2b8f93",
            "sourceColumn": "PROP_CNPJ_CPF",
            "summarizeBy": "none"
          },
          {
            "name": "PROP_RAZAO_SOCIAL",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "isHidden": true,
            "lineageTag": "3522b8e9-c957-46d5-a84e-d3682ccfbab2",
            "sourceColumn": "PROP_RAZAO_SOCIAL",
            "summarizeBy": "none"
          },
          {
            "name": "NOME_MOTORISTA",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "isHidden": true,
            "lineageTag": "b3793d55-55e1-4813-85b3-1622fc9718d9",
            "sourceColumn": "NOME_MOTORISTA",
            "summarizeBy": "none"
          },
          {
            "name": "MERCADORIA",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "isHidden": true,
            "lineageTag": "c2c0eab1-11ce-4062-a2c9-48ad2d68d388",
            "sourceColumn": "MERCADORIA",
            "summarizeBy": "none"
          },
          {
            "name": "PESO",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "ea122115-f39d-431a-ba8e-67ac0c3769f8",
            "sourceColumn": "PESO",
            "summarizeBy": "sum"
          },
          {
            "name": "VOLUME",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "39c070b9-cdf3-4f83-8819-e7e74ea104e2",
            "sourceColumn": "VOLUME",
            "summarizeBy": "sum"
          },
          {
            "name": "FRETE",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "d647d966-9edb-4485-b536-3056ec03df5a",
            "sourceColumn": "FRETE",
            "summarizeBy": "sum"
          },
          {
            "name": "FRETE_PESO",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "b9827759-46b8-4aef-abcd-f9e699786b32",
            "sourceColumn": "FRETE_PESO",
            "summarizeBy": "sum"
          },
          {
            "name": "VALOR_ADVALOREM",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "a08d3e79-70df-4f7d-95da-5b72f000fdb0",
            "sourceColumn": "VALOR_ADVALOREM",
            "summarizeBy": "sum"
          },
          {
            "name": "VALOR_PEDAGIO",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "b399aaea-ca48-48de-90e1-21ff82fc495a",
            "sourceColumn": "VALOR_PEDAGIO",
            "summarizeBy": "sum"
          },
          {
            "name": "VALOR_ESTACIONAMENTO",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "c834eaa0-8250-48ad-9a6f-e64409bf0391",
            "sourceColumn": "VALOR_ESTACIONAMENTO",
            "summarizeBy": "sum"
          },
          {
            "name": "VALOR_ESCOLTA",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "c7ccdcaa-4de7-41c1-9465-6e51459655ca",
            "sourceColumn": "VALOR_ESCOLTA",
            "summarizeBy": "sum"
          },
          {
            "name": "VALOR_TAXA_EMISSAO",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "90f00522-d73f-4473-9897-d234300d392f",
            "sourceColumn": "VALOR_TAXA_EMISSAO",
            "summarizeBy": "sum"
          },
          {
            "name": "VALOR_RCTRC",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "007c8489-c549-4682-ab92-86b85d33abdf",
            "sourceColumn": "VALOR_RCTRC",
            "summarizeBy": "sum"
          },
          {
            "name": "FRETE_VALOR",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "4cd00fcf-3481-4ca0-84c2-95fae19ffc46",
            "sourceColumn": "FRETE_VALOR",
            "summarizeBy": "sum"
          },
          {
            "name": "OUTROS",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "ad7d8726-5e90-439a-9b7b-5b43e9e60d20",
            "sourceColumn": "OUTROS",
            "summarizeBy": "sum"
          },
          {
            "name": "VALOR_DTA_AEREA",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "3a4d89d4-5d61-4133-b48e-faec68f453f9",
            "sourceColumn": "VALOR_DTA_AEREA",
            "summarizeBy": "sum"
          },
          {
            "name": "VALOR_AJUDANTE",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "32d2fe8c-8109-4b21-8b98-6743a3de2492",
            "sourceColumn": "VALOR_AJUDANTE",
            "summarizeBy": "sum"
          },
          {
            "name": "VALOR_OUTROS",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "bfbb5425-ae53-42c4-9e08-808b330984b9",
            "sourceColumn": "VALOR_OUTROS",
            "summarizeBy": "sum"
          },
          {
            "name": "VALOR_EXCESSO_PESO",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "93c3ab2f-4790-4f99-b049-afe8605ce608",
            "sourceColumn": "VALOR_EXCESSO_PESO",
            "summarizeBy": "sum"
          },
          {
            "name": "VALOR_IMO",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "30418875-286c-42dd-a416-af77b88343e1",
            "sourceColumn": "VALOR_IMO",
            "summarizeBy": "sum"
          },
          {
            "name": "VALOR_COLETA_ME",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "78d34464-cfcd-4f83-a749-344e82e18a5a",
            "sourceColumn": "VALOR_COLETA_ME",
            "summarizeBy": "sum"
          },
          {
            "name": "VALOR_DECOLUCAO_ME",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "6a0543ef-9fe1-427a-8755-44e1a1df0498",
            "sourceColumn": "VALOR_DECOLUCAO_ME",
            "summarizeBy": "sum"
          },
          {
            "name": "TOTAL_VIAGEM",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "9c45fe8b-da89-405a-9116-c6d0fe3bb026",
            "sourceColumn": "TOTAL_VIAGEM",
            "summarizeBy": "sum"
          },
          {
            "name": "CONHECIMENTO_TIPO",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "isHidden": true,
            "lineageTag": "e5259c43-c37d-4166-9675-8e55f6b3ae32",
            "sourceColumn": "CONHECIMENTO_TIPO",
            "summarizeBy": "none"
          },
          {
            "name": "FRETE_UNITARIO",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "9ccd53ad-c009-42a8-8912-51a7b5ba6183",
            "sourceColumn": "FRETE_UNITARIO",
            "summarizeBy": "sum"
          },
          {
            "name": "source",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "isHidden": true,
            "lineageTag": "30a7931f-6e25-4902-846f-dae88e79e0f1",
            "sourceColumn": "source",
            "summarizeBy": "none"
          },
          {
            "name": "TIPO_NOTA_FISCAL",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "isHidden": true,
            "lineageTag": "7fbdb558-36df-493a-9be8-b5540e20fcd5",
            "sourceColumn": "TIPO_NOTA_FISCAL",
            "summarizeBy": "none"
          },
          {
            "name": "ROTA",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "isHidden": true,
            "lineageTag": "2156b55d-b755-4cc9-b948-6f9025a7b2f3",
            "sourceColumn": "ROTA",
            "summarizeBy": "none"
          },
          {
            "name": "Lat_origem",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "aa3302cd-5b19-4818-880c-2010a6d52ede",
            "sourceColumn": "Lat_origem",
            "summarizeBy": "sum"
          },
          {
            "name": "Lon_origem",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "da4ce3cd-756a-4295-93c5-2810d8134f57",
            "sourceColumn": "Lon_origem",
            "summarizeBy": "sum"
          },
          {
            "name": "Lat_destino",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "b7037347-f613-4270-ae27-b7be1faec380",
            "sourceColumn": "Lat_destino",
            "summarizeBy": "sum"
          },
          {
            "name": "Lon_destino",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "96d11994-e9b1-4d45-a12e-d3e195dce09c",
            "sourceColumn": "Lon_destino",
            "summarizeBy": "sum"
          },
          {
            "name": "Distancia (KM)",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "c13ba93c-8ac8-4a88-8b64-9a2e31dc05a4",
            "sourceColumn": "Distancia (KM)",
            "summarizeBy": "sum"
          },
          {
            "name": "Distancia (M)",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "isHidden": true,
            "lineageTag": "12027e7d-d119-4e94-8942-b660353c3a03",
            "sourceColumn": "Distancia (M)",
            "summarizeBy": "none"
          },
          {
            "name": "Frota?",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "expression": [
              "",
              "VAR frota_ou_terceiro = RELATED( dimPLACA_FROTA[Placa] )",
              "RETURN",
              "IF( ",
              "    NOT ISBLANK( frota_ou_terceiro ), -- Se encontrar a placa na tabela de placas frota, retorna Frota",
              "    \"Frota\",",
              "    IF( LEN( fato_nf[PROP_CNPJ_CPF]) = 11, -- Se o numero de caracteres na razao social proprietario for igual a 11 é CPF, caso contrário é CNPJ.",
              "        \"Motorista\", -- Se for CPF, Retorna Motorista",
              "        \"Transportadora\" -- Caso contrário é CNPJ, e retorna Transortadora",
              "))"
            ],
            "isDataTypeInferred": true,
            "lineageTag": "a7e4cb83-4f35-46bc-973e-50a0f3be10b2",
            "summarizeBy": "none",
            "type": "calculated"
          },
          {
            "name": "ChaveRomaneioData",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "expression": "fato_nf[NUM_ROMANEIO] & fato_nf[DATA_EMISSAO]",
            "isDataTypeInferred": true,
            "isHidden": true,
            "lineageTag": "0d93864b-8435-4f7b-aaf3-8ed56dad942b",
            "summarizeBy": "none",
            "type": "calculated"
          },
          {
            "name": "DATA_EMISSAO_BACKUP",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "dateTime",
            "formatString": "General Date",
            "isHidden": true,
            "lineageTag": "661eba6f-03ca-4b30-98d5-dc165ec3cda4",
            "sourceColumn": "DATA_EMISSAO_BACKUP",
            "summarizeBy": "none"
          },
          {
            "name": "Operacao Unificada",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "expression": [
              "",
              "LOOKUPVALUE( dimOPERACAO[Operacao Unificada], dimOPERACAO[OPERACAO], fato_nf[OPERACAO])"
            ],
            "isDataTypeInferred": true,
            "lineageTag": "6f96132e-a51d-4d36-8b03-9d95132bb119",
            "summarizeBy": "none",
            "type": "calculated"
          },
          {
            "name": "Super_chave",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "expression": "fato_nf[NUM_ROMANEIO] & fato_nf[UNIDADE_NEGOCIO] & fato_nf[COB_RAZAO_SOCIAL] & fato_nf[ROTA]",
            "isDataTypeInferred": true,
            "isHidden": true,
            "lineageTag": "fa576927-58b3-49b1-8c8e-59e377a095d3",
            "summarizeBy": "none",
            "type": "calculated"
          },
          {
            "name": "Chave_faturamento",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "expression": "fato_nf[NUM_ROMANEIO] & \"|\" & fato_nf[NUM_NOTA_FISCAL]",
            "isDataTypeInferred": true,
            "isHidden": true,
            "lineageTag": "617a94aa-e252-4692-9ce3-f5c8508283a8",
            "summarizeBy": "none",
            "type": "calculated"
          },
          {
            "name": "chave_viagem_centro",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "expression": "fato_nf[NUM_ROMANEIO] & \"|\" & fato_nf[CENTRO_CUSTO] & \"|\" & fato_nf[DATA_EMISSAO]",
            "isDataTypeInferred": true,
            "isHidden": true,
            "lineageTag": "b41780c0-3a4d-4c37-a1ad-650bc3284ec8",
            "summarizeBy": "none",
            "type": "calculated"
          },
          {
            "name": "CENTROS_CUSTO_ROMANEIO",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "isHidden": true,
            "lineageTag": "fab96c8f-df87-4b2b-88a9-3cb197b47760",
            "sourceColumn": "CENTROS_CUSTO_ROMANEIO",
            "summarizeBy": "none"
          },
          {
            "name": "DATA_EMISSAO_MINIMA_AJUSTADA",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "UnderlyingDateTimeDataType",
                "value": "Date"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "dateTime",
            "formatString": "Long Date",
            "isHidden": true,
            "lineageTag": "e423ccaa-82eb-4ab3-a3ac-69079a668e58",
            "sourceColumn": "DATA_EMISSAO_MINIMA_AJUSTADA",
            "summarizeBy": "none"
          }
        ],
        "lineageTag": "ba7ea902-6124-47f3-a1a3-1ebb38ce19ce",
        "partitions": [
          {
            "name": "fato_nf-08ea923e-4cd7-4bdd-b4c6-bf08dc239453",
            "mode": "import",
            "source": {
              "expression": [
                "let",
                "    Fonte = Value.NativeQuery(Databricks.Catalogs(\"adb-1220993250695902.2.azuredatabricks.net\", \"/sql/1.0/warehouses/6b94e3b6ef796336\", [Catalog=\"hive_metastore\", Database=null, EnableAutomaticProxyDiscovery=null]){[Name=\"hive_metastore\",Kind=\"Database\"]}[Data], \"select ",
                "UNIDADE_NEGOCIO,",
                "PRESTADOR_SERVICO_RAZAO_SOCIAL,",
                "case ",
                "  when trim(DESCRICAO_ORGANIZACIONAL) = '' and source regexp 'LOGIX|logix' then 'C.C Indefinido'",
                "  else coalesce(DESCRICAO_ORGANIZACIONAL, 'C.C Indefinido')",
                "  end as DESCRICAO_ORGANIZACIONAL,",
                "CENTRO_CUSTO,",
                "case ",
                "  when OPERACAO is null then 'Sem Centro'",
                "  else upper(OPERACAO)",
                "  end as OPERACAO,",
                "NUM_ROMANEIO,",
                "NUM_NOTA_FISCAL,",
                "SERIE,",
                "DATA_EMISSAO,",
                "NOTAS_FISCAIS,",
                "upper(COB_RAZAO_SOCIAL) as COB_RAZAO_SOCIAL,",
                "CALC_VALOR_TOTAL_PRODUTOS,",
                "GRIS,",
                "SERV_ISS_VALOR,",
                "CALC_VALOR_TOTAL_NOTA,",
                "PEDAGIO,",
                "upper(SIGLA_UF_COLETA) as SIGLA_UF_COLETA,",
                "upper(SIGLA_UF_ENTREGA) as SIGLA_UF_ENTREGA,",
                "upper(NOME_LOCAL_COLETA) as NOME_LOCAL_COLETA,",
                "upper(NOME_LOCAL_ENTREGA) as NOME_LOCAL_ENTREGA,",
                "TIPO_VEICULO,",
                "replace(upper(PLACA_TRACAO), '-', '') as PLACA_TRACAO,",
                "replace(replace(replace(PROP_CNPJ_CPF, '-', ''),'/',''),'.','') as PROP_CNPJ_CPF,",
                "PROP_RAZAO_SOCIAL,",
                "upper(NOME_MOTORISTA) as NOME_MOTORISTA,",
                "MERCADORIA,",
                "PESO,",
                "VOLUME,",
                "FRETE,",
                "FRETE_PESO,",
                "VALOR_ADVALOREM,",
                "VALOR_PEDAGIO,",
                "VALOR_ESTACIONAMENTO,",
                "VALOR_ESCOLTA,",
                "VALOR_TAXA_EMISSAO,",
                "VALOR_RCTRC,",
                "FRETE_VALOR,",
                "OUTROS,",
                "VALOR_DTA_AEREA,",
                "VALOR_AJUDANTE,",
                "VALOR_OUTROS,",
                "VALOR_EXCESSO_PESO,",
                "VALOR_IMO,",
                "VALOR_COLETA_ME,",
                "VALOR_DECOLUCAO_ME,",
                "TOTAL_VIAGEM,",
                "CONHECIMENTO_TIPO,",
                "FRETE_UNITARIO,",
                "upper(source) as source,",
                "TIPO_NOTA_FISCAL,",
                "upper(replace( trim( concat(NOME_LOCAL_COLETA,'/', SIGLA_UF_COLETA, 'X', NOME_LOCAL_ENTREGA, '/', SIGLA_UF_ENTREGA)) ,' ', '')) AS ROTA,",
                "case ",
                "  when NUM_ROMANEIO is null then replace(replace(replace(cast(DESCRICAO_ORGANIZACIONAL as string), 'Padrão /', ''), '[', ''), ']', '')",
                "  else replace(replace(replace(cast(collect_set( DESCRICAO_ORGANIZACIONAL ) OVER (PARTITION BY NUM_ROMANEIO,UNIDADE_NEGOCIO,SOURCE ) as string),'Padrão /', ''), '[', ''), ']', '')",
                "  end as CENTROS_CUSTO_ROMANEIO,",
                "MIN(DATA_EMISSAO)  OVER (PARTITION BY NUM_ROMANEIO, UNIDADE_NEGOCIO, source ) AS DATA_EMISSAO_MINIMA_AJUSTADA",
                "from ouro_transportes.fato_nf ",
                "where CANCELADA = 'Não' ",
                "and DATA_EMISSAO >= '2021-01-01'\", null, [EnableFolding=true]),",
                "    #\"Tipo Alterado\" = Table.TransformColumnTypes(Fonte,{{\"DATA_EMISSAO_MINIMA_AJUSTADA\", type date}}),",
                "    #\"Coluna Duplicada\" = Table.DuplicateColumn(#\"Tipo Alterado\", \"DATA_EMISSAO\", \"DATA_EMISSAO - Copiar\"),",
                "    #\"Colunas Renomeadas\" = Table.RenameColumns(#\"Coluna Duplicada\",{{\"DATA_EMISSAO - Copiar\", \"DATA_EMISSAO_BACKUP\"}}),",
                "    #\"DATA_EMISSAO p/ data\" = Table.TransformColumnTypes(#\"Colunas Renomeadas\",{{\"DATA_EMISSAO\", type date}}),",
                "    #\"Consultas Mescladas\" = Table.NestedJoin(#\"DATA_EMISSAO p/ data\", {\"ROTA\"}, dimROTAS_DISTANCIAS, {\"Rota\"}, \"dimROTAS_DISTANCIAS\", JoinKind.LeftOuter),",
                "    #\"dimROTAS_DISTANCIAS Expandido\" = Table.ExpandTableColumn(#\"Consultas Mescladas\", \"dimROTAS_DISTANCIAS\", {\"Lat_origem\", \"Lon_origem\", \"Lat_destino\", \"Lon_destino\", \"Distancia (KM)\", \"Distancia (M)\"}, {\"Lat_origem\", \"Lon_origem\", \"Lat_destino\", \"Lon_destino\", \"Distancia (KM)\", \"Distancia (M)\"}),",
                "    #\"TIPO_NOTA minuscula\" = Table.TransformColumns(#\"dimROTAS_DISTANCIAS Expandido\",{{\"TIPO_NOTA_FISCAL\", Text.Proper, type text}}),",
                "    #\"CENTRO CUSTO VAZIO SUBSTITUIDO\" = Table.ReplaceValue(#\"TIPO_NOTA minuscula\",\"    \",\"C.C Indefinido\",Replacer.ReplaceText,{\"CENTROS_CUSTO_ROMANEIO\"}),",
                "    #\"Tipo Alterado1\" = Table.TransformColumnTypes(#\"CENTRO CUSTO VAZIO SUBSTITUIDO\",{{\"DATA_EMISSAO_MINIMA_AJUSTADA\", type date}})",
                "in",
                "    #\"Tipo Alterado1\""
              ],
              "type": "m"
            }
          }
        ]
      },
      {
        "name": "dimROMANEIO",
        "annotations": [
          {
            "name": "PBI_Id",
            "value": "3d6f954fff5b46e5a0f96f70786a5c85"
          }
        ],
        "columns": [
          {
            "name": "NUM_ROMANEIO",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "deeef507-f236-460a-97a3-3a769e709bc8",
            "sourceColumn": "fato_carta_frete[NUM_ROMANEIO]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          }
        ],
        "lineageTag": "042c53e9-6044-4607-8f3e-ec4371797e0a",
        "partitions": [
          {
            "name": "dimROMANEIO-2fa40fd1-78bd-4cf7-93f4-7cc8af7cb447",
            "mode": "import",
            "source": {
              "expression": [
                "",
                "    DISTINCT(",
                "        UNION(",
                "            FILTER(DISTINCT(fato_carta_frete[NUM_ROMANEIO]), fato_carta_frete[NUM_ROMANEIO] <> BLANK()),",
                "            FILTER(DISTINCT(fato_cte[NUM_ROMANEIO]), fato_cte[NUM_ROMANEIO] <> BLANK()),",
                "            FILTER(DISTINCT(fato_nf[NUM_ROMANEIO]), fato_nf[NUM_ROMANEIO] <> BLANK())",
                "        )",
                ")",
                ""
              ],
              "type": "calculated"
            }
          }
        ]
      },
      {
        "name": "Medidas",
        "annotations": [
          {
            "name": "PBI_Id",
            "value": "80703f3479494b30b9de482241172f09"
          }
        ],
        "columns": [
          {
            "name": "Value",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "3adf20c3-96c7-4e3b-9974-7c7b426fb1a1",
            "sourceColumn": "[Value]",
            "summarizeBy": "sum",
            "type": "calculatedTableColumn"
          }
        ],
        "lineageTag": "ae24bc23-f045-413f-95de-da20baf80994",
        "measures": [
          {
            "name": "Qtd Viagens",
            "displayFolder": "8. Viagem",
            "expression": [
              "",
              "COUNTROWS (",
              "        DISTINCT (",
              "            UNION (",
              "                -- VALUES ( fato_carta_frete[NUM_ROMANEIO] ) , -- Verificar pq quando usa esses romaneios o valor sobe absurdamente, provavel ser os fracionados da apoio",
              "                FILTER( VALUES ( fato_cte[NUM_ROMANEIO] ) , fato_cte[NUM_ROMANEIO] <> BLANK()),",
              "                FILTER( VALUES ( fato_nf[NUM_ROMANEIO] ) , fato_nf[NUM_ROMANEIO] <> BLANK())",
              "            )",
              "        )",
              "    )",
              ""
            ],
            "formatString": "#,0",
            "lineageTag": "22c9e8cf-cd02-4f2c-8c99-58d3358bef84"
          },
          {
            "name": "Qtd clientes",
            "displayFolder": "9. Quantidade",
            "expression": [
              "",
              "COUNTROWS (",
              "        DISTINCT (",
              "            UNION (",
              "                VALUES ( fato_cte[COB_RAZAO_SOCIAL] ) ,",
              "                VALUES ( fato_nf[COB_RAZAO_SOCIAL] ) ",
              "            )",
              "        )",
              "    )"
            ],
            "formatString": "0",
            "lineageTag": "6aa63c5d-2b13-429f-a31c-91b175e9e6eb"
          },
          {
            "name": "$ Despesa Bruta",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"es-BR\"}"
              }
            ],
            "description": [
              "Despesa Simplificada, Soma da despesa carta frete.",
              "Pode ser usada com todas as tabelas dim, EXCETO cliente (COB_RAZAO_SOCIAL.",
              " não funciona quando quebrada por cliente, utilizar Despesa Rateio nesse caso.",
              "",
              ""
            ],
            "displayFolder": "2. Despesa",
            "expression": [
              "SUM( fato_carta_frete[FRETE_CARRETEIRO] )",
              ""
            ],
            "formatString": "\"R$\"#,0;-\"R$\"#,0;\"R$\"#,0",
            "lineageTag": "45a7ad3f-a423-4447-a5a9-493c801235ee"
          },
          {
            "name": "$ Ticket Medio (ROMANEIO)",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"es-BR\"}"
              }
            ],
            "displayFolder": "4. Ticket Medio",
            "expression": [
              "",
              "AVERAGEX(",
              "    UNION(",
              "        SUMMARIZE(",
              "            fato_cte,",
              "            fato_cte[NUM_ROMANEIO],",
              "            \"Avg1\", SUM(fato_cte[VALOR_FATURAMENTO]) -- Cria uma coluna com os romaneios e soma de faturamento por ROMANEIO da tabela de CTE",
              "        ),",
              "        SUMMARIZE(",
              "            fato_nf,",
              "            fato_nf[NUM_ROMANEIO],",
              "            \"Avg1\", SUM(fato_nf[CALC_VALOR_TOTAL_NOTA]) -- Cria uma coluna com os romaneios e soma de faturamento por ROMANEIO da tabela de NF",
              "        )",
              "    ), -- Une as 2 tabelas temporárias",
              "    [Avg1]) -- Calcula a média da tabela",
              "    "
            ],
            "formatString": "\"R$\"#,0;-\"R$\"#,0;\"R$\"#,0",
            "isHidden": true,
            "lineageTag": "d01fcf88-fafc-463f-a43d-8c3ad218d6d9"
          },
          {
            "name": "$ Ticket Medio (SIMPLIFICADO)",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"es-BR\"}"
              }
            ],
            "displayFolder": "4. Ticket Medio",
            "expression": [
              "",
              "-- Essa medida teoricamente retorna o mesmo valor da medida Ticket Medio (ROMANEIO)",
              "-- Alguns pontos para validar, ex: Romaneio com receita na tabela de cte e NF com mais de um cte/nf emitidos",
              "DIVIDE([$ Receita Bruta (FINAL)], [Qtd Viagens], 0)"
            ],
            "formatString": "\"R$\"#,0;-\"R$\"#,0;\"R$\"#,0",
            "lineageTag": "063014d6-b348-4a13-ae37-281073f30493"
          },
          {
            "name": "$ Valor Mercadoria",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"es-BR\"}"
              }
            ],
            "displayFolder": "3. Receita",
            "expression": [
              "",
              "",
              "-- Calcula o total da mercadoria, filtrando por CTE's que não sejam complementares",
              "VAR valor_mercadoria_cte = ",
              "",
              "SUMX(fato_cte,",
              "    /*",
              "        FILTER( fato_cte, ",
              "        (fato_cte[CONHECIMENTO_TIPO] <> \"Conhecimento de Complemento\") && ",
              "        (fato_cte[CONHECIMENTO_TIPO] <> \"Compl.Valor\")",
              "        ),*/ ",
              "            fato_cte[VALOR_TOTAL_MERCADORIA])",
              "",
              "-- Calcula o total da mercadoria, filtrando por NF's normais (não complementares)",
              "VAR valor_mercadoria_nf = ",
              "SUMX(fato_nf,",
              "    /*FILTER(fato_nf, fato_nf[TIPO_NOTA_FISCAL] = \"Normal\" || fato_nf[TIPO_NOTA_FISCAL] == BLANK()),*/",
              "     fato_nf[CALC_VALOR_TOTAL_PRODUTOS])",
              "    ",
              "RETURN",
              "-- Retorna a soma das tabelas de CTE e NF",
              "valor_mercadoria_cte + valor_mercadoria_nf"
            ],
            "formatString": "\"R$\"#,0;-\"R$\"#,0;\"R$\"#,0",
            "lineageTag": "a0ce66b7-6fdc-4992-8a2c-127e887a2b34"
          },
          {
            "name": "% Custo Carta Frete",
            "displayFolder": "1. Percentual",
            "expression": [
              "",
              "DIVIDE([$ Despesa Rateio], [$ Receita Bruta (FINAL)], 0)"
            ],
            "formatString": "0.0%;-0.0%;0.0%",
            "lineageTag": "51abdd9e-bad8-4fd5-90fa-74346a1a2db6"
          },
          {
            "name": "$ Receita YTD",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "displayFolder": "3. Receita",
            "expression": [
              "",
              "CALCULATE(",
              "    [$ Receita Bruta (FINAL)],",
              "    SAMEPERIODLASTYEAR(Calendario[Date])",
              ")"
            ],
            "lineageTag": "d776ca79-2886-4efc-85ba-086e5ca7e2e7"
          },
          {
            "name": "% Cresc. Receita Anual",
            "displayFolder": "1. Percentual",
            "expression": [
              "",
              "DIVIDE( [$ Receita Bruta (FINAL)] - [$ Receita YTD], [$ Receita YTD], 0 )"
            ],
            "formatString": "0.0%;-0.0%;0.0%",
            "lineageTag": "9ea59fb7-e195-4e5a-a587-d0cad00b69d3"
          },
          {
            "name": "Distancia Percorrida (KM)",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isDecimal\":true}"
              }
            ],
            "displayFolder": "5. Distancia",
            "expression": [
              "",
              "",
              "-- Soma de distancias no sistema KMM onde o tipo de cte/nota é normal ",
              "VAR distancia_cte_KMM = ",
              "SUMX(",
              "    SUMMARIZE(",
              "        FILTER(fato_cte, fato_cte[source] = \"KMM\" && fato_cte[CONHECIMENTO_TIPO] = \"Normal\"),",
              "        fato_cte[Super_chave],",
              "        \"Distancia_max\", MAX(fato_cte[Distancia (KM)])),[Distancia_max])",
              "",
              "",
              "-- Somar o máximo da chave para conhecimento substituo, verificar a regra, sempre é assim?",
              "VAR distancia_cte_KMM_substituto = ",
              "SUMX(",
              "    SUMMARIZE(",
              "        FILTER(fato_cte, fato_cte[source] = \"KMM\" && fato_cte[CONHECIMENTO_TIPO] = \"Conhecimento Substituto\"),",
              "        fato_cte[Super_chave],",
              "        \"Distancia_max\", MAX(fato_cte[Distancia (KM)])),[Distancia_max])",
              "",
              "VAR distancia_nf_KMM = ",
              "SUMX(",
              "    SUMMARIZE(",
              "        FILTER( fato_nf, fato_nf[source] = \"KMM\" && fato_nf[TIPO_NOTA_FISCAL] <> \"Complementar\"),",
              "        fato_nf[Super_chave],",
              "        \"Distancia_max\", MAX(fato_nf[Distancia (KM)])),[Distancia_max])",
              "",
              "-- Máximo da distancia no sistema LOGIX onde o tipo de cte/nota é normal",
              "-- Precisa ser o máximo devido aos fretes fracionados",
              "VAR distancia_cte_LOGIX = ",
              "SUMX(",
              "    SUMMARIZE(",
              "        FILTER(fato_cte, fato_cte[source] = \"LOGIX\" && fato_cte[CONHECIMENTO_TIPO] = \"Normal\"),",
              "        fato_cte[NUM_ROMANEIO],",
              "        \"Distancia_max\", MAX(fato_cte[Distancia (KM)])),[Distancia_max])",
              "",
              "",
              "VAR distancia_nf_LOGIX = ",
              "SUMX(",
              "    SUMMARIZE(",
              "        FILTER( fato_nf, fato_nf[source] = \"LOGIX\" && fato_nf[TIPO_NOTA_FISCAL] <> \"Complementar\" ),",
              "        fato_nf[NUM_ROMANEIO],",
              "        \"Distancia_max\", MAX(fato_nf[Distancia (KM)])),[Distancia_max])",
              "",
              "RETURN",
              "distancia_cte_KMM + distancia_nf_KMM + distancia_cte_LOGIX + distancia_nf_LOGIX + distancia_cte_KMM_substituto  ",
              "",
              "/* VARIAVEIS ANTIGAS PODEM SER UTEIS NO FUTURO",
              "",
              "VAR distancia_cte_KMM_devolucao = ",
              "    MAXX(",
              "        FILTER(fato_cte, fato_cte[source] = \"KMM\" && fato_cte[CONHECIMENTO_TIPO] = \"Normal\" && fato_cte[Operacao Unificada] = \"Devolução\"), -- Se for devolução de container retorna apenas o máximo",
              "        fato_cte[Distancia (KM)] )",
              "",
              "VAR distancia_cte_KMM_fracionado = ",
              "    SUMX(",
              "        FILTER(fato_cte, fato_cte[source] = \"KMM\" && fato_cte[CONHECIMENTO_TIPO] = \"Normal\" && fato_cte[Operacao Unificada] = \"Fracionado\"), -- Verificar os conhecimento substitutos",
              "        fato_cte[Distancia (KM)] )",
              "",
              "VAR distancia_media_cte = ",
              "    AVERAGEX(",
              "        fato_cte,",
              "        fato_cte[Distancia (KM)])",
              "",
              "IF( [Verificacao Notas] = \"VIAGEM_UNICA\", -- Ou seja, existe mais de um romaneio pra mesma NF ( indica que é apenas 1 viagem)",
              "    distancia_media_cte + distancia_nf,",
              "    distancia_cte + distancia_nf)",
              " */",
              "",
              "",
              "",
              "",
              ""
            ],
            "formatString": "#,0",
            "lineageTag": "7edfc808-a2e5-43ec-8057-6d59860721c0"
          },
          {
            "name": "Receita_teste",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "displayFolder": "3. Receita",
            "expression": [
              "",
              "VAR receita_cte = ",
              "    SUMX(",
              "        fato_cte,",
              "        fato_cte[VALOR_FATURAMENTO])",
              "",
              "VAR receita_nf = ",
              "    SUMX(",
              "        fato_nf,",
              "        fato_nf[CALC_VALOR_TOTAL_NOTA])",
              "    ",
              "RETURN",
              "receita_cte + receita_nf"
            ],
            "lineageTag": "a73b4663-0830-435b-a8ca-bdf48a967729"
          },
          {
            "name": "$ Receita Líquida",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"es-BR\"}"
              }
            ],
            "description": [
              "Receita Líquida,:",
              "- Soma de NF e CTE ",
              " - Considera complementares e substitutos",
              "- Desconsidera PIS e COFINS",
              ""
            ],
            "displayFolder": "3. Receita",
            "expression": [
              "",
              "/* Medida correta para cálculo da Receita Líquida */",
              "",
              "VAR receita_liquida_cte_KMM = ",
              "SUMX(",
              "    SUMMARIZE(",
              "         FILTER(fato_cte, fato_cte[source] = \"KMM\"),",
              "         fato_cte[Chave_faturamento],",
              "         \"Receita\", CALCULATE(MAX(fato_cte[TOTAL_CONHECIMENTO_SEM_IMPOSTO]))",
              "            ), [Receita])",
              "",
              "VAR receita_liquida_nf_KMM = ",
              "SUMX(",
              "    SUMMARIZE(",
              "        FILTER(fato_nf, fato_nf[source] = \"KMM\"),",
              "        fato_nf[Chave_faturamento],",
              "        \"Receita\", CALCULATE(MAX( fato_nf[CALC_VALOR_TOTAL_NOTA]))",
              "            ), [Receita])",
              "",
              "VAR imposto_nf_KMM = ",
              "SUMX(",
              "    SUMMARIZE(",
              "        FILTER(fato_nf, fato_nf[source] = \"KMM\"),",
              "        fato_nf[Chave_faturamento],",
              "        \"Imposto\", CALCULATE(MAX(fato_nf[SERV_ISS_VALOR]))",
              "    ), [Imposto])",
              "",
              "VAR receita_cte_LOGIX = ",
              "    SUMX(",
              "        FILTER(   ",
              "        SUMMARIZE( fato_cte, fato_cte[DATA_EMISSAO], fato_cte[NUM_CONHECIMENTO], fato_cte[CONHECIMENTO_TIPO], fato_cte[source], fato_cte[UNIDADE_NEGOCIO], ",
              "        \"Receita\",",
              "        CALCULATE (MAX ( fato_cte[TOTAL_CONHECIMENTO_SEM_IMPOSTO] ) ) ),",
              "        (fato_cte[CONHECIMENTO_TIPO] = \"Normal\") && fato_cte[source] = \"LOGIX\"),",
              "        [Receita])",
              "",
              "VAR receita_nf_LOGIX =",
              "    SUMX(",
              "        FILTER(",
              "            fato_nf, fato_nf[source] = \"LOGIX\"),",
              "            fato_nf[CALC_VALOR_TOTAL_NOTA])",
              "",
              "VAR imposto_nf_LOGIX = ",
              "    SUMX(",
              "        FILTER(fato_nf, fato_nf[source] = \"LOGIX\"),",
              "        fato_nf[SERV_ISS_VALOR])",
              "RETURN",
              "receita_liquida_cte_KMM + receita_liquida_nf_KMM + receita_cte_LOGIX + receita_nf_LOGIX - imposto_nf_KMM - imposto_nf_LOGIX"
            ],
            "formatString": "\"R$\"#,0;-\"R$\"#,0;\"R$\"#,0",
            "lineageTag": "e389e43c-d846-44f4-a279-a2cc4a8532b4"
          },
          {
            "name": "% Custo Carta Frete Líquido",
            "displayFolder": "1. Percentual",
            "expression": [
              "",
              "DIVIDE( [$ Despesa Rateio], [$ Receita Líquida], 0 )"
            ],
            "formatString": "0.0%;-0.0%;0.0%",
            "lineageTag": "5f07300b-8fe4-402b-96f3-dea245615238"
          },
          {
            "name": "Qtd NF's unicas na CTE",
            "displayFolder": "9. Quantidade",
            "expression": [
              "",
              "DISTINCTCOUNT( fato_cte[NOTAS_FISCAIS] )"
            ],
            "formatString": "0",
            "lineageTag": "639971cc-1ef1-498a-8e94-a17884e33a2b"
          },
          {
            "name": "Qtd NF's na CTE",
            "displayFolder": "9. Quantidade",
            "expression": "COUNT( fato_cte[NOTAS_FISCAIS] )",
            "formatString": "0",
            "lineageTag": "e342140a-9b47-47b5-ab7a-84d529e6114e"
          },
          {
            "name": "Qtd Veiculos",
            "displayFolder": "9. Quantidade",
            "expression": [
              "",
              "CALCULATE( ",
              "    DISTINCTCOUNT( dimPLACA_FROTA[Placa] ),",
              "    dimPLACA_FROTA[A Venda?] = \"Não\",",
              "    USERELATIONSHIP( dim_UNIDADES[UNIDADE_NEGOCIO], dimPLACA_FROTA[Unidade Negocio])",
              ")"
            ],
            "formatString": "0",
            "lineageTag": "a82e296c-5c2a-4bf2-9dc6-eba891db4d66"
          },
          {
            "name": "Frota parada",
            "displayFolder": "Farol",
            "expression": [
              "",
              "",
              "VAR frotas_com_faturamento =",
              "COUNTROWS(",
              "    FILTER(",
              "        ADDCOLUMNS( dimPLACA_FROTA,",
              "                \"Receita\", ",
              "                CALCULATE([$ Receita Bruta (FINAL)], USERELATIONSHIP(dim_UNIDADES[UNIDADE_NEGOCIO], dimPLACA_FROTA[Unidade Negocio]), dimPLACA_FROTA[A Venda?] = \"Não\")",
              "        ),",
              "            ISBLANK([Receita]) = FALSE()",
              "            )",
              ")",
              "",
              "VAR total_placas = [Qtd Veiculos]",
              "",
              "RETURN",
              "total_placas - frotas_com_faturamento  ",
              "/*",
              "VAR tabela_com_frotas_sem_faturamento = ",
              " /* Tabela temporária que contém todas as placas frota sem faturamento*/",
              "",
              "FILTER(",
              "    ADDCOLUMNS( dimPLACA_FROTA, ",
              "            \"Receita\", ",
              "            CALCULATE([$ Receita Bruta (FINAL)], ALLSELECTED(dimPLACA_FROTA[Unidade Negocio]))",
              "        ),",
              "        ISBLANK([Receita]) = TRUE()",
              ") ",
              "",
              "VAR tabela_com_frotas_sem_faturamento_com_filtro_unidade =",
              "/* ",
              "Mudança do contexto de filtro da tabela temporária de placas sem faturamento",
              "Se houver apenas uma unidade de negócio selecionada o contexto é alterado",
              "*/",
              "FILTER(tabela_com_frotas_sem_faturamento, dimPLACA_FROTA[Unidade Negocio] = SELECTEDVALUE(dim_UNIDADES[UNIDADE_NEGOCIO], FALSE()))",
              "IF (HASONEVALUE( dim_UNIDADES[PARA] ),",
              "    CALCULATE( COUNTROWS( tabela_com_frotas_sem_faturamento_com_filtro_unidade ) + 0),",
              "    CALCULATE( COUNTROWS( tabela_com_frotas_sem_faturamento ) + 0)",
              ")",
              "*/"
            ],
            "formatString": "0",
            "lineageTag": "8d016fc2-9ee1-49a7-8812-37ebf4cce7f9"
          },
          {
            "name": "Meta Frota",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"es-BR\"}"
              }
            ],
            "displayFolder": "6. Meta",
            "expression": "CALCULATE( SUM( fato_meta_frota[Meta] ), dimPLACA_FROTA[A Venda?] = \"Não\")",
            "formatString": "\"R$\"#,0;-\"R$\"#,0;\"R$\"#,0",
            "lineageTag": "07b33ed3-000e-409e-ab6e-1d9166f45780"
          },
          {
            "name": "% Realizado Meta Frota",
            "displayFolder": "1. Percentual",
            "expression": [
              "",
              "DIVIDE([$ Receita Bruta (FINAL)] , [Meta Frota], 0)"
            ],
            "formatString": "0%;-0%;0%",
            "lineageTag": "afd87283-4d7c-4a79-ad5c-980e221407d4"
          },
          {
            "name": "% Receita Total Unidades",
            "displayFolder": "1. Percentual",
            "expression": [
              "",
              "VAR Receita_total = ",
              "CALCULATE( [$ Receita Bruta (FINAL)], ALLSELECTED(dim_UNIDADES[PARA]))",
              "",
              "RETURN",
              "DIVIDE( [$ Receita Bruta (FINAL)], Receita_total, 0)"
            ],
            "formatString": "0.00%;-0.00%;0.00%",
            "lineageTag": "9d9ed5b5-8e10-495b-a55b-c110b9d17d93"
          },
          {
            "name": "$ Receita Bruta (FINAL)",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"es-BR\"}"
              }
            ],
            "description": [
              "Receita Bruta, soma de NF e CTE considera complementares e substitutos",
              ""
            ],
            "displayFolder": "3. Receita",
            "expression": [
              "",
              "-- Faturamento do Cte logix precisa de um tratamento diferente, o romaneio usado como rastreador \"desaparece\" no meio da viagem e a partir disso o conhecimento (cte) se torna o rastreador",
              "-- Considerar apenas o valor máximo do cte pois ele repete em múltiplas linhas na fato_cte no caso do fracionado, trazendo o valor errado se fizesse apenas uma simples soma no campo VALOR_FATURAMENTO",
              "-- Lembrar romaneios \"749135\", \"714983\", \"748598\" estão com linhas duplicadas por isso a soma do faturamento deve ser a soma do max da chave ROMANEIO&NF/CTE",
              "",
              "VAR receita_cte_LOGIX = ",
              "SUMX(",
              "    FILTER(   ",
              "        SUMMARIZE( fato_cte, ",
              "                   fato_cte[DATA_EMISSAO], ",
              "                   fato_cte[NUM_CONHECIMENTO], ",
              "                   fato_cte[CONHECIMENTO_TIPO], ",
              "                   fato_cte[source], ",
              "                   fato_cte[UNIDADE_NEGOCIO], ",
              "                    \"Receita\", CALCULATE (MAX ( fato_cte[VALOR_FATURAMENTO] ) ) ),",
              "        (fato_cte[CONHECIMENTO_TIPO] IN { \"Normal\", \"Compl.Valor\", \"Devolução\", \"Reentrega\" , \"N.Categ\" }) && fato_cte[source] = \"LOGIX\"),",
              "        [Receita])",
              "",
              "VAR receita_nf_LOGIX =",
              "SUMX(",
              "    FILTER(",
              "        fato_nf, fato_nf[source] = \"LOGIX\"),",
              "        fato_nf[CALC_VALOR_TOTAL_NOTA])",
              "",
              "VAR receita_cte_kmm = ",
              "SUMX(",
              "    SUMMARIZE(",
              "        FILTER(fato_cte, fato_cte[source] = \"KMM\"),",
              "        fato_cte[Chave_faturamento],",
              "        \"Receita\", CALCULATE(MAX(fato_cte[VALOR_FATURAMENTO]))",
              "    ), [Receita])",
              "",
              "VAR receita_nf_kmm = ",
              "SUMX(",
              "    SUMMARIZE(",
              "        FILTER(fato_nf, fato_nf[source] = \"KMM\"),",
              "        fato_nf[Chave_faturamento],",
              "        \"Receita\", MAX((fato_nf[CALC_VALOR_TOTAL_NOTA]))",
              "    ), [Receita])",
              "",
              "RETURN",
              "receita_cte_LOGIX + receita_nf_LOGIX + receita_cte_kmm + receita_nf_kmm"
            ],
            "formatString": "\"R$\"#,0;-\"R$\"#,0;\"R$\"#,0",
            "lineageTag": "759aed84-7c3b-4f43-86bf-86a923f0995e"
          },
          {
            "name": "Qtd Viagens FROTA",
            "displayFolder": "8. Viagem",
            "expression": [
              "",
              "CALCULATE( ",
              "    [Qtd Viagens],",
              "    dimFROTA[frota] = \"Frota\"",
              ")"
            ],
            "formatString": "#,0",
            "lineageTag": "a4e2830f-5164-473c-af77-05241c277bab"
          },
          {
            "name": "Qtd Viagens TERCEIROS",
            "displayFolder": "8. Viagem",
            "expression": [
              "",
              "CALCULATE(",
              "    [Qtd Viagens],",
              "    dimFROTA[frota] in {\"Motorista\", \"Transportadora\"}",
              ")",
              "",
              "--[Qtd Viagens Motoristas] + [Qtd Viagens Transportadora]",
              ""
            ],
            "formatString": "0",
            "lineageTag": "66507f77-8191-4351-a659-d8e786cac8d7"
          },
          {
            "name": "Qtd Viagens Motoristas",
            "displayFolder": "8. Viagem",
            "expression": [
              "",
              "CALCULATE(",
              "    [Qtd Viagens],",
              "    dimFROTA[frota] = \"Motorista\"",
              ")"
            ],
            "formatString": "0",
            "lineageTag": "fb3a67f4-af94-4595-a1de-3e2a24a8f053"
          },
          {
            "name": "Qtd Viagens Transportadora",
            "displayFolder": "8. Viagem",
            "expression": [
              "",
              "CALCULATE(",
              "    [Qtd Viagens],",
              "    dimFROTA[frota] = \"Transportadora\"",
              ")"
            ],
            "formatString": "0",
            "lineageTag": "143ba776-97e4-4d84-8b1d-cbcc2a72c7da"
          },
          {
            "name": "Qtd Transportadoras Unicas",
            "displayFolder": "9. Quantidade",
            "expression": [
              "",
              "COUNTROWS (",
              "        DISTINCT(",
              "    UNION(",
              "        CALCULATETABLE(",
              "            VALUES( fato_carta_frete[CNPJ_CPF_MOTORISTA]) , dimFROTA[frota] = \"Transportadora\"),",
              "        CALCULATETABLE(",
              "            VALUES( fato_nf[PROP_CNPJ_CPF] ), dimFROTA[frota] = \"Transportadora\")",
              ")))"
            ],
            "formatString": "#,0",
            "lineageTag": "49d877aa-9e29-4f8b-8b49-7dea1030ade3"
          },
          {
            "name": "Qtd Motoristas Unicos",
            "displayFolder": "9. Quantidade",
            "expression": [
              "",
              "COUNTROWS (",
              "        DISTINCT(",
              "    UNION(",
              "        CALCULATETABLE(",
              "            VALUES( fato_carta_frete[CNPJ_CPF_MOTORISTA]) , dimFROTA[frota] = \"Motorista\"),",
              "        CALCULATETABLE(",
              "            VALUES( fato_nf[PROP_CNPJ_CPF] ), dimFROTA[frota] = \"Motorista\")",
              ")))"
            ],
            "formatString": "#,0",
            "lineageTag": "0d07eca6-f867-445c-8334-4398b9e87448"
          },
          {
            "name": "Dias Uteis Ate Hoje",
            "displayFolder": "7. Tempo",
            "expression": [
              "",
              "VAR DataMin = MIN( Calendario[Date] ) -- Data minima do mês ( dentro do contexto de filtro aplicado )",
              "VAR DataMax = MAX( Calendario[Date] ) -- Data maxima do mês ( dentro do contexto de filtro aplicado )",
              "VAR DataMaxAtual = IF( MONTH(TODAY()) = MONTH(DataMax), TODAY(), DataMax)",
              "RETURN",
              "-- Retorna o total de Dias Uteis dentro do contexto de filtro aplicado, sendo que a data maxima é o dia atual",
              "CALCULATE( ",
              "    COUNT( Calendario[Dia Util?] ),",
              "    Calendario[Dia Util?] = \"Sim\",",
              "    DATESBETWEEN(Calendario[Date], DataMin, DataMaxAtual)",
              ")",
              ""
            ],
            "formatString": "0",
            "lineageTag": "cd34d2f0-b10a-4136-b7af-f3c2f756893b"
          },
          {
            "name": "DataMin",
            "displayFolder": "7. Tempo",
            "expression": "MIN( MIN( fato_nf[DATA_EMISSAO] ), MIN( fato_cte[DATA_EMISSAO] ) )",
            "formatString": "General Date",
            "lineageTag": "fcfdfb8b-4cda-4b5d-a557-d50cea568105"
          },
          {
            "name": "Meta Frota ate hoje",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"es-BR\"}"
              }
            ],
            "displayFolder": "6. Meta",
            "expression": [
              "",
              "DIVIDE( [Meta Frota] * [Dias Uteis Ate Hoje],  [Total Dias Uteis Mes atual] , 0)"
            ],
            "formatString": "\"R$\"#,0;-\"R$\"#,0;\"R$\"#,0",
            "lineageTag": "ce6b3e87-b05b-4961-af74-acfbddc1edc9"
          },
          {
            "name": "Total Dias Uteis Mes atual",
            "displayFolder": "7. Tempo",
            "expression": [
              "",
              "CALCULATE( ",
              "    COUNT( Calendario[Dia Util?] ),",
              "    Calendario[Dia Util?] = \"Sim\")"
            ],
            "formatString": "0",
            "lineageTag": "489f7f74-685d-4a3b-b167-6a90ef799498"
          },
          {
            "name": "% Realizado Meta Ate Hoje",
            "displayFolder": "1. Percentual",
            "expression": [
              "",
              "DIVIDE([$ Receita Placas Venda] , [Meta Frota ate hoje], 0)"
            ],
            "formatString": "0%;-0%;0%",
            "lineageTag": "8bcdc588-696d-4071-a29d-2074eb251458"
          },
          {
            "name": "Ano Selecionado",
            "displayFolder": "7. Tempo",
            "expression": "SELECTEDVALUE( Calendario[Ano] ) ",
            "formatString": "0",
            "lineageTag": "167ebb89-445b-48de-8db6-431827ed4c5b"
          },
          {
            "name": "Qtd Viagens YTD",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isDecimal\":true}"
              }
            ],
            "displayFolder": "8. Viagem",
            "expression": [
              "",
              "CALCULATE( [Qtd Viagens], SAMEPERIODLASTYEAR(Calendario[Date] ))",
              ""
            ],
            "formatString": "0",
            "lineageTag": "af7dd8aa-929b-4b60-9518-68462f76fccf"
          },
          {
            "name": "% Cresc. Viagens",
            "displayFolder": "1. Percentual",
            "expression": [
              "",
              "DIVIDE( [Qtd Viagens] - [Qtd Viagens YTD], [Qtd Viagens YTD], 0 )"
            ],
            "formatString": "0.0%;-0.0%;0.0%",
            "lineageTag": "e7549675-3d0a-466a-affc-1eab540633da"
          },
          {
            "name": "ViagensAumentouDiminuiu?",
            "displayFolder": "Farol",
            "expression": "IF ( [% Cresc. Viagens] < 0, \" teve uma diminuição\", \" teve um aumento\")",
            "lineageTag": "9baeb724-1d3e-4538-87bd-9f2109c717a3"
          },
          {
            "name": "Hoje",
            "displayFolder": "7. Tempo",
            "expression": "UTCNOW() - 0.125",
            "formatString": "General Date",
            "lineageTag": "033d3607-18d9-4562-9841-584e7fd38a10"
          },
          {
            "name": "Unidade Negocio Selecionada",
            "displayFolder": "Valores Selecionados",
            "expression": "SELECTEDVALUE( dim_UNIDADES[UNIDADES_UNIFICADAS] , \"em geral\")",
            "lineageTag": "3fbd5711-e0d3-4b01-b9e3-4acaeced35aa"
          },
          {
            "name": "% Utilizacao Frota",
            "displayFolder": "1. Percentual",
            "expression": "DIVIDE( [Qtd Viagens FROTA], [Qtd Viagens], 0)",
            "formatString": "0.0%;-0.0%;0.0%",
            "lineageTag": "f014a4dd-6289-47cd-b9e6-c184fd3f6cd8"
          },
          {
            "name": "Qtd Estados Entrega",
            "displayFolder": "9. Quantidade",
            "expression": [
              "",
              "COUNTROWS (",
              "        DISTINCT (",
              "            UNION (",
              "                FILTER( VALUES ( fato_cte[SIGLA_UF_ENTREGA] ) , fato_cte[SIGLA_UF_ENTREGA] <> BLANK()),",
              "                FILTER( VALUES ( fato_nf[SIGLA_UF_ENTREGA] ) , fato_nf[SIGLA_UF_ENTREGA] <>BLANK())",
              "            )",
              "        )",
              "    )"
            ],
            "formatString": "0",
            "lineageTag": "24e4fbfb-7922-49e6-b25c-df9e6605b48a"
          },
          {
            "name": "$ Receita Bruta (MOTORISTA)",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"es-BR\"}"
              }
            ],
            "description": "Receita Bruta Apenas das viagens onde o proprietário do veículo é CPF",
            "displayFolder": "3. Receita",
            "expression": [
              "",
              "CALCULATE( [$ Receita Bruta (FINAL)], dimFROTA[frota] = \"Motorista\")",
              ""
            ],
            "formatString": "\"R$\"#,0;-\"R$\"#,0;\"R$\"#,0",
            "lineageTag": "da9b1ee0-540c-4ff8-9d9e-11394ee00ec7"
          },
          {
            "name": "$ Receita Bruta (TRANSPORTADORA)",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"es-BR\"}"
              }
            ],
            "description": [
              "Receita Bruta Apenas das viagens onde o proprietário do veículo é CNPJ",
              ""
            ],
            "displayFolder": "3. Receita",
            "expression": [
              "",
              "CALCULATE( [$ Receita Bruta (FINAL)], dimFROTA[frota] = \"Transportadora\")"
            ],
            "formatString": "\"R$\"#,0;-\"R$\"#,0;\"R$\"#,0",
            "lineageTag": "e1b6ee82-d43d-4830-a585-3b474edab160"
          },
          {
            "name": "$ Ticket Medio (MOTORISTA)",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"es-BR\"}"
              }
            ],
            "displayFolder": "4. Ticket Medio",
            "expression": [
              "",
              "DIVIDE([$ Receita Bruta (MOTORISTA)], [Qtd Viagens Motoristas], 0)"
            ],
            "formatString": "\"R$\"#,0;-\"R$\"#,0;\"R$\"#,0",
            "lineageTag": "132dcd78-e99d-4bf5-90a1-ed69b2423315"
          },
          {
            "name": "$ Ticket Medio (TRANSPORTADORA)",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"es-BR\"}"
              }
            ],
            "displayFolder": "4. Ticket Medio",
            "expression": [
              "",
              "DIVIDE([$ Receita Bruta (TRANSPORTADORA)], [Qtd Viagens Transportadora], 0)"
            ],
            "formatString": "\"R$\"#,0;-\"R$\"#,0;\"R$\"#,0",
            "lineageTag": "82af2505-92fd-4a9b-b95d-e2780e729082"
          },
          {
            "name": "$ Receita Bruta (FROTA)",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"es-BR\"}"
              }
            ],
            "description": [
              "Receita Bruta Apenas das viagens onde o proprietário do veículo é Multilog (placas proprietárias)",
              ""
            ],
            "displayFolder": "3. Receita",
            "expression": [
              "",
              "CALCULATE( [$ Receita Bruta (FINAL)], dimFROTA[frota] = \"Frota\")"
            ],
            "formatString": "\"R$\"#,0;-\"R$\"#,0;\"R$\"#,0",
            "lineageTag": "59b893a5-176a-4cc9-9a16-9e8b516137fb"
          },
          {
            "name": "$ Ticket Medio (FROTA)",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"es-BR\"}"
              }
            ],
            "displayFolder": "4. Ticket Medio",
            "expression": [
              "",
              "DIVIDE([$ Receita Bruta (FROTA)], [Qtd Viagens FROTA], 0)"
            ],
            "formatString": "\"R$\"#,0;-\"R$\"#,0;\"R$\"#,0",
            "lineageTag": "13572f5f-e249-40db-8894-332faf9a62ad"
          },
          {
            "name": "Distancia Motorista",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "displayFolder": "5. Distancia",
            "expression": [
              "",
              "CALCULATE( [Distancia Percorrida (KM)], dimFROTA[frota] = \"Motorista\")"
            ],
            "lineageTag": "6689bae9-2d17-40ca-b885-2bab7c0bb28a"
          },
          {
            "name": "Distancia Transportadora",
            "displayFolder": "5. Distancia",
            "expression": [
              "",
              "CALCULATE( [Distancia Percorrida (KM)], dimFROTA[frota] = \"Transportadora\")"
            ],
            "formatString": "#,0",
            "lineageTag": "94cfb666-b960-4bee-8935-1c8b29fd985e"
          },
          {
            "name": "Distancia Frota",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "displayFolder": "5. Distancia",
            "expression": [
              "",
              "CALCULATE( [Distancia Percorrida (KM)], dimFROTA[frota] = \"Frota\")"
            ],
            "lineageTag": "f9b79d33-9795-429e-9220-edd595c56abe"
          },
          {
            "name": "Distancia Media Motorista",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isDecimal\":true}"
              }
            ],
            "displayFolder": "5. Distancia",
            "expression": [
              "",
              "DIVIDE( [Distancia Motorista], [Qtd Viagens Motoristas], 0 )"
            ],
            "formatString": "#,0",
            "lineageTag": "777d71a9-654c-44f7-92a2-608bd0f35033"
          },
          {
            "name": "Distancia Media Transportadora",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isDecimal\":true}"
              }
            ],
            "displayFolder": "5. Distancia",
            "expression": [
              "",
              "DIVIDE( [Distancia Transportadora], [Qtd Viagens Transportadora], 0 )"
            ],
            "formatString": "#,0",
            "lineageTag": "df1589ab-15a0-48c4-8cfa-eecff7381517"
          },
          {
            "name": "Distancia Media Frota",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isDecimal\":true}"
              }
            ],
            "displayFolder": "5. Distancia",
            "expression": [
              "",
              "DIVIDE( [Distancia Frota], [Qtd Viagens FROTA], 0 )"
            ],
            "formatString": "#,0",
            "lineageTag": "cf2d75a2-a382-4dbe-8347-1155d770c3cf"
          },
          {
            "name": "Qtd Volume",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isDecimal\":true}"
              }
            ],
            "displayFolder": "9. Quantidade",
            "expression": [
              "",
              "VAR volume_cte = ",
              "    SUMX( ",
              "        FILTER(fato_cte, fato_cte[CONHECIMENTO_TIPO] IN {\"Normal\", \"Conhecimento Substituto\"})",
              "        , fato_cte[VOLUME] )",
              "",
              "",
              "VAR volume_nf =",
              "    SUMX( ",
              "        FILTER(fato_nf, fato_nf[TIPO_NOTA_FISCAL] = \"Normal\" || fato_nf[TIPO_NOTA_FISCAL] == BLANK()), ",
              "        fato_nf[VOLUME])",
              "",
              "RETURN",
              "volume_cte + volume_nf"
            ],
            "formatString": "#,0",
            "lineageTag": "5410bff5-d43f-461b-b15f-a2ecaf4dfd20"
          },
          {
            "name": "Qtd Peso",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isDecimal\":true}"
              }
            ],
            "displayFolder": "9. Quantidade",
            "expression": [
              "",
              "VAR peso_cte =",
              "    SUMX( ",
              "        FILTER(fato_cte, fato_cte[CONHECIMENTO_TIPO] IN {\"Normal\", \"Conhecimento Substituto\"})",
              "        , fato_cte[PESO] )",
              "",
              "VAR peso_nf =",
              "    SUMX( ",
              "        FILTER(fato_nf, fato_nf[TIPO_NOTA_FISCAL] = \"Normal\" || fato_nf[TIPO_NOTA_FISCAL] == BLANK()),",
              "         fato_nf[PESO] )",
              "",
              "RETURN",
              "peso_cte + peso_nf"
            ],
            "formatString": "#,0",
            "lineageTag": "075f68ff-6f0a-4690-a0d6-7b093ae26886"
          },
          {
            "name": "$ Receita Placas Venda",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"es-BR\"}"
              }
            ],
            "displayFolder": "3. Receita",
            "expression": [
              "",
              "",
              "-- No contexto de filtro, retorna SIM se estiver a venda, e NÃO se não estiver a venda",
              "VAR placa_frota_esta_a_venda = ",
              "SELECTEDVALUE( dimPLACA_FROTA[A Venda?])",
              "",
              " RETURN",
              " -- Retorna 0 se não tiver receita E nao estiver a venda",
              "IF( ISBLANK( CALCULATE([$ Receita Bruta (FINAL)] ) ) && placa_frota_esta_a_venda = \"Não\" , ",
              "    0 , ",
              "    [$ Receita Bruta (FINAL)] ) -- Caso contrario, retorna a receita (se nao tiver receita E estiver a venda a placa \"desaparece\")",
              ""
            ],
            "formatString": "\"R$\"#,0;-\"R$\"#,0;\"R$\"#,0",
            "lineageTag": "ee7c9dd6-4845-4234-9dd4-c08af4509b98"
          },
          {
            "name": "Data Atualizacao",
            "displayFolder": "7. Tempo",
            "expression": [
              "",
              "-- Data do ultimo documento emitido CTE",
              "VAR data_max_cte = CALCULATE( MAX( fato_cte[DATA_EMISSAO_BACKUP]), ALLEXCEPT(fato_cte,dimSOURCE[source]))",
              "",
              "-- Data do ultimo documento emitido NF",
              "VAR data_max_nf = CALCULATE( MAX( fato_nf[DATA_EMISSAO_BACKUP]), ALLEXCEPT(fato_cte, dimSOURCE[source]))",
              "",
              "-- Data do ultimo documento emitido CARTA_FRETE",
              "VAR data_max_cfrete = CALCULATE( MAX( fato_carta_frete[DATA_EMISSAO_BACKUP]), ALLEXCEPT(fato_cte, dimSOURCE[source]))",
              "",
              "RETURN",
              "-- Retorna a data máxima de todas as tabelas",
              "MAX( data_max_cte, MAX(data_max_nf, data_max_cfrete))",
              ""
            ],
            "formatString": "General Date",
            "lineageTag": "5fca92db-1b53-4530-8eb9-9401b7f87a78"
          },
          {
            "name": "Mes Atual",
            "displayFolder": "7. Tempo",
            "expression": "MONTH( MAX( Calendario[Date] ) )",
            "formatString": "0",
            "lineageTag": "22948540-b724-483c-9123-c698cb468e10"
          },
          {
            "name": "Farol Frota",
            "displayFolder": "Farol",
            "expression": [
              "",
              "IF( [% Realizado Meta Ate Hoje] < 1, \"VERMELHO\",",
              "    IF( ( [% Realizado Meta Ate Hoje] >= 1) && ([$ Receita Placas Venda] < [Meta Frota]), \"AMARELO\",",
              "    \"VERDE\") )"
            ],
            "lineageTag": "a278f7c5-8be2-4fcf-8571-8214a1bee40e"
          },
          {
            "name": "Meta Plano",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"es-BR\"}"
              }
            ],
            "displayFolder": "6. Meta",
            "expression": "SUM( fato_meta_plano[VALOR_PLANEJADO] )",
            "formatString": "\"R$\"#,0;-\"R$\"#,0;\"R$\"#,0",
            "lineageTag": "0d201f51-02a5-4a20-b264-46656c12193f"
          },
          {
            "name": "$ Valor Pedagio",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "displayFolder": "2. Despesa",
            "expression": [
              "",
              "VAR pedagio_cte = ",
              "    SUMX( fato_cte, fato_cte[VALOR_PEDAGIO] )",
              "",
              "VAR pedagio_nf = ",
              "    SUMX( fato_nf, fato_nf[VALOR_PEDAGIO] )",
              "",
              "RETURN",
              "-- por hora utilizar apenas o valor da cte",
              "pedagio_cte "
            ],
            "lineageTag": "ae1694db-cac1-4a8c-a1af-62b7135273c1"
          },
          {
            "name": "$ Receita apenas CTE",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"es-BR\"}"
              }
            ],
            "description": [
              "Receita Bruta apenas tabela de CTE",
              ""
            ],
            "displayFolder": "3. Receita",
            "expression": "SUM(fato_cte[VALOR_FATURAMENTO])",
            "formatString": "\"R$\"#,0;-\"R$\"#,0;\"R$\"#,0",
            "lineageTag": "c71437dd-08b4-4fa2-9715-67a2fd5e2270"
          },
          {
            "name": "Distancia Percorrida Alelo",
            "displayFolder": "5. Distancia",
            "expression": "CALCULATE( SUM( fato_alelo[Km Percorrido] ), fato_alelo[Tipo Mercadoria] = \"Combustível\")",
            "formatString": "#,0",
            "lineageTag": "00dd827b-fe27-4b21-878b-ce50375f432e"
          },
          {
            "name": "$ Despesa Alelo",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"es-BR\"}"
              }
            ],
            "displayFolder": "2. Despesa",
            "expression": "SUM( fato_alelo[Valor Total Transação] )",
            "formatString": "\"R$\"#,0;-\"R$\"#,0;\"R$\"#,0",
            "lineageTag": "87f1b608-bf11-4e44-b2e5-bdd7d826dba1"
          },
          {
            "name": "$ Despesa Frota Plano",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"es-BR\"}"
              }
            ],
            "displayFolder": "2. Despesa",
            "expression": [
              "",
              "ABS( SUM( fato_despesa_frota_plano[DESPESA] ) )",
              ""
            ],
            "formatString": "\"R$\"#,0;-\"R$\"#,0;\"R$\"#,0",
            "lineageTag": "15566686-b68e-4fdf-9641-9b0cf56d51f2"
          },
          {
            "name": "Meta Plano Ate Hoje",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "displayFolder": "6. Meta",
            "expression": [
              "",
              "DIVIDE( [Meta Plano] * [Dias Uteis Ate Hoje],  [Total Dias Uteis Mes atual] , 0)"
            ],
            "lineageTag": "77b0b335-32d7-4841-b6e0-f6ba8d5d6df0"
          },
          {
            "name": "Distancia Ociosa",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "displayFolder": "5. Distancia",
            "expression": "[Distancia Percorrida (KM)] - [Distancia Percorrida Alelo]",
            "lineageTag": "22ca9ed3-0729-450e-b52a-cce1aebb448a"
          },
          {
            "name": "Top Despesas Frota",
            "displayFolder": "2. Despesa",
            "expression": [
              "",
              "RANKX( ALL( fato_despesa_frota_plano[NOME_CONTA] ) , CALCULATE( [$ Despesa Frota Plano] ) ) ",
              "",
              "/*",
              "SUMX(",
              "        TOPN(",
              "            8, ",
              "            SUMMARIZE(",
              "                    fato_despesa_frota_plano, ",
              "                    fato_despesa_frota_plano[NOME_CONTA], ",
              "                    \"Despesa\", ABS( SUM( fato_despesa_frota_plano[DESPESA] ) )",
              "            ),",
              "            [Despesa], DESC",
              "        ),",
              "        [Despesa]",
              ")",
              "*/"
            ],
            "formatString": "#,0",
            "lineageTag": "6217f2dc-4f38-4031-8cd9-35b048369689"
          },
          {
            "name": "$ Receita Mes Anterior",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"es-BR\"}"
              }
            ],
            "displayFolder": "3. Receita",
            "expression": [
              "",
              "VAR _maxDate = [DataMax]",
              "VAR _startDate = EOMONTH(_maxDate,-2) + 1",
              "",
              "VAR _endDate = ",
              "IF (DAY(_maxDate)  = 30 ,  _startDate + DAY(_maxDate) , -- Se a data máxima for o ultimo dia do mes e o mes terminar no dia 30 , pega o intervalo ",
              "    IF(DAY(_maxDate) = 31, _startDate + DAY(_maxDate)-2, -- Se a data máxima for o ultimo dia do mes e o mes terminar no dia 31 , pega o intervalo -2 dias,",
              "    _startDate + DAY(_maxDate) -1) --  caso contrário pega o intervalo -1 dia",
              ")",
              "RETURN",
              "CALCULATE(",
              "    [$ Receita Bruta (FINAL)],",
              "    DATESBETWEEN(Calendario[Date], _startDate, _endDate)",
              ")",
              ""
            ],
            "formatString": "\"R$\"#,0.00;-\"R$\"#,0.00;\"R$\"#,0.00",
            "lineageTag": "714a47bf-bb94-426e-8420-f5a68ed3bd2c"
          },
          {
            "name": "% Cresc. Receita Mensal",
            "displayFolder": "1. Percentual",
            "expression": [
              "",
              "DIVIDE( [$ Receita Bruta (FINAL)] - [$ Receita Mes Anterior], [$ Receita Mes Anterior], 0 )"
            ],
            "formatString": "0.0%;-0.0%;0.0%",
            "lineageTag": "a16dd53d-1fec-4e8e-ade0-e69c70449fd0"
          },
          {
            "name": "DataMax",
            "displayFolder": "7. Tempo",
            "expression": "MAX( MAX( fato_nf[DATA_EMISSAO] ), MAX( fato_cte[DATA_EMISSAO] ) )",
            "formatString": "General Date",
            "lineageTag": "90fb6863-1ef2-4f58-9af6-0b989ebcf943"
          },
          {
            "name": "$ Despesa Rateio",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"es-BR\"}"
              }
            ],
            "displayFolder": "2. Despesa",
            "expression": [
              "",
              "CALCULATE(",
              "    SUMX(",
              "        fato_despesa_carta_frete,",
              "        DIVIDE(fato_despesa_carta_frete[FRETE_VALOR_C], fato_despesa_carta_frete[CONTAGEM_C], 0) -- Despesa total dividida pelo numero de clientes distintos",
              "    )",
              "    --, USERELATIONSHIP(Calendario[Date], fato_despesa_carta_frete[DATA_EMISSAO_M])",
              ")"
            ],
            "formatString": "\"R$\"#,0;-\"R$\"#,0;\"R$\"#,0",
            "lineageTag": "36ff0e90-929b-4ce8-bcba-17573caf2e78"
          },
          {
            "name": "$ Valor IMO",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"es-BR\"}"
              }
            ],
            "displayFolder": "3. Receita",
            "expression": [
              "",
              "VAR Valor_imo_cte = ",
              " SUMX(",
              "     fato_cte,",
              "     fato_cte[VALOR_IMO]",
              " )",
              "",
              " VAR Valor_imo_nf = ",
              " SUMX(",
              "     fato_nf,",
              "     fato_nf[VALOR_IMO]",
              " )",
              "",
              " RETURN",
              " Valor_imo_cte + Valor_imo_nf",
              "     "
            ],
            "formatString": "\"R$\"#,0;-\"R$\"#,0;\"R$\"#,0",
            "lineageTag": "a1a9a592-ba28-4d61-b7b2-8d393dcd5dbd"
          },
          {
            "name": "Analise Selecionada",
            "displayFolder": "Valores Selecionados",
            "expression": [
              "",
              "VAR Medida_Selecionada = SELECTEDVALUE(Analises[Analises Campos])",
              "RETURN",
              "IF(",
              "     Medida_Selecionada = \"'Medidas'[Qtd Viagens]\",",
              "     LEFT(REPLACE(Medida_Selecionada,1, 10, \"\"),11),",
              "    LEFT(REPLACE(Medida_Selecionada,1, 11, \"\"),9))"
            ],
            "lineageTag": "7c10d510-0462-40f8-b827-b1cc52db6928"
          },
          {
            "name": "% Realizado Meta Plano",
            "displayFolder": "1. Percentual",
            "expression": [
              "",
              "DIVIDE([$ Receita Bruta (FINAL)] , [Meta Plano], 0)"
            ],
            "formatString": "0.0%;-0.0%;0.0%",
            "lineageTag": "3ec3643e-4433-440f-906a-f69a82077c4c"
          },
          {
            "name": "Receita até hoje",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"es-BR\"}"
              }
            ],
            "displayFolder": "3. Receita",
            "expression": "DIVIDE([$ Receita Bruta (FINAL)] , [Dias Uteis Ate Hoje] , 0)",
            "formatString": "\"R$\"#,0.00;-\"R$\"#,0.00;\"R$\"#,0.00",
            "lineageTag": "a5f9ec06-8726-48ee-abb9-758bb9edf46a"
          },
          {
            "name": "Qtd Litros Abastecidos",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "displayFolder": "9. Quantidade",
            "expression": [
              "",
              "CALCULATE(",
              "    SUM( fato_alelo[Litros Abastecidos] ),",
              "    fato_alelo[Tipo Mercadoria] = \"Combustível\"",
              ")"
            ],
            "lineageTag": "05c0b045-a8fa-477e-b937-8a679673295f"
          },
          {
            "name": "$ Despesa Combustivel Alelo",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"es-BR\"}"
              }
            ],
            "displayFolder": "2. Despesa",
            "expression": [
              "",
              " CALCULATE( [$ Despesa Alelo], fato_alelo[Tipo Mercadoria] = \"Combustível\")"
            ],
            "formatString": "\"R$\"#,0.00;-\"R$\"#,0.00;\"R$\"#,0.00",
            "lineageTag": "ec9ab4a7-a893-4ec4-8bf1-037aa7907831"
          },
          {
            "name": "Custo Km",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"es-BR\"}"
              }
            ],
            "displayFolder": "2. Despesa",
            "expression": "DIVIDE( [$ Despesa Combustivel Alelo], [Distancia Percorrida Alelo], 0 )",
            "formatString": "\"R$\"#,0.00;-\"R$\"#,0.00;\"R$\"#,0.00",
            "lineageTag": "38523ebe-c7ab-4d92-a41b-76aa4a8fd5d0"
          },
          {
            "name": "PassouMeta?",
            "displayFolder": "Farol",
            "expression": [
              "",
              "IF ([$ Receita Bruta (FINAL)] >= [Meta Plano], \"#499195\", \"#CD6161\")"
            ],
            "lineageTag": "d9e3dbf3-65cb-442a-b4ae-ac5966c24855"
          },
          {
            "name": "Custo Litros Alelo",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "displayFolder": "2. Despesa",
            "expression": "DIVIDE([$ Despesa Combustivel Alelo], [Qtd Litros Abastecidos], 0)",
            "lineageTag": "c3e3dc65-e510-4336-b938-0865fbdbf47b"
          },
          {
            "name": "Km por Litros",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "displayFolder": "9. Quantidade",
            "expression": "DIVIDE([Distancia Percorrida Alelo], [Qtd Litros Abastecidos], 0)",
            "lineageTag": "3f10d66e-84d6-46c3-ba2b-9ba4d07ee22a"
          },
          {
            "name": "Dias Sem Receita Frota",
            "displayFolder": "7. Tempo",
            "expression": [
              "",
              "VAR DataMaxCTE = CALCULATE(MAX(fato_cte[DATA_EMISSAO]), ALL(Calendario[Date]))",
              "VAR DataMaxNF = CALCULATE(MAX(fato_nf[DATA_EMISSAO]), ALL(Calendario[Date]))",
              "",
              "RETURN",
              "DATEDIFF(MAX(DataMaxCTE, DataMaxNF), TODAY(), DAY)",
              ""
            ],
            "formatString": "0",
            "lineageTag": "a3aa9e50-49fa-40a4-9966-ab51a8737edc"
          },
          {
            "name": "Dia Ultimo Faturamento Frota",
            "displayFolder": "7. Tempo",
            "expression": [
              "",
              "VAR UltimoDiaFaturamento = MAX(fato_frota_dias_sem_fat[Date])",
              "VAR Hoje = TODAY()",
              "RETURN",
              "DATEDIFF(UltimoDiaFaturamento, Hoje, DAY) "
            ],
            "formatString": "0",
            "lineageTag": "d1630ed8-fd3b-4a5b-ac33-b89ab61567ba"
          },
          {
            "name": "Frota >3 Dias Sem Faturar",
            "displayFolder": "Farol",
            "expression": [
              "",
              "VAR placas_mais3_dias_sem_faturar =",
              "FILTER(",
              "    SUMMARIZE(",
              "        FILTER(dimPLACA_FROTA, dimPLACA_FROTA[A Venda?] = \"Não\" && dimPLACA_FROTA[Obs] <> \"Patio\"),",
              "        dimPLACA_FROTA[Placa],",
              "        \"DiasSemFaturamento\", ",
              "        DATEDIFF(MAX(CALCULATE(MAX(fato_cte[DATA_EMISSAO]), ALL(Calendario[Date]), USERELATIONSHIP(dim_UNIDADES[UNIDADE_NEGOCIO], dimPLACA_FROTA[Unidade Negocio])),CALCULATE(MAX(fato_nf[DATA_EMISSAO]), ALL(Calendario[Date]),USERELATIONSHIP(dim_UNIDADES[UNIDADE_NEGOCIO], dimPLACA_FROTA[Unidade Negocio]))), --Data Maxima entre tabela CTE e NF",
              "                TODAY(),",
              "                DAY)",
              "), [DiasSemFaturamento] >=3)",
              "RETURN ",
              "COUNTROWS(placas_mais3_dias_sem_faturar)"
            ],
            "formatString": "0",
            "lineageTag": "20c1d7ef-f338-4b93-a7b8-f4a7129b1a43"
          },
          {
            "name": "Qtd Romaneios",
            "displayFolder": "9. Quantidade",
            "expression": [
              "",
              "COUNT(fato_cte[NUM_ROMANEIO]) + COUNT(fato_nf[NUM_ROMANEIO])"
            ],
            "formatString": "0",
            "lineageTag": "1cdbb9c5-5334-43aa-bc7d-b0adef4b83de"
          },
          {
            "name": "$ Receita Bruta (FROTA SEM FILTRO)",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"es-BR\"}"
              }
            ],
            "description": [
              "Igual a receita Bruta total, mas quando colocada em grafico traz 0 em vez de vazio, quando não tiver receita",
              ""
            ],
            "displayFolder": "3. Receita",
            "expression": [
              "",
              "-- Receita Frota retirando as linhas \"vazias\" dentro do contexto,",
              "-- Por exemplo se estiver no contexto de placas frota, irá trazer todas as placas, independente se teve receita ou não",
              "[$ Receita Bruta (FROTA)] + 0"
            ],
            "formatString": "\"R$\"#,0;-\"R$\"#,0;\"R$\"#,0",
            "lineageTag": "0e7d4d21-8db8-44f5-ab34-5f231d9c257f"
          },
          {
            "name": "Qtd Documentos",
            "displayFolder": "9. Quantidade",
            "expression": [
              "",
              "COUNTROWS (",
              "        DISTINCT (",
              "            UNION (    ",
              "                FILTER( VALUES ( fato_cte[NUM_CONHECIMENTO] ) , fato_cte[NUM_CONHECIMENTO] <> BLANK()),",
              "                FILTER( VALUES ( fato_nf[NUM_NOTA_FISCAL] ) , fato_nf[NUM_NOTA_FISCAL] <> BLANK())",
              "            )",
              "        )",
              "    )"
            ],
            "formatString": "0",
            "lineageTag": "0f38a199-5346-47e8-8665-2fd913fe5d7a"
          },
          {
            "name": "$ Valor Escolta",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"es-BR\"}"
              }
            ],
            "displayFolder": "2. Despesa",
            "expression": [
              "",
              "",
              "-- Calcula o total da escolta, filtrando por CTE's que não sejam complementares",
              "VAR valor_escolta_cte = ",
              "    SUMX(",
              "        FILTER( fato_cte, ",
              "        (fato_cte[CONHECIMENTO_TIPO] <> \"Conhecimento de Complemento\") && ",
              "        (fato_cte[CONHECIMENTO_TIPO] <> \"Compl.Valor\")",
              "        ),",
              "            fato_cte[VALOR_ESCOLTA])",
              "",
              "-- Calcula o total da escolta, filtrando por NF's normais (não complementares)",
              "VAR valor_escolta_nf = ",
              "    SUMX(",
              "        FILTER(fato_nf, fato_nf[TIPO_NOTA_FISCAL] = \"Normal\" || fato_nf[TIPO_NOTA_FISCAL] == BLANK()),",
              "        fato_nf[VALOR_ESCOLTA]) ",
              "    ",
              "RETURN",
              "-- Retorna a soma das tabelas de CTE e NF",
              "valor_escolta_cte + valor_escolta_nf"
            ],
            "formatString": "\"R$\"#,0;-\"R$\"#,0;\"R$\"#,0",
            "lineageTag": "1a0ceccc-c1cd-42f2-8345-bbf2df54ab27"
          },
          {
            "name": "$ Receita Bruta (Frota Unidade Placa Registrada)",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"es-BR\"}"
              }
            ],
            "description": [
              "Receita Bruta para PTO",
              ""
            ],
            "displayFolder": "3. Receita",
            "expression": [
              "",
              "-- Retorna a receita da frota com base onde a placa foi registrada (tabela dim_PLACA_FROTA)",
              "CALCULATE(",
              "    [$ Receita Bruta (FROTA)], ",
              "    USERELATIONSHIP(dimPLACA_FROTA[Unidade Negocio], dim_UNIDADES[UNIDADE_NEGOCIO])",
              ")"
            ],
            "formatString": "\"R$\"#,0;-\"R$\"#,0;\"R$\"#,0",
            "lineageTag": "a584a7af-bb30-4e9b-8132-7fd476f7bda9"
          },
          {
            "name": "$ Valor Advalorem",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"es-BR\"}"
              }
            ],
            "displayFolder": "2. Despesa",
            "expression": [
              "",
              "VAR Valor_advalorem_cte = ",
              " SUMX(",
              "     fato_cte,",
              "     fato_cte[VALOR_ADVALOREM]",
              " )",
              "",
              " VAR Valor_advalorem_nf = ",
              " SUMX(",
              "     fato_nf,",
              "     fato_nf[VALOR_ADVALOREM]",
              " )",
              "",
              " RETURN",
              " Valor_advalorem_cte + Valor_advalorem_nf"
            ],
            "formatString": "\"R$\"#,0.00;-\"R$\"#,0.00;\"R$\"#,0.00",
            "lineageTag": "c94d2851-496e-420c-9e2c-ec9d2acfe7ee"
          },
          {
            "name": "$ Valor Gris",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"es-BR\"}"
              }
            ],
            "displayFolder": "2. Despesa",
            "expression": [
              "",
              "VAR Valor_Gris_cte = ",
              " SUMX(",
              "     fato_cte,",
              "     fato_cte[GRIS]",
              " )",
              "",
              " VAR Valor_Gris_nf = ",
              " SUMX(",
              "     fato_nf,",
              "     fato_nf[GRIS]",
              " )",
              "",
              " RETURN",
              " Valor_Gris_cte + Valor_Gris_nf"
            ],
            "formatString": "\"R$\"#,0.00;-\"R$\"#,0.00;\"R$\"#,0.00",
            "lineageTag": "396ebfa6-2ad5-43cc-a0b7-82d9d84daf40"
          },
          {
            "name": "Qtd Viagens Centro",
            "displayFolder": "8. Viagem",
            "expression": [
              "",
              "COUNTROWS (",
              "        DISTINCT (",
              "            UNION (",
              "                -- VALUES ( fato_carta_frete[NUM_ROMANEIO] ) , -- Verificar pq quando usa esses romaneios o valor sobe absurdamente, provavel ser os fracionados da apoio",
              "                FILTER( VALUES ( fato_cte[chave_viagem_centro] ) , fato_cte[chave_viagem_centro] <> BLANK()),",
              "                FILTER( VALUES ( fato_nf[chave_viagem_centro] ) , fato_nf[chave_viagem_centro] <> BLANK())",
              "            )",
              "        )",
              "    )",
              ""
            ],
            "formatString": "0",
            "lineageTag": "b9aa3e3e-b52c-4184-94ba-f9cb815d05e6"
          },
          {
            "name": "Qtd Viagens Ajuste",
            "displayFolder": "8. Viagem",
            "expression": [
              "",
              " var qtd_viagens_cte =",
              "CALCULATE(",
              "    COUNTROWS (",
              "            DISTINCT (",
              "                FILTER( VALUES ( fato_cte[NUM_ROMANEIO] ) , fato_cte[NUM_ROMANEIO] <> BLANK())",
              "        )",
              "    ),USERELATIONSHIP(Calendario[Date],fato_cte[DATA_EMISSAO_MINIMA_AJUSTADA])",
              ")",
              "var qtd_viagens_nf = ",
              "CALCULATE(",
              "        COUNTROWS (",
              "                DISTINCT (",
              "        FILTER( VALUES ( fato_nf[NUM_ROMANEIO] ) , fato_nf[NUM_ROMANEIO] <> BLANK())",
              "                    )),",
              "                    USERELATIONSHIP(Calendario[Date],fato_nf[DATA_EMISSAO_MINIMA_AJUSTADA])",
              ")",
              "RETURN",
              "qtd_viagens_cte+qtd_viagens_nf"
            ],
            "formatString": "0",
            "lineageTag": "f62cacbf-307c-44fa-a057-eef0f01105f3"
          },
          {
            "name": "Top Clientes Receita",
            "description": [
              "Ranking de receita por cliente, 1 para o cliente com o maior receita",
              ""
            ],
            "displayFolder": "3. Receita",
            "expression": "RANKX( ALL( dimCLIENTES[COB_RAZAO_SOCIAL] ) , CALCULATE( [$ Receita Bruta (FINAL)] ) )",
            "formatString": "0",
            "lineageTag": "13209872-61fa-427a-b80e-6a35127cf5ce"
          }
        ],
        "partitions": [
          {
            "name": "Medidas-0db90e5b-9973-40c4-a86a-42332ecb6fb2",
            "mode": "import",
            "source": {
              "expression": "{BLANK()}",
              "type": "calculated"
            }
          }
        ]
      },
      {
        "name": "Calendario",
        "annotations": [
          {
            "name": "PBI_Id",
            "value": "f50c40a4bf6b46f1acb2aa538e2ed18a"
          }
        ],
        "columns": [
          {
            "name": "Date",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "UnderlyingDateTimeDataType",
                "value": "Date"
              }
            ],
            "dataType": "dateTime",
            "description": "Data emissão Romaneio",
            "formatString": "Short Date",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "eff97de0-2c83-4e43-82f3-7da04e300e9e",
            "sourceColumn": "[Date]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "Mês",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "expression": "MONTH( Calendario[Date] )",
            "formatString": "0",
            "isDataTypeInferred": true,
            "lineageTag": "698cbfda-46ba-48cb-9f4b-990d451c30bc",
            "summarizeBy": "sum",
            "type": "calculated"
          },
          {
            "name": "Nome Mes",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "expression": "FORMAT( Calendario[Date] , \"mmm\" )",
            "isDataTypeInferred": true,
            "lineageTag": "204e7d6b-7c20-467e-b394-b3a8374c93cb",
            "sortByColumn": "Mês",
            "summarizeBy": "none",
            "type": "calculated"
          },
          {
            "name": "Ano",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "expression": "YEAR( Calendario[Date] )",
            "formatString": "0",
            "isDataTypeInferred": true,
            "lineageTag": "2af63ebc-59aa-4800-93fa-5b08d0ef6392",
            "summarizeBy": "sum",
            "type": "calculated"
          },
          {
            "name": "Ano/Mes",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "expression": "Calendario[Ano] & \"-\" & Calendario[Nome Mes]",
            "isDataTypeInferred": true,
            "lineageTag": "4dbfc88a-3484-4e96-a13a-c87b3362f96f",
            "sortByColumn": "Ano Mes Classificador",
            "summarizeBy": "none",
            "type": "calculated"
          },
          {
            "name": "Dia Semana",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "expression": "FORMAT(Calendario[Date], \"dddd\")",
            "isDataTypeInferred": true,
            "lineageTag": "2cac2f59-cf03-41fb-8664-8cbacb08a777",
            "summarizeBy": "none",
            "type": "calculated"
          },
          {
            "name": "Dia Util?",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "expression": "IF ( Calendario[Dia Semana] = \"domingo\", \"Não\", \"Sim\")",
            "isDataTypeInferred": true,
            "lineageTag": "d41fc394-34c4-4199-b55f-3bd08314341e",
            "summarizeBy": "none",
            "type": "calculated"
          },
          {
            "name": "Semana",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "expression": "WEEKNUM(Calendario[Date])",
            "formatString": "0",
            "isDataTypeInferred": true,
            "lineageTag": "afd0e22c-5f37-47f7-b153-03d2d349e619",
            "summarizeBy": "sum",
            "type": "calculated"
          },
          {
            "name": "Ano Mes Classificador",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "expression": "(Calendario[Ano] * 1000) + Calendario[Mês]",
            "formatString": "0",
            "isDataTypeInferred": true,
            "lineageTag": "2b0af468-62e4-4426-86f3-303a7eb3b4ee",
            "summarizeBy": "sum",
            "type": "calculated"
          },
          {
            "name": "Data Texto Sem Bug",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "expression": "DAY(Calendario[Date]) & \"/\" & MONTH(Calendario[Date]) & \"/\" & YEAR(Calendario[Date])",
            "isDataTypeInferred": true,
            "lineageTag": "3a8dd9c5-3332-4a13-9447-03feb9e82cb9",
            "summarizeBy": "none",
            "type": "calculated"
          }
        ],
        "lineageTag": "41e7e4a4-bdea-4131-8700-b4c9ad176954",
        "partitions": [
          {
            "name": "Calendario-a0e4434e-d361-449b-92e3-d591afd54556",
            "mode": "import",
            "source": {
              "expression": [
                "",
                "VAR DataInicial = DATE(2019,1,1)",
                "VAR DataFinal = DATE(2025,1,1)",
                "RETURN",
                "CALENDAR(DataInicial, DataFinal)"
              ],
              "type": "calculated"
            }
          }
        ]
      },
      {
        "name": "dimCLIENTES",
        "annotations": [
          {
            "name": "PBI_Id",
            "value": "96dd8834a3624fadbf25db76c4c2af98"
          }
        ],
        "columns": [
          {
            "name": "COB_RAZAO_SOCIAL",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "992dff19-4263-40e9-a5e2-51a92cc06594",
            "sourceColumn": "fato_cte[COB_RAZAO_SOCIAL]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          }
        ],
        "lineageTag": "ba2078df-439a-48c8-9ae3-ad5cf90f01ff",
        "partitions": [
          {
            "name": "dimCLIENTES-4ea7458d-59e7-4524-b55f-d6663862bfa1",
            "mode": "import",
            "source": {
              "expression": [
                "",
                "DISTINCT(",
                "    UNION(",
                "        FILTER( VALUES( fato_cte[COB_RAZAO_SOCIAL] ), fato_cte[COB_RAZAO_SOCIAL] <> BLANK() ),",
                "        FILTER( VALUES( fato_nf[COB_RAZAO_SOCIAL] ), fato_nf[COB_RAZAO_SOCIAL] <> BLANK() ),",
                "        FILTER( VALUES( fato_carta_frete[CLIENTE_COBRANCA] ), fato_carta_frete[CLIENTE_COBRANCA] <> BLANK() )",
                "    )",
                ")"
              ],
              "type": "calculated"
            }
          }
        ]
      },
      {
        "name": "dimSOURCE",
        "annotations": [
          {
            "name": "PBI_ResultType",
            "value": "Table"
          }
        ],
        "columns": [
          {
            "name": "source",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "6286a8fb-b8fc-4792-84f7-a41672276f6b",
            "sourceColumn": "source",
            "summarizeBy": "none"
          }
        ],
        "lineageTag": "d9965f6d-318f-4079-b2bc-ed241e5d722b",
        "partitions": [
          {
            "name": "dimSOURCE-51b2bde6-7ebc-475b-8551-b5bb3fd4ab00",
            "mode": "import",
            "source": {
              "expression": [
                "let",
                "    Fonte = Table.FromRows(Json.Document(Binary.Decompress(Binary.FromText(\"i45W8vb1VYrViVby8Xf3jFCKjQUA\", BinaryEncoding.Base64), Compression.Deflate)), let _t = ((type nullable text) meta [Serialized.Text = true]) in type table [source = _t]),",
                "    #\"Tipo Alterado\" = Table.TransformColumnTypes(Fonte,{{\"source\", type text}})",
                "in",
                "    #\"Tipo Alterado\""
              ],
              "type": "m"
            }
          }
        ]
      },
      {
        "name": "dimPLACA",
        "annotations": [
          {
            "name": "PBI_Id",
            "value": "e55a524a20f84ae7a49b2d730a3f2259"
          }
        ],
        "columns": [
          {
            "name": "CAVALO",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "0b3cc887-d1cd-4bc0-9bbd-14ca2764cc69",
            "sourceColumn": "fato_carta_frete[CAVALO]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          }
        ],
        "lineageTag": "cbec9647-9245-4ed5-896e-b689239da877",
        "partitions": [
          {
            "name": "dimPLACA-a2bf15a3-adff-4d72-9d52-5b608887b9c1",
            "mode": "import",
            "source": {
              "expression": [
                "",
                "DISTINCT(",
                "    UNION(",
                "        FILTER( VALUES( fato_carta_frete[CAVALO] ), fato_carta_frete[CAVALO] <> BLANK() ),",
                "        FILTER( VALUES( fato_cte[PLACA_TRACAO] ), fato_cte[PLACA_TRACAO] <> BLANK() ),",
                "        FILTER( VALUES( fato_nf[PLACA_TRACAO] ), fato_nf[PLACA_TRACAO] <> BLANK() )",
                "    )",
                ")"
              ],
              "type": "calculated"
            }
          }
        ]
      },
      {
        "name": "dimFROTA",
        "annotations": [
          {
            "name": "PBI_ResultType",
            "value": "Table"
          }
        ],
        "columns": [
          {
            "name": "frota",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "d5db401c-138d-4992-9116-d809d6283b93",
            "sourceColumn": "frota",
            "summarizeBy": "none"
          }
        ],
        "lineageTag": "fc3f0931-4470-4ca6-905f-0f9fc37349ce",
        "partitions": [
          {
            "name": "dimFROTA-0a169984-5659-49cc-909d-cab0bbd1e8be",
            "mode": "import",
            "source": {
              "expression": [
                "let",
                "    Fonte = Table.FromRows(Json.Document(Binary.Decompress(Binary.FromText(\"i45WcivKL0lUitWJVvLNL8kvyiyG8kKKEvOKC/KLShJT8ouAQrEA\", BinaryEncoding.Base64), Compression.Deflate)), let _t = ((type nullable text) meta [Serialized.Text = true]) in type table [frota = _t]),",
                "    #\"Tipo Alterado\" = Table.TransformColumnTypes(Fonte,{{\"frota\", type text}})",
                "in",
                "    #\"Tipo Alterado\""
              ],
              "type": "m"
            }
          }
        ]
      },
      {
        "name": "dimROTAS_DISTANCIAS",
        "annotations": [
          {
            "name": "PBI_ResultType",
            "value": "Table"
          }
        ],
        "columns": [
          {
            "name": "Local_coleta",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "fd4df24f-8c80-40d1-9af8-cb7cdc07f356",
            "sourceColumn": "Local_coleta",
            "summarizeBy": "none"
          },
          {
            "name": "Local_entrega",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "b181ff9f-4c43-45d8-b29a-d563fb813a19",
            "sourceColumn": "Local_entrega",
            "summarizeBy": "none"
          },
          {
            "name": "Rota",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "b37ceb34-34f8-46b0-9c70-7646d6047ce6",
            "sourceColumn": "Rota",
            "summarizeBy": "none"
          },
          {
            "name": "Lat_origem",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "71295e29-f090-47af-87bb-31c2f153cfdc",
            "sourceColumn": "Lat_origem",
            "summarizeBy": "sum"
          },
          {
            "name": "Lon_origem",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "81c1288f-cf95-451c-84cd-b9a66d2b5457",
            "sourceColumn": "Lon_origem",
            "summarizeBy": "sum"
          },
          {
            "name": "Lat_destino",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "a43f8efa-c62a-474d-bc67-291e3da4c29e",
            "sourceColumn": "Lat_destino",
            "summarizeBy": "sum"
          },
          {
            "name": "Lon_destino",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "abdc7eed-3c03-4471-bb79-095d8f7ecd90",
            "sourceColumn": "Lon_destino",
            "summarizeBy": "sum"
          },
          {
            "name": "Distancia (KM)",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "25c47aeb-dd24-4fbd-a4de-388d7d25d6b7",
            "sourceColumn": "Distancia (KM)",
            "summarizeBy": "sum"
          },
          {
            "name": "Distancia (M)",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "633d3bed-8924-4d28-bfb7-626e33f44850",
            "sourceColumn": "Distancia (M)",
            "summarizeBy": "none"
          },
          {
            "name": "Rota Final",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "7c85e1e1-101e-4ade-adec-ece64fc0ba0b",
            "sourceColumn": "Rota Final",
            "summarizeBy": "none"
          },
          {
            "name": "Distancia com Balsa",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "dad5c9a5-754c-4e75-bf02-45182240a529",
            "sourceColumn": "Distancia com Balsa",
            "summarizeBy": "none"
          }
        ],
        "lineageTag": "2bf1c1a3-1b46-4c7e-a17f-0ee0202474e3",
        "partitions": [
          {
            "name": "dimROTAS_DISTANCIAS-6d97e16f-d846-4ced-9659-8e843676f1b7",
            "mode": "import",
            "source": {
              "expression": [
                "let",
                "    Fonte = Excel.Workbook(Web.Contents(\"https://multilogcombr-my.sharepoint.com/personal/pedro_maturana_multilog_com_br/Documents/Transportes_rotas_unicas_com_distancias.xlsx\"), null, true),",
                "    Tabela1_Table = Fonte{[Item=\"Tabela1\",Kind=\"Table\"]}[Data],",
                "    #\"Tipo Alterado\" = Table.TransformColumnTypes(Tabela1_Table,{{\"Index\", Int64.Type}, {\"Local_coleta\", type text}, {\"Local_entrega\", type text}, {\"Rota\", type text}, {\"Lat_origem\", type number}, {\"Lon_origem\", type number}, {\"Lat_destino\", type number}, {\"Lon_destino\", type number}, {\"Distancia\", type text}}),",
                "    #\"Colunas Removidas\" = Table.RemoveColumns(#\"Tipo Alterado\",{\"Index\"}),",
                "    #\"Texto em Maiúscula\" = Table.TransformColumns(#\"Colunas Removidas\",{{\"Local_coleta\", Text.Upper, type text}, {\"Local_entrega\", Text.Upper, type text}, {\"Rota\", Text.Upper, type text}}),",
                "    #\"Valor Substituído\" = Table.ReplaceValue(#\"Texto em Maiúscula\",\"km\",\"\",Replacer.ReplaceText,{\"Distancia\"}),",
                "    #\"Tipo Alterado com Localidade\" = Table.TransformColumnTypes(#\"Valor Substituído\", {{\"Distancia\", type number}}, \"en-US\"),",
                "    #\"Colunas Renomeadas\" = Table.RenameColumns(#\"Tipo Alterado com Localidade\",{{\"Distancia\", \"Distancia (KM)\"}}),",
                "    #\"Erros Substituídos\" = Table.ReplaceErrorValues(#\"Colunas Renomeadas\", {{\"Distancia (KM)\", 0}}),",
                "    #\"Personalização Adicionada\" = Table.AddColumn(#\"Erros Substituídos\", \"Distancia (M)\", each [#\"Distancia (KM)\"] * 1000),",
                "    #\"Duplicatas Removidas\" = Table.Distinct(#\"Personalização Adicionada\", {\"Rota\"}),",
                "    #\"Texto em Maiúscula1\" = Table.TransformColumns(#\"Duplicatas Removidas\",{{\"Rota Final\", Text.Upper, type text}})",
                "in",
                "    #\"Texto em Maiúscula1\""
              ],
              "type": "m"
            }
          }
        ]
      },
      {
        "name": "dim_UNIDADES",
        "annotations": [
          {
            "name": "PBI_ResultType",
            "value": "Table"
          }
        ],
        "columns": [
          {
            "name": "UNIDADE_NEGOCIO",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "28f4d3d0-1e76-4044-a811-cf4f96912fdf",
            "sourceColumn": "UNIDADE_NEGOCIO",
            "summarizeBy": "none"
          },
          {
            "name": "PARA",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "05327c88-b2dc-4a19-9891-d1fb158f60d2",
            "sourceColumn": "PARA",
            "summarizeBy": "none"
          },
          {
            "name": "UNIDADES_UNIFICADAS",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "1f73859c-026c-49af-90f1-2b55b3021745",
            "sourceColumn": "UNIDADES_UNIFICADAS",
            "summarizeBy": "none"
          },
          {
            "name": "UNIDADE_PTO_TEMP",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "5de48ea4-98d2-4266-8745-d0e545f00a36",
            "sourceColumn": "UNIDADE_PTO_TEMP",
            "summarizeBy": "none"
          }
        ],
        "lineageTag": "b15a1c60-7213-44a4-9e0d-b57861374e9c",
        "partitions": [
          {
            "name": "dim_UNIDADES-c3465fae-91d0-4c72-99f5-418079614e65",
            "mode": "import",
            "source": {
              "expression": [
                "let",
                "    Fonte = Table.FromRows(Json.Document(Binary.Decompress(Binary.FromText(\"xZbRDoIgFIZfhXVdW21tdkvKGg2FHbQb5wP5XL5YwJZBC8VIuXEq5/+/cw6ItO2ubFhNGb+hK2BJGTqgGnAlBYeaIJnv9gERSxXdfoYrYM7FRCxVzHKlmM1efNQbonC4FYeCSDXA6gLb4s+B17M/Rvui7Kh4UqjLGIUFp9zKQdoWOS+HHnI34Pe6spPG57H4yWXk1ZgEsrT1n9PiL0nxKSc+XdUCIsnTu5dXo9nqLo5tYrxVezWa7TSvKTEM/YpddkwIAN6stjun1YMyRlZdv/arK4aGAF2xm7YvMbbEMdY/FCX8UyJhkAV5jVNyCOzw9KyEkhZkaD4IJQpYcjG9e2O+nWY2OLt1Tw==\", BinaryEncoding.Base64), Compression.Deflate)), let _t = ((type nullable text) meta [Serialized.Text = true]) in type table [UNIDADE_NEGOCIO = _t, PARA = _t, UNIDADES_UNIFICADAS = _t, UNIDADE_PTO_TEMP = _t]),",
                "    #\"Tipo Alterado\" = Table.TransformColumnTypes(Fonte,{{\"UNIDADE_NEGOCIO\", type text}, {\"PARA\", type text}})",
                "in",
                "    #\"Tipo Alterado\""
              ],
              "type": "m"
            }
          }
        ]
      },
      {
        "name": "dimPLACA_FROTA",
        "annotations": [
          {
            "name": "PBI_ResultType",
            "value": "Table"
          }
        ],
        "columns": [
          {
            "name": "Placa",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "735a590c-3af2-4236-becf-9214747ac094",
            "sourceColumn": "Placa",
            "summarizeBy": "none"
          },
          {
            "name": "Equipamento",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "b2461f9d-7a63-45f4-95ab-f3e0e8d198c7",
            "sourceColumn": "Equipamento",
            "summarizeBy": "none"
          },
          {
            "name": "Local",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "15f150a7-d282-4f4a-9f8a-54a7244fbc6d",
            "sourceColumn": "Local",
            "summarizeBy": "none"
          },
          {
            "name": "Empresa",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "c5a340f9-6ea4-4025-979d-c4350d2cfe71",
            "sourceColumn": "Empresa",
            "summarizeBy": "none"
          },
          {
            "name": "Obs",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "e4402657-1420-43fb-8cbf-ac987544cc56",
            "sourceColumn": "Obs",
            "summarizeBy": "none"
          },
          {
            "name": "A Venda?",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "5815b924-b982-4393-85ef-876a9554db1c",
            "sourceColumn": "A Venda?",
            "summarizeBy": "none"
          },
          {
            "name": "Placa Descricao",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "expression": [
              "",
              "CONCATENATE(dimPLACA_FROTA[Placa]&\" - \", dimPLACA_FROTA[Equipamento])"
            ],
            "isDataTypeInferred": true,
            "lineageTag": "d349ed29-6224-44ec-9010-500d15702199",
            "summarizeBy": "none",
            "type": "calculated"
          },
          {
            "name": "Meta",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "a8e74ea8-ee4f-4c65-8a67-a0d2e7caeeeb",
            "sourceColumn": "Meta",
            "summarizeBy": "sum"
          },
          {
            "name": "Unidade Negocio",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "f29d713e-f69f-40ad-82c5-b01e871de718",
            "sourceColumn": "Unidade Negocio",
            "summarizeBy": "none"
          },
          {
            "name": "Frota?",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "expression": "\"Frota\"",
            "isDataTypeInferred": true,
            "lineageTag": "9526ceeb-93e9-47f9-9612-404d95d138d1",
            "summarizeBy": "none",
            "type": "calculated"
          },
          {
            "name": "source",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "expression": [
              "",
              "IF( ",
              "    CONTAINSSTRING( dimPLACA_FROTA[Unidade Negocio], \"APOIO\"),",
              "    \"LOGIX\",",
              "    \"KMM\")"
            ],
            "isDataTypeInferred": true,
            "lineageTag": "a92c44a9-576c-4f15-b392-124ce3e21b73",
            "summarizeBy": "none",
            "type": "calculated"
          }
        ],
        "lineageTag": "ad2be936-b0cc-4224-bdea-07e8805f12ac",
        "partitions": [
          {
            "name": "dimPLACA_FROTA-b8f94f92-dda8-4301-9e29-634e295badb4",
            "mode": "import",
            "source": {
              "expression": [
                "let",
                "    Fonte = Excel.Workbook(Web.Contents(\"https://multilogcombr-my.sharepoint.com/personal/pedro_maturana_multilog_com_br/Documents/placas_com_metas_BI.xlsx\"), null, true),",
                "    #\"PLACAS OFICIAL BI_Sheet\" = Fonte{[Item=\"PLACAS OFICIAL BI\",Kind=\"Sheet\"]}[Data],",
                "    #\"Cabeçalhos Promovidos\" = Table.PromoteHeaders(#\"PLACAS OFICIAL BI_Sheet\", [PromoteAllScalars=true]),",
                "    #\"Tipo Alterado\" = Table.TransformColumnTypes(#\"Cabeçalhos Promovidos\",{{\"Placa\", type text}, {\"Equipamento\", type text}, {\"Local\", type text}, {\"Empresa\", type text}, {\"Obs\", type text}, {\"A Venda?\", type text}, {\"Meta\", Int64.Type}, {\"Unidade Negocio\", type text}}),",
                "    #\"Colocar Cada Palavra Em Maiúscula\" = Table.TransformColumns(#\"Tipo Alterado\",{{\"Equipamento\", Text.Proper, type text}})",
                "in",
                "    #\"Colocar Cada Palavra Em Maiúscula\""
              ],
              "type": "m"
            }
          }
        ]
      },
      {
        "name": "dimCENTRO_CUSTO_GERENCIAL",
        "annotations": [
          {
            "name": "PBI_Id",
            "value": "b2325acb679849e2b05a29db558df81b"
          }
        ],
        "columns": [
          {
            "name": "CENTRO_CUSTO_GERENCIAL",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "226c7657-6945-4e04-8fca-a1cda176e3d4",
            "sourceColumn": "fato_carta_frete[CENTRO_CUSTO_GERENCIAL]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "PARA",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "expression": "SUBSTITUTE(dimCENTRO_CUSTO_GERENCIAL[CENTRO_CUSTO_GERENCIAL], \"Padrão /\", \"\")",
            "isDataTypeInferred": true,
            "lineageTag": "b3a866af-47f0-4afe-a86d-1f9cdd7f967c",
            "summarizeBy": "none",
            "type": "calculated"
          },
          {
            "name": "CENTRO_CUSTO_GERENCIAL_RESUMIDO",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "expression": [
              "",
              "SWITCH(",
              "    TRUE(),",
              "    CONTAINSSTRING(dimCENTRO_CUSTO_GERENCIAL[PARA], \"DTC\"), \"DTC\",",
              "    CONTAINSSTRING(dimCENTRO_CUSTO_GERENCIAL[PARA], \"DTBC\"), \"DTBC\",",
              "    CONTAINSSTRING(dimCENTRO_CUSTO_GERENCIAL[PARA], \"INTC\"), \"INTC\",",
              "    CONTAINSSTRING(dimCENTRO_CUSTO_GERENCIAL[PARA], \"DTA\"), \"DTA\",",
              "    CONTAINSSTRING(dimCENTRO_CUSTO_GERENCIAL[PARA], \"APP\"), \"APP\",",
              "    CONTAINSSTRING(dimCENTRO_CUSTO_GERENCIAL[PARA], \"FRAC\"), \"FRAC\",",
              "    \"Padrão\")",
              "",
              "",
              ""
            ],
            "isDataTypeInferred": true,
            "lineageTag": "ccc2855d-d8f8-4d68-b916-0efcaba6158b",
            "summarizeBy": "none",
            "type": "calculated"
          }
        ],
        "lineageTag": "9877634a-b37f-406f-9548-30b189fe37d6",
        "partitions": [
          {
            "name": "dimCENTRO_CUSTO_GERENCIAL-fa8a1cce-4267-4210-a661-986e72bc1f42",
            "mode": "import",
            "source": {
              "expression": [
                "",
                "DISTINCT(",
                "    UNION(",
                "        FILTER( VALUES( fato_carta_frete[CENTRO_CUSTO_GERENCIAL]), fato_carta_frete[CENTRO_CUSTO_GERENCIAL] <> BLANK() ),",
                "        FILTER( VALUES( fato_cte[CENTRO_CUSTO_GERENCIAL] ), fato_cte[CENTRO_CUSTO_GERENCIAL] <> BLANK() ),",
                "        FILTER( VALUES( fato_nf[DESCRICAO_ORGANIZACIONAL] ), fato_nf[DESCRICAO_ORGANIZACIONAL] <> BLANK() )",
                "    )",
                ")"
              ],
              "type": "calculated"
            }
          }
        ]
      },
      {
        "name": "fato_meta_frota",
        "annotations": [
          {
            "name": "PBI_ResultType",
            "value": "Table"
          }
        ],
        "columns": [
          {
            "name": "Placa",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "isHidden": true,
            "lineageTag": "4e28661c-4c8c-47c4-b96a-1593a2a0a9e4",
            "sourceColumn": "Placa",
            "summarizeBy": "none"
          },
          {
            "name": "Meta",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "08119053-2d1b-4a7e-a5ae-d486d710f161",
            "sourceColumn": "Meta",
            "summarizeBy": "sum"
          },
          {
            "name": "Data Conclusao",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "UnderlyingDateTimeDataType",
                "value": "Date"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "dateTime",
            "formatString": "Long Date",
            "isHidden": true,
            "lineageTag": "13c18156-09ab-4c4a-827a-0ad65e8b360b",
            "sourceColumn": "Data Conclusao",
            "summarizeBy": "none"
          },
          {
            "name": "Unidade Negocio",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "isHidden": true,
            "lineageTag": "7efcda64-65fe-426b-af2b-7f5f07ee8599",
            "sourceColumn": "Unidade Negocio",
            "summarizeBy": "none"
          }
        ],
        "lineageTag": "d3a35483-76b8-4e6e-85f4-fee1d5842dd1",
        "partitions": [
          {
            "name": "fato_meta_frota-a9771fa5-439c-44b5-9b12-b7e11e11e3a1",
            "mode": "import",
            "source": {
              "expression": [
                "let",
                "    Fonte = Excel.Workbook(Web.Contents(\"https://multilogcombr-my.sharepoint.com/personal/pedro_maturana_multilog_com_br/Documents/placas_com_metas_BI.xlsx\"), null, true),",
                "    METAS_Sheet = Fonte{[Item=\"METAS\",Kind=\"Sheet\"]}[Data],",
                "    #\"Cabeçalhos Promovidos\" = Table.PromoteHeaders(METAS_Sheet, [PromoteAllScalars=true]),",
                "    #\"Tipo Alterado\" = Table.TransformColumnTypes(#\"Cabeçalhos Promovidos\",{{\"Placa\", type text}, {\"Meta\", Int64.Type}, {\"Data Conclusao\", type date}, {\"Unidade Negocio\", type text}})",
                "in",
                "    #\"Tipo Alterado\""
              ],
              "type": "m"
            }
          }
        ]
      },
      {
        "name": "dimTIPO_DOC_AUX",
        "annotations": [
          {
            "name": "PBI_Id",
            "value": "2985ba92af7d41c89a486152d9f8c0fa"
          }
        ],
        "columns": [
          {
            "name": "TIPO_AUX",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "4d48c354-b263-415a-a7e6-72330882d45d",
            "sourceColumn": "fato_carta_frete[TIPO_AUX]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          }
        ],
        "lineageTag": "641f5363-1212-461e-a6a6-7b3c69575617",
        "partitions": [
          {
            "name": "dimTIPO_DOC_AUX-fc306e9e-6aa8-40e9-9e8a-2bd965e4317a",
            "mode": "import",
            "source": {
              "expression": [
                "",
                "-- Se voce não sabe pra que serve essa tabela, provavelmente não precisa dela",
                "DISTINCT(",
                "        UNION(",
                "            FILTER(DISTINCT(fato_carta_frete[TIPO_AUX]), fato_carta_frete[TIPO_AUX] <> BLANK()),",
                "            FILTER(DISTINCT(fato_cte[CONHECIMENTO_TIPO]), fato_cte[CONHECIMENTO_TIPO] <> BLANK()),",
                "            FILTER(DISTINCT(fato_nf[TIPO_NOTA_FISCAL]), fato_nf[TIPO_NOTA_FISCAL] <> BLANK())",
                "        )",
                ")"
              ],
              "type": "calculated"
            }
          }
        ]
      },
      {
        "name": "Rotas_sem_distancia",
        "annotations": [
          {
            "name": "PBI_Id",
            "value": "748c334645e74aecb38870c166de3647"
          }
        ],
        "columns": [
          {
            "name": "DISTANCIA",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "6e406dd4-b08b-4a6c-a237-35f1ba098c43",
            "sourceColumn": "[DISTANCIA]",
            "summarizeBy": "sum",
            "type": "calculatedTableColumn"
          },
          {
            "name": "ROTA",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "0ee52098-9158-4128-8083-4c943fde46d6",
            "sourceColumn": "fato_cte[ROTA]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          }
        ],
        "description": [
          "Tabela com rotas sem a distância requisitada na API Google, verificar semanalmente e fazer novas requisições (cuidado para não estourar limite)",
          ""
        ],
        "lineageTag": "c3ad7e81-bfde-40b1-933f-dac7aaf13ce1",
        "partitions": [
          {
            "name": "Rotas_sem_distancia-1a4540f0-2a3d-4dd6-b068-aaedf1925236",
            "mode": "import",
            "source": {
              "expression": [
                "",
                "VAR rotas_sem_distancia_cte = ",
                "FILTER( ",
                "    SUMMARIZE( ",
                "        VALUES( fato_cte[ROTA] ), ",
                "        fato_cte[ROTA],",
                "        \"DISTANCIA\", SUM( fato_cte[Distancia (KM)] ) ",
                "        ),",
                "        [DISTANCIA] = BLANK() )",
                "",
                "VAR rotas_sem_distancia_nf = ",
                "FILTER( ",
                "    SUMMARIZE( ",
                "        VALUES( fato_nf[ROTA] ), ",
                "        fato_nf[ROTA],",
                "        \"DISTANCIA\", SUM( fato_nf[Distancia (KM)] ) ",
                "        ),",
                "        [DISTANCIA] = BLANK() )",
                "",
                "RETURN",
                "DISTINCT(",
                "    UNION( rotas_sem_distancia_cte, rotas_sem_distancia_nf)",
                ")"
              ],
              "type": "calculated"
            }
          }
        ]
      },
      {
        "name": "fato_meta_plano",
        "annotations": [
          {
            "name": "PBI_ResultType",
            "value": "Table"
          }
        ],
        "columns": [
          {
            "name": "DATA_PLANO",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "UnderlyingDateTimeDataType",
                "value": "Date"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "dateTime",
            "formatString": "Short Date",
            "isHidden": true,
            "lineageTag": "9f02b0ee-3b47-438e-b2e9-b009c7a7186a",
            "sourceColumn": "DATA_PLANO",
            "summarizeBy": "none"
          },
          {
            "name": "UNIDADE_NEGOCIO_F",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "isHidden": true,
            "lineageTag": "f22fa5e3-21eb-4ec0-be12-e8853403ace7",
            "sourceColumn": "UNIDADE_NEGOCIO_F",
            "summarizeBy": "none"
          },
          {
            "name": "VALOR_PLANEJADO",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "5f4a1ff5-8d1a-4f71-8cfa-019aeaba5d75",
            "sourceColumn": "VALOR_PLANEJADO",
            "summarizeBy": "sum"
          },
          {
            "name": "source",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "expression": [
              "",
              "-- Se a unidade de negócio for uma das listadas abaixo e for menor que a data de corte, o source é LOGIX",
              "IF( fato_meta_plano[UNIDADE_NEGOCIO_F] IN {\"TRANSPORTES BARUERI\", ",
              "                                           \"TRANSPORTES SERRA\", ",
              "                                           \"TRANSPORTES SUMARÉ\", ",
              "                                           \"TRANSPORTES JOINVILLE\"} ",
              "                                        && fato_meta_plano[DATA_PLANO] < DATE(2024,1,1) , -- 01/01/2024 Data virada sistema logix -> KMM",
              "    \"LOGIX\", ",
              "    \"KMM\") -- Caso contrário, retorna KMM"
            ],
            "isDataTypeInferred": true,
            "isHidden": true,
            "lineageTag": "1a39e68f-9cd7-42fa-a7a0-95b97a343a6c",
            "summarizeBy": "none",
            "type": "calculated"
          }
        ],
        "lineageTag": "5ecaeefe-35c0-42a2-a082-2de6e72964bc",
        "partitions": [
          {
            "name": "fato_meta_plano-6a798300-3e43-4193-af62-8923d2e07229",
            "mode": "import",
            "source": {
              "expression": [
                "let",
                "    Fonte = Value.NativeQuery(Databricks.Catalogs(\"adb-1220993250695902.2.azuredatabricks.net\", \"/sql/1.0/warehouses/6b94e3b6ef796336\", [Catalog=\"hive_metastore\", Database=null, EnableAutomaticProxyDiscovery=null]){[Name=\"hive_metastore\",Kind=\"Database\"]}[Data], \"SELECT ",
                "t3.DATA_PLANO, t3.UNIDADE_NEGOCIO_F, round(try_divide(t3.VALOR_ORCADO, t3.DIVISOR_F),2) AS VALOR_PLANEJADO FROM (",
                "SELECT ",
                "t1.DATA_PLANO AS DATA_PLANO, ",
                "t1.VALOR_ORCADO AS VALOR_ORCADO,",
                "COALESCE(t2.UNIDADE_NEGOCIO_NOVA , t1.UNIDADE_NEGOCIO_NOVA) AS UNIDADE_NEGOCIO_F,",
                "COALESCE(t2.DIVISOR, 1) AS DIVISOR_F",
                "FROM(",
                "\tSELECT",
                "\tdata_acompanhamento_fk AS DATA_PLANO,",
                "\tNOME_CONTA,",
                "\tSUM(VALOR_ORCADO) AS VALOR_ORCADO,",
                "\tNOME_UNIDADE,",
                "\tCASE ",
                "\tWHEN NOME_UNIDADE LIKE '%Transportes - São Paulo%' THEN 'MULTILOG BRASIL - TRANSPORTE SP'",
                "\tWHEN NOME_UNIDADE LIKE '%Transportes - Curitiba%' THEN 'MULTILOG BRASIL - TRANSPORTE PR'",
                "\tWHEN NOME_UNIDADE LIKE '%Transportes - Itajaí%' THEN 'MULTILOG BRASIL - TRANSPORTE SC'",
                "\tWHEN NOME_UNIDADE LIKE '%Multilog Nordeste - Transportes%' THEN 'MULTILOG NORDESTE LTDA'",
                "\t",
                "\t-----  Até 2022 os nomes ficaram como acima, depois muda para as unidades abaixo ---------",
                "\t",
                "\tWHEN NOME_UNIDADE LIKE '%Transportes São Paulo%' THEN 'MULTILOG BRASIL - TRANSPORTE SP'",
                "\tWHEN NOME_UNIDADE LIKE '%Transportes Curitiba%' THEN 'MULTILOG BRASIL - TRANSPORTE PR'",
                "\tWHEN NOME_UNIDADE LIKE '%Transportes Itajaí%' THEN 'MULTILOG BRASIL - TRANSPORTE SC'",
                "\tWHEN NOME_UNIDADE LIKE '%Transportes Salvador%' THEN 'MULTILOG NORDESTE LTDA'",
                "\tELSE UPPER(NOME_UNIDADE)",
                "\tEND AS UNIDADE_NEGOCIO_NOVA,",
                "\tCONCAT(data_acompanhamento_fk, NOME_UNIDADE) AS CHAVE_CONTAGEM",
                "\tFROM ouro_plano.dre_apenas_receita",
                "\tWHERE NOME_CONTA LIKE '%Serviços de Transporte%'",
                "\tGROUP BY data_acompanhamento_fk, NOME_UNIDADE, NOME_CONTA, UNIDADE_NEGOCIO_NOVA",
                "\tHAVING VALOR_ORCADO > 0) t1",
                "",
                "LEFT JOIN (SELECT NOME_UNIDADE, UNIDADE_NEGOCIO_NOVA, DIVISOR FROM(",
                "\tSELECT 'Transportes e Comércio Ltda' AS NOME_UNIDADE, 'SC - MULTILOG APOIO TRANSPORTES' AS UNIDADE_NEGOCIO_NOVA, 3 AS DIVISOR",
                "\tUNION ALL",
                "\tSELECT 'Transportes e Comércio Ltda', 'PR - MULTILOG APOIO TRANSPORTES', 3 ",
                "\tUNION ALL",
                "\tSELECT 'Transportes e Comércio Ltda' ,'SP - MULTILOG APOIO TRANSPORTES', 3)) t2",
                "",
                "ON t1.NOME_UNIDADE = t2.NOME_UNIDADE) t3\", null, [EnableFolding=true]),",
                "    #\"Tipo Alterado\" = Table.TransformColumnTypes(Fonte,{{\"DATA_PLANO\", type date}})",
                "in",
                "    #\"Tipo Alterado\""
              ],
              "type": "m"
            }
          }
        ]
      },
      {
        "name": "fato_alelo",
        "annotations": [
          {
            "name": "PBI_ResultType",
            "value": "Table"
          }
        ],
        "columns": [
          {
            "name": "Filial",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "isHidden": true,
            "lineageTag": "9bac7ef3-f11f-48ef-a790-a93bd8e3e259",
            "sourceColumn": "Filial",
            "summarizeBy": "none"
          },
          {
            "name": "Placa",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "isHidden": true,
            "lineageTag": "6cbbc55f-f501-4210-9649-d99a1020f5f5",
            "sourceColumn": "Placa",
            "summarizeBy": "none"
          },
          {
            "name": "Data Utilizacao",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "UnderlyingDateTimeDataType",
                "value": "Date"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "dateTime",
            "formatString": "Long Date",
            "isHidden": true,
            "lineageTag": "f6bb0193-d7a9-43e3-8712-7af2092b5bae",
            "sourceColumn": "Data Utilizacao",
            "summarizeBy": "none"
          },
          {
            "name": "Data Postagem",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "isHidden": true,
            "lineageTag": "54436aaa-767d-412b-b051-e0730f667c20",
            "sourceColumn": "Data Postagem",
            "summarizeBy": "none"
          },
          {
            "name": "CPF",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "isHidden": true,
            "lineageTag": "cd799f72-27a7-4474-9cb5-e03baa04728e",
            "sourceColumn": "CPF",
            "summarizeBy": "none"
          },
          {
            "name": "Motorista",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "isHidden": true,
            "lineageTag": "ecbc4d96-2468-4e45-9bc3-b8ee4d8265fa",
            "sourceColumn": "Motorista",
            "summarizeBy": "none"
          },
          {
            "name": "Estabelecimento",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "isHidden": true,
            "lineageTag": "d3853a5a-59d6-4c3c-b9f6-a2eb0348e717",
            "sourceColumn": "Estabelecimento",
            "summarizeBy": "none"
          },
          {
            "name": "Cidade EC",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "isHidden": true,
            "lineageTag": "8c9e9c20-00af-499b-9998-f8862bb84024",
            "sourceColumn": "Cidade EC",
            "summarizeBy": "none"
          },
          {
            "name": "UF EC",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "isHidden": true,
            "lineageTag": "10f63f43-10cb-47c8-9f3c-a52f9afbc0cb",
            "sourceColumn": "UF EC",
            "summarizeBy": "none"
          },
          {
            "name": "Tipo Mercadoria",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "isHidden": true,
            "lineageTag": "57af39ba-2822-471f-883b-7d621682cec8",
            "sourceColumn": "Tipo Mercadoria",
            "summarizeBy": "none"
          },
          {
            "name": "Mercadoria",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "isHidden": true,
            "lineageTag": "f1be4078-16c3-4cd8-8a09-201f4c75c5e3",
            "sourceColumn": "Mercadoria",
            "summarizeBy": "none"
          },
          {
            "name": "Litros Abastecidos",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "4f9909fd-744c-4d32-b614-fb4d3e2ea5b7",
            "sourceColumn": "Litros Abastecidos",
            "summarizeBy": "sum"
          },
          {
            "name": "Valor Unit. Litro",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "3eb0f629-92af-4741-a5fd-3d29261e3de0",
            "sourceColumn": "Valor Unit. Litro",
            "summarizeBy": "sum"
          },
          {
            "name": "Valor Total Transação",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "a1cee17e-8057-45af-8e3c-cadcac8ddedf",
            "sourceColumn": "Valor Total Transação",
            "summarizeBy": "sum"
          },
          {
            "name": "Hodômetro Anterior",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "double",
            "formatString": "0",
            "lineageTag": "62665078-1fbc-4baa-ac32-3aab45142b2f",
            "sourceColumn": "Hodômetro Anterior",
            "summarizeBy": "sum"
          },
          {
            "name": "Horimetro Anterior",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "isHidden": true,
            "lineageTag": "c8506279-7720-4b4b-bcc0-57fdf644dd48",
            "sourceColumn": "Horimetro Anterior",
            "summarizeBy": "none"
          },
          {
            "name": "Hodômetro Transação",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "double",
            "formatString": "0",
            "lineageTag": "b0e1800b-e05f-4f15-b3f6-b02dfc4816ad",
            "sourceColumn": "Hodômetro Transação",
            "summarizeBy": "sum"
          },
          {
            "name": "Horimetro Transação",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "isHidden": true,
            "lineageTag": "effb9dcc-2db0-42b2-8990-f54dc7093ac4",
            "sourceColumn": "Horimetro Transação",
            "summarizeBy": "none"
          },
          {
            "name": "Data Utilizacao BACKUP",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "isHidden": true,
            "lineageTag": "e8badd42-da99-423a-8761-7cf78206e4ba",
            "sourceColumn": "Data Utilizacao BACKUP",
            "summarizeBy": "none"
          },
          {
            "name": "Km Percorrido",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "8a785961-9db3-4372-be48-6545e828c906",
            "sourceColumn": "Km Percorrido",
            "summarizeBy": "sum"
          },
          {
            "name": "Media Efetiva",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "8311df2a-2ea6-4847-8548-b4280882fb1f",
            "sourceColumn": "Media Efetiva",
            "summarizeBy": "sum"
          },
          {
            "name": "Custo km Percorrido",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "15787bcf-329b-49aa-b7d8-1ba7b879f448",
            "sourceColumn": "Custo km Percorrido",
            "summarizeBy": "sum"
          },
          {
            "name": "Unidade Negocio",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "expression": "RELATED( dimPLACA_FROTA[Unidade Negocio] )",
            "isDataTypeInferred": true,
            "lineageTag": "8830bf38-551d-4208-841f-d355be695feb",
            "summarizeBy": "none",
            "type": "calculated"
          },
          {
            "name": "dimDEXPARA_PLACAS_FROTA.PARA",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "isHidden": true,
            "lineageTag": "046678c8-1fd8-464b-aef3-30d29581bce2",
            "sourceColumn": "dimDEXPARA_PLACAS_FROTA.PARA",
            "summarizeBy": "none"
          },
          {
            "name": "Contrato",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "isHidden": true,
            "lineageTag": "c85f7d36-28dd-4f1a-b2e2-4e5b6d96d2e5",
            "sourceColumn": "Contrato",
            "summarizeBy": "none"
          },
          {
            "name": "CNPJ Filial",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "isHidden": true,
            "lineageTag": "6790943e-7674-46fd-8caa-9c9820691370",
            "sourceColumn": "CNPJ Filial",
            "summarizeBy": "none"
          },
          {
            "name": "Modelo veículo",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "isHidden": true,
            "lineageTag": "4abbc594-a633-4006-a19d-83fcd128e3f1",
            "sourceColumn": "Modelo veículo",
            "summarizeBy": "none"
          },
          {
            "name": "Nome Veículo",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "isHidden": true,
            "lineageTag": "9d4db105-91af-456f-83a7-8c02f846e1b1",
            "sourceColumn": "Nome Veículo",
            "summarizeBy": "none"
          },
          {
            "name": "Tipo de Frota",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "isHidden": true,
            "lineageTag": "596c45c8-958a-460f-bf80-0f3eb80e9874",
            "sourceColumn": "Tipo de Frota",
            "summarizeBy": "none"
          },
          {
            "name": "Capacidade Tanque",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "isHidden": true,
            "lineageTag": "5da49256-5263-48b6-b180-a3c3a9e930d1",
            "sourceColumn": "Capacidade Tanque",
            "summarizeBy": "none"
          },
          {
            "name": "Centro de custo veículo",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "isHidden": true,
            "lineageTag": "94743043-41a1-46c5-b32e-93f90bcd6203",
            "sourceColumn": "Centro de custo veículo",
            "summarizeBy": "none"
          },
          {
            "name": "Descrição Centro de custo placa",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "isHidden": true,
            "lineageTag": "84e2a0c9-26f6-454d-a55f-068688a02cab",
            "sourceColumn": "Descrição Centro de custo placa",
            "summarizeBy": "none"
          },
          {
            "name": "Estado veículo",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "isHidden": true,
            "lineageTag": "854c8687-2b85-43f9-b9d1-eb63ba68e965",
            "sourceColumn": "Estado veículo",
            "summarizeBy": "none"
          },
          {
            "name": "Cidade veículo",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "isHidden": true,
            "lineageTag": "b1a6fb3a-c746-4dd3-9e59-b07b34181040",
            "sourceColumn": "Cidade veículo",
            "summarizeBy": "none"
          },
          {
            "name": "Matrícula Motorista",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "isHidden": true,
            "lineageTag": "2524a091-489b-463b-bcf1-beb0b20f4a53",
            "sourceColumn": "Matrícula Motorista",
            "summarizeBy": "none"
          },
          {
            "name": "Número CNH",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "isHidden": true,
            "lineageTag": "7c7ef200-f7a7-41dd-88c7-7f5e4be0498d",
            "sourceColumn": "Número CNH",
            "summarizeBy": "none"
          },
          {
            "name": "Categoria CNH",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "isHidden": true,
            "lineageTag": "7eb02f1c-41f8-4003-80f4-d7e585a8a182",
            "sourceColumn": "Categoria CNH",
            "summarizeBy": "none"
          },
          {
            "name": "Centro de Custo Motorista",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "isHidden": true,
            "lineageTag": "815ab8c6-a631-4d91-a6b8-4934fa837a32",
            "sourceColumn": "Centro de Custo Motorista",
            "summarizeBy": "none"
          },
          {
            "name": "Descrição Centro de Custo Motorista",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "isHidden": true,
            "lineageTag": "b6bcb4c3-7557-46dd-adee-834b2581c5d9",
            "sourceColumn": "Descrição Centro de Custo Motorista",
            "summarizeBy": "none"
          },
          {
            "name": "Nota fiscal",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "isHidden": true,
            "lineageTag": "a81bcdde-70cc-4755-811f-aa980cee8016",
            "sourceColumn": "Nota fiscal",
            "summarizeBy": "none"
          },
          {
            "name": "Tipo de cartão",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "isHidden": true,
            "lineageTag": "caaf32b4-3998-479a-bd3c-8555e3efd313",
            "sourceColumn": "Tipo de cartão",
            "summarizeBy": "none"
          },
          {
            "name": "Limite Cartão",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "isHidden": true,
            "lineageTag": "e09dea8c-1e7e-4910-9988-3de53fcc00de",
            "sourceColumn": "Limite Cartão",
            "summarizeBy": "none"
          },
          {
            "name": "Saldo Cartão",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "isHidden": true,
            "lineageTag": "d2733058-d2a7-420f-bf00-f86d51926410",
            "sourceColumn": "Saldo Cartão",
            "summarizeBy": "none"
          },
          {
            "name": "Logradouro EC",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "isHidden": true,
            "lineageTag": "29027d5c-3227-45d0-ad05-54ae5c2b7241",
            "sourceColumn": "Logradouro EC",
            "summarizeBy": "none"
          },
          {
            "name": "Valor total com desconto",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "7e2099e0-ea1b-41e2-b8aa-6aecbffed061",
            "sourceColumn": "Valor total com desconto",
            "summarizeBy": "none"
          },
          {
            "name": "Valor total Economizado",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "f44d8987-be3b-461a-adb5-401cb8fb420a",
            "sourceColumn": "Valor total Economizado",
            "summarizeBy": "none"
          },
          {
            "name": "Rendimento Médio",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "isHidden": true,
            "lineageTag": "835f75aa-d544-4411-8f67-65e15749374d",
            "sourceColumn": "Rendimento Médio",
            "summarizeBy": "none"
          },
          {
            "name": "Tolerância Rendimento Veículo (%)",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "isHidden": true,
            "lineageTag": "dcc062aa-0b29-4b95-ace8-6de7b89636a9",
            "sourceColumn": "Tolerância Rendimento Veículo (%)",
            "summarizeBy": "none"
          },
          {
            "name": "Desvio na Transação (%)",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "isHidden": true,
            "lineageTag": "b191da2e-e67d-4163-9372-d21ecf33b517",
            "sourceColumn": "Desvio na Transação (%)",
            "summarizeBy": "none"
          },
          {
            "name": "Desvio na Transação (número)",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "isHidden": true,
            "lineageTag": "99b808b0-5f85-4ac9-80b6-5d46aae6112c",
            "sourceColumn": "Desvio na Transação (número)",
            "summarizeBy": "none"
          },
          {
            "name": "Descrição Desvio na Transação",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "isHidden": true,
            "lineageTag": "17e2150e-f5ff-48f6-a01f-7e432a459a82",
            "sourceColumn": "Descrição Desvio na Transação",
            "summarizeBy": "none"
          },
          {
            "name": "Centro Custo Transação - Dig. Motorista",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "isHidden": true,
            "lineageTag": "e17c00eb-c873-436d-92e0-79f2b7745e84",
            "sourceColumn": "Centro Custo Transação - Dig. Motorista",
            "summarizeBy": "none"
          },
          {
            "name": "Código Frota - Dig.Motorista",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "isHidden": true,
            "lineageTag": "0445f1ce-a5c4-424d-8e48-db4a6c1c905f",
            "sourceColumn": "Código Frota - Dig.Motorista",
            "summarizeBy": "none"
          },
          {
            "name": "Column60",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "isHidden": true,
            "lineageTag": "0cf4e57b-de0c-4b3a-a42e-d66d2fd31da5",
            "sourceColumn": "Column60",
            "summarizeBy": "none"
          },
          {
            "name": "Nota Fiscal 2",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "isHidden": true,
            "lineageTag": "7b11d349-330a-4b1c-896b-0c930632f309",
            "sourceColumn": "Nota Fiscal",
            "summarizeBy": "none"
          },
          {
            "name": "Valor total com descontos",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "18233227-9679-4f79-9bbc-4df73b9f4748",
            "sourceColumn": "Valor total com descontos",
            "summarizeBy": "none"
          },
          {
            "name": "Placa - Dig.Motorista",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "isHidden": true,
            "lineageTag": "14e797e6-c341-49a5-8407-98c60df41260",
            "sourceColumn": "Placa - Dig.Motorista",
            "summarizeBy": "none"
          },
          {
            "name": "Ordem Serviço - Dig.Motorista",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "isHidden": true,
            "lineageTag": "c261c99b-67f4-498c-b559-8e7a63115f0c",
            "sourceColumn": "Ordem Serviço - Dig.Motorista",
            "summarizeBy": "none"
          },
          {
            "name": "Ordem de Serviço",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "isHidden": true,
            "lineageTag": "7daadde7-c78d-490e-b228-4f60968a30ce",
            "sourceColumn": "Ordem de Serviço",
            "summarizeBy": "none"
          },
          {
            "name": "Patrimônio_1",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "isHidden": true,
            "lineageTag": "dd4fd7cf-d2ed-4779-8eb0-16b33fbb6cda",
            "sourceColumn": "Patrimônio_1",
            "summarizeBy": "none"
          },
          {
            "name": "Garagem_2",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "isHidden": true,
            "lineageTag": "ed27fd29-b1a2-4430-83a9-f69a9930126e",
            "sourceColumn": "Garagem_2",
            "summarizeBy": "none"
          },
          {
            "name": "RG Motorista_3",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "isHidden": true,
            "lineageTag": "f647b1d8-66ed-426f-b044-1ddb584833dc",
            "sourceColumn": "RG Motorista_3",
            "summarizeBy": "none"
          },
          {
            "name": "Categoria CNH_4",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "isHidden": true,
            "lineageTag": "ec236162-be48-4cd7-817a-f68552227a5f",
            "sourceColumn": "Categoria CNH_4",
            "summarizeBy": "none"
          },
          {
            "name": "Categoria CNH_1",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "isHidden": true,
            "lineageTag": "3fd383e8-c52f-4e48-a85d-0dfb5f3ebe86",
            "sourceColumn": "Categoria CNH_1",
            "summarizeBy": "none"
          }
        ],
        "lineageTag": "fc6fed88-c0d9-4fb7-90ba-bb57431f080f",
        "partitions": [
          {
            "name": "fato_alelo-bb6ec4b9-73a0-4aa6-a893-2e9a4157c388",
            "mode": "import",
            "source": {
              "expression": [
                "let",
                "    Fonte = Table.Combine({Base_Alelo_Nordeste, Base_Alelo_A, Base_Alelo_M}),",
                "    #\"Texto em Maiúscula\" = Table.TransformColumns(Fonte,{{\"Cidade EC\", Text.Upper, type text}}),",
                "    #\"Tipo Alterado1\" = Table.TransformColumnTypes(#\"Texto em Maiúscula\",{{\"Hodômetro Anterior\", type number}, {\"Hodômetro Transação\", type number}, {\"Litros Abastecidos\", type number}, {\"Valor Unit. Litro\", type number}, {\"Valor Total Transação\", type number}}),",
                "    #\"km percorrido\" = Table.AddColumn(#\"Tipo Alterado1\", \"Km Percorrido\", each [Hodômetro Transação] - [Hodômetro Anterior]),",
                "    #\"Media Efetiva\" = Table.AddColumn(#\"km percorrido\", \"Media Efetiva\", each [Km Percorrido] / [Litros Abastecidos]),",
                "    #\"Personalização Adicionada\" = Table.AddColumn(#\"Media Efetiva\", \"Custo km Percorrido\", each [Km Percorrido] / [Valor Total Transação]),",
                "    #\"Tipo Alterado\" = Table.TransformColumnTypes(#\"Personalização Adicionada\",{{\"Km Percorrido\", type number}, {\"Media Efetiva\", type number}, {\"Custo km Percorrido\", type number}}),",
                "    #\"Consultas Mescladas\" = Table.NestedJoin(#\"Tipo Alterado\", {\"Placa\"}, dimDEXPARA_PLACAS_FROTA, {\"DE\"}, \"dimDEXPARA_PLACAS_FROTA\", JoinKind.LeftOuter),",
                "    #\"dimDEXPARA_PLACAS_FROTA Expandido\" = Table.ExpandTableColumn(#\"Consultas Mescladas\", \"dimDEXPARA_PLACAS_FROTA\", {\"PARA\"}, {\"dimDEXPARA_PLACAS_FROTA.PARA\"}),",
                "    #\"Colunas Renomeadas\" = Table.RenameColumns(#\"dimDEXPARA_PLACAS_FROTA Expandido\",{{\"Placa\", \"Placa Antiga\"}}),",
                "    #\"Personalização Adicionada1\" = Table.AddColumn(#\"Colunas Renomeadas\", \"Placa\", each if [dimDEXPARA_PLACAS_FROTA.PARA] is null then [Placa Antiga] else [dimDEXPARA_PLACAS_FROTA.PARA]),",
                "    #\"Colunas Removidas\" = Table.RemoveColumns(#\"Personalização Adicionada1\",{\"Placa Antiga\"})",
                "in",
                "    #\"Colunas Removidas\""
              ],
              "type": "m"
            }
          }
        ]
      },
      {
        "name": "fato_despesa_frota_plano",
        "annotations": [
          {
            "name": "PBI_ResultType",
            "value": "Table"
          }
        ],
        "columns": [
          {
            "name": "DATA_DESPESA",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "UnderlyingDateTimeDataType",
                "value": "Date"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "dateTime",
            "formatString": "Short Date",
            "isHidden": true,
            "lineageTag": "c68f4f52-dce1-4990-a9a2-43c4a477b4b3",
            "sourceColumn": "DATA_DESPESA",
            "summarizeBy": "none"
          },
          {
            "name": "NOME_CONTA",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "isHidden": true,
            "lineageTag": "df46c468-4d4b-4552-9417-cf27b01f50a3",
            "sourceColumn": "NOME_CONTA",
            "summarizeBy": "none"
          },
          {
            "name": "NOME_CENTROCUSTO",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "isHidden": true,
            "lineageTag": "4f7b8ea3-a10e-453b-ad4d-10d20ac587b9",
            "sourceColumn": "NOME_CENTROCUSTO",
            "summarizeBy": "none"
          },
          {
            "name": "UNIDADE_NEGOCIO_F",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "isHidden": true,
            "lineageTag": "137cdcd3-f51d-4bac-ba0b-69b544139885",
            "sourceColumn": "UNIDADE_NEGOCIO_F",
            "summarizeBy": "none"
          },
          {
            "name": "DESPESA",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "16e69498-f058-4621-94c2-9afc2b87d7b3",
            "sourceColumn": "DESPESA",
            "summarizeBy": "sum"
          }
        ],
        "lineageTag": "3cc0c3e6-981f-4230-b7ab-23b568074e7b",
        "partitions": [
          {
            "name": "fato_despesa_frota_plano-d3176002-27f9-44af-b601-f946f0b2d108",
            "mode": "import",
            "source": {
              "expression": [
                "let",
                "    Fonte = Value.NativeQuery(Databricks.Catalogs(\"adb-1220993250695902.2.azuredatabricks.net\", \"/sql/1.0/warehouses/6b94e3b6ef796336\", [Catalog=\"hive_metastore\", Database=null, EnableAutomaticProxyDiscovery=null]){[Name=\"hive_metastore\",Kind=\"Database\"]}[Data], \"SELECT t3.DATA_DESPESA, t3.NOME_CONTA, t3.NOME_CENTROCUSTO,  t3.UNIDADE_NEGOCIO_F, try_divide(t3.DESPESA, t3.DIVISOR_F) AS DESPESA",
                "FROM (",
                "\tSELECT t1.DATA_DESPESA, ",
                "\tt1.NOME_UNIDADE, ",
                "\tt1.NOME_CONTA,",
                "\tt1.NOME_CENTROCUSTO,",
                "\tt1.DESPESA, ",
                "\tCOALESCE(t2.UNIDADE_NEGOCIO_NOVA, t1.NOME_UNIDADE) AS UNIDADE_NEGOCIO_F,",
                "\tCOALESCE(t2.DIVISOR, 1) AS DIVISOR_F",
                "\tFROM (",
                "\t\tSELECT data_acompanhamento_fk AS DATA_DESPESA, ",
                "\t\tCASE",
                "\t\t\tWHEN NOME_UNIDADE LIKE '%Transportes São Paulo%' THEN 'MULTILOG BRASIL - TRANSPORTE SP'",
                "\t\t\tWHEN NOME_UNIDADE LIKE '%Transportes Curitiba%' THEN 'MULTILOG BRASIL - TRANSPORTE PR'",
                "\t\t\tWHEN NOME_UNIDADE LIKE '%Transportes Itajaí%' THEN 'MULTILOG BRASIL - TRANSPORTE SC'",
                "\t\t\tWHEN NOME_UNIDADE LIKE '%Transportes Salvador%' THEN 'MULTILOG NORDESTE LTDA'",
                "\t\t\tELSE UPPER(NOME_UNIDADE)",
                "\t\t\tEND AS NOME_UNIDADE,",
                "\t\tNOME_CONTA, ",
                "\t\tCASE",
                "\t\t\tWHEN ESTRUTURA_CONTA IN ('4.1.1.02.1.11', '4.1.1.02.1.20', '4.1.1.06.1.02', '4.1.1.06.1.05', '4.1.1.04.1.11', '4.1.1.11.1.05', '4.1.1.90.1.06') THEN 'Operações'",
                "\t\t\tELSE 'Outros'",
                "\t\t\tEND AS NOME_CENTROCUSTO,",
                "\t\tSUM(VALOR_REALIZADO) AS DESPESA",
                "\t\tFROM ouro_plano.dre",
                "\t\tWHERE data_acompanhamento_fk >= '2023/01'",
                "\t\tAND NOME_UNIDADE REGEXP 'Transportes' ",
                "\t\t--AND NOME_CENTROCUSTO = 'Operações'",
                "\t\tAND ESTRUTURA_CONTA IN ('4.1.1.02.1.11', '4.1.1.02.1.20', '4.1.1.06.1.02', '4.1.1.06.1.05', '4.1.1.04.1.11', '4.1.1.11.1.05', '4.1.1.90.1.06')",
                "\t\tAND COD_UNIDADE LIKE '%A' --NOT REGEXP 'A'",
                "\t\tAND NOME_CENTROCUSTO NOT REGEXP 'CORP'",
                "\t\tGROUP BY DATA_DESPESA, NOME_UNIDADE, NOME_CONTA, ESTRUTURA_CONTA",
                "\t\tHAVING DESPESA < 0",
                "\t\t) t1",
                "\t",
                "\t\tLEFT JOIN (SELECT NOME_UNIDADE, UNIDADE_NEGOCIO_NOVA, DIVISOR FROM(",
                "\t\t\tSELECT 'Transportes e Comércio Ltda' AS NOME_UNIDADE, 'SC - MULTILOG APOIO TRANSPORTES' AS UNIDADE_NEGOCIO_NOVA, 2 AS DIVISOR",
                "\t\t\tUNION ALL",
                "\t\t\tSELECT 'Transportes e Comércio Ltda' ,'SP - MULTILOG APOIO TRANSPORTES', 2)) t2",
                "\t\t",
                "\t\tON t1.NOME_UNIDADE = t2.NOME_UNIDADE) t3",
                "",
                "UNION ALL",
                "",
                "SELECT t3.DATA_DESPESA, t3.NOME_CONTA, 'Folha' AS CENTRO_CUSTO, t3.UNIDADE_NEGOCIO AS UNIDADE_NEGOCIO_F, try_divide(t3.DESPESA, t3.DIVISOR) AS DESPESA",
                "FROM (",
                "\tSELECT ",
                "\tCONCAT(DATE_FORMAT(t1.DATA_DESPESA, 'y'), '/', DATE_FORMAT(t1.DATA_DESPESA, 'MM')) AS DATA_DESPESA,",
                "\tt1.Grupo AS NOME_CONTA,",
                "\tt1.DESPESA, ",
                "\tCOALESCE(t2.UNIDADE_NEGOCIO, t1.NOME_UNIDADE) AS UNIDADE_NEGOCIO,",
                "\tCOALESCE(t2.DIVISOR, 1) AS DIVISOR",
                "\tFROM (",
                "\t\tSELECT ",
                "\t\tmes AS DATA_DESPESA,",
                "\t\tGrupo,",
                "\t\tSUM(-valor) AS DESPESA,",
                "\t\tCASE ",
                "\t\tWHEN agrupador_regional = 'SP' THEN 'MULTILOG BRASIL - TRANSPORTE SP'",
                "\t\tWHEN agrupador_regional = 'BA' THEN 'MULTILOG NORDESTE LTDA'",
                "\t\tELSE UPPER(agrupador_regional)",
                "\t\tEND AS NOME_UNIDADE",
                "\t\tFROM ouro_senior.custo_frota_resumido",
                "\t\tWHERE mes >= '2023-01-01'",
                "\t\tGROUP BY mes, agrupador_regional, grupo) t1",
                "\t",
                "\t\tLEFT JOIN (SELECT NOME_UNIDADE, UNIDADE_NEGOCIO, DIVISOR FROM(",
                "\t\t\tSELECT 'SC+PR' AS NOME_UNIDADE, 'MULTILOG BRASIL - TRANSPORTE SC' AS UNIDADE_NEGOCIO, 1.1251 AS DIVISOR ",
                "\t\t\tUNION ALL",
                "\t\t\tSELECT 'SC+PR', 'MULTILOG BRASIL - TRANSPORTE PR', 9.0009)) t2",
                "\t",
                "\t\tON t1.NOME_UNIDADE = t2.NOME_UNIDADE) t3\", null, [EnableFolding=true]),",
                "    #\"Tipo Alterado\" = Table.TransformColumnTypes(Fonte,{{\"DATA_DESPESA\", type date}}),",
                "    #\"Valor Substituído\" = Table.ReplaceValue(#\"Tipo Alterado\",null,\"Sem Conta Definida\",Replacer.ReplaceValue,{\"NOME_CONTA\"}),",
                "    #\"Colocar Cada Palavra Em Maiúscula\" = Table.TransformColumns(#\"Valor Substituído\",{{\"NOME_CONTA\", Text.Proper, type text}})",
                "in",
                "    #\"Colocar Cada Palavra Em Maiúscula\""
              ],
              "type": "m"
            }
          }
        ]
      },
      {
        "name": "fato_despesa_carta_frete",
        "annotations": [
          {
            "name": "PBI_ResultType",
            "value": "Table"
          }
        ],
        "changedProperties": [
          {
            "property": "IsHidden"
          }
        ],
        "columns": [
          {
            "name": "NUM_ROMANEIO",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "isHidden": true,
            "lineageTag": "2ea73436-c64d-4c35-a099-1a2fd0ffe558",
            "sourceColumn": "NUM_ROMANEIO",
            "summarizeBy": "none"
          },
          {
            "name": "DATA_EMISSAO_C",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "UnderlyingDateTimeDataType",
                "value": "Date"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "dateTime",
            "formatString": "Short Date",
            "isHidden": true,
            "lineageTag": "51190e35-af3a-4d97-8cea-ebdfae00ee84",
            "sourceColumn": "DATA_EMISSAO_C",
            "summarizeBy": "none"
          },
          {
            "name": "COB_RAZAO_SOCIAL_C",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "isHidden": true,
            "lineageTag": "f3b5e8d8-5c54-482c-bc1a-433bd58d56e8",
            "sourceColumn": "COB_RAZAO_SOCIAL_C",
            "summarizeBy": "none"
          },
          {
            "name": "UNIDADE_NEGOCIO_C",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "isHidden": true,
            "lineageTag": "acc77ce1-7d92-43cb-90dc-14d66d816f93",
            "sourceColumn": "UNIDADE_NEGOCIO_C",
            "summarizeBy": "none"
          },
          {
            "name": "CENTRO_CUSTO_GERENCIAL_C",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "isHidden": true,
            "lineageTag": "7dbcf19e-f27d-45ad-a456-7d55bd1c3905",
            "sourceColumn": "CENTRO_CUSTO_GERENCIAL_C",
            "summarizeBy": "none"
          },
          {
            "name": "source_C",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "isHidden": true,
            "lineageTag": "c1d8bd75-f84e-49d4-88a8-13ba9a2a1a98",
            "sourceColumn": "source_C",
            "summarizeBy": "none"
          },
          {
            "name": "DATA_EMISSAO_M",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "UnderlyingDateTimeDataType",
                "value": "Date"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "dateTime",
            "formatString": "Short Date",
            "isHidden": true,
            "lineageTag": "6b4dd95a-7a53-4279-8f44-5a7f2c41517e",
            "sourceColumn": "DATA_EMISSAO_M",
            "summarizeBy": "none"
          },
          {
            "name": "CONTAGEM_C",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "isHidden": true,
            "lineageTag": "63dbe6ca-f988-4d21-ae1e-5e91f84925e5",
            "sourceColumn": "CONTAGEM_C",
            "summarizeBy": "sum"
          },
          {
            "name": "FRETE_VALOR_C",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "double",
            "isHidden": true,
            "lineageTag": "120c4638-a518-4c45-ac55-66218251341b",
            "sourceColumn": "FRETE_VALOR_C",
            "summarizeBy": "sum"
          },
          {
            "name": "PLACA_TRACAO_C",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "isHidden": true,
            "lineageTag": "049fb45f-6c50-448e-a8f7-3d5b881db3a2",
            "sourceColumn": "PLACA_TRACAO_C",
            "summarizeBy": "none"
          },
          {
            "name": "PROP_CNPJ_CPF_C",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "isHidden": true,
            "lineageTag": "d594bcfb-b699-4e7f-b67a-f9a6c002ece2",
            "sourceColumn": "PROP_CNPJ_CPF_C",
            "summarizeBy": "none"
          },
          {
            "name": "Frota?",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "expression": [
              "",
              "VAR frota_ou_terceiro = RELATED( dimPLACA_FROTA[Placa] )",
              "RETURN",
              "IF( ",
              "    NOT ISBLANK( frota_ou_terceiro ), -- Se encontrar a placa na tabela de placas frota, retorna Frota",
              "    \"Frota\",",
              "    IF( LEN( fato_despesa_carta_frete[PROP_CNPJ_CPF_C]) = 11, -- Se o numero de caracteres na razao social proprietario for igual a 11 é CPF, caso contrário é CNPJ.",
              "        \"Motorista\", -- Se for CPF, Retorna Motorista",
              "        \"Transportadora\" -- Caso contrário é CNPJ, e retorna Transortadora",
              ")",
              ")"
            ],
            "isDataTypeInferred": true,
            "isHidden": true,
            "lineageTag": "21b10630-3c78-4235-8352-b3b22173d2fa",
            "summarizeBy": "none",
            "type": "calculated"
          },
          {
            "name": "CENTRO_CUSTO_C",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "isHidden": true,
            "lineageTag": "73b243da-4b70-45c9-afe5-1884ba5edfb6",
            "sourceColumn": "CENTRO_CUSTO_C",
            "summarizeBy": "none"
          },
          {
            "name": "Chave_data_unidade",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "expression": "YEAR(fato_despesa_carta_frete[DATA_EMISSAO_C]) & \"-\" &  FORMAT( fato_despesa_carta_frete[DATA_EMISSAO_C] , \"mmm\" ) & \"|\" & fato_despesa_carta_frete[UNIDADE_NEGOCIO_C]",
            "isDataTypeInferred": true,
            "isHidden": true,
            "lineageTag": "ef9c61f9-9cff-4699-b468-50493be87685",
            "summarizeBy": "none",
            "type": "calculated"
          }
        ],
        "isHidden": true,
        "lineageTag": "7bf90f70-aecd-465e-a762-a4a55380ce59",
        "partitions": [
          {
            "name": "fato_despesa_carta_frete-9c4a897e-9f88-4ed4-a9af-ac2a20098998",
            "mode": "import",
            "source": {
              "expression": [
                "let",
                "    Fonte = Value.NativeQuery(Databricks.Catalogs(\"adb-1220993250695902.2.azuredatabricks.net\", \"/sql/1.0/warehouses/6b94e3b6ef796336\", [Catalog=\"hive_metastore\", Database=null, EnableAutomaticProxyDiscovery=null]){[Name=\"hive_metastore\",Kind=\"Database\"]}[Data], \"",
                "\tSELECT ",
                "t1.NUM_ROMANEIO, ",
                "MAX(COALESCE(CFRETE.DATA_EMISSAO, CTE_DATA.DATA_EMISSAO, NF_DATA.DATA_EMISSAO, CFRETE_SEM_ROMANEIO.DATA_EMISSAO)) AS DATA_EMISSAO_C,",
                "MAX(COALESCE(CTE.DATA_EMISSAO_M, NF.DATA_EMISSAO_M)) AS DATA_EMISSAO_M,",
                "COALESCE(CTE.COB_RAZAO_SOCIAL, NF.COB_RAZAO_SOCIAL) AS COB_RAZAO_SOCIAL_C,",
                "COALESCE(CTE.UNIDADE_NEGOCIO, NF.UNIDADE_NEGOCIO, CFRETE.UNIDADE_NEGOCIO, CFRETE_SEM_ROMANEIO.UNIDADE_NEGOCIO) AS UNIDADE_NEGOCIO_C,",
                "COALESCE(CTE.CENTRO_CUSTO_GERENCIAL, NF.DESCRICAO_ORGANIZACIONAL, CFRETE.CENTRO_CUSTO_GERENCIAL, CFRETE_SEM_ROMANEIO.CENTRO_CUSTO_GERENCIAL) AS CENTRO_CUSTO_GERENCIAL_C,",
                "COALESCE(CTE.source, NF.source, CFRETE.source, CFRETE_SEM_ROMANEIO.source) AS source_C,",
                "COALESCE(CTE.PLACA_TRACAO, NF.PLACA_TRACAO ) AS PLACA_TRACAO_C, -- verificar",
                "COALESCE(CTE.PROP_CNPJ_CPF, NF.PROP_CNPJ_CPF) AS PROP_CNPJ_CPF_C, --verificar",
                "COALESCE(CTE.CENTRO_CUSTO, NF.CENTRO_CUSTO) AS CENTRO_CUSTO_C, --verificar",
                "COALESCE(CTE_DATA.CONTAGEM, NF_DATA.CONTAGEM, 1) AS CONTAGEM_C,",
                "COALESCE(CFRETE.FRETE_VALOR, CFRETE_SEM_ROMANEIO.FRETE_VALOR) AS FRETE_VALOR_C",
                "",
                "FROM (",
                "\tSELECT ",
                "\t\tCASE WHEN NUM_ROMANEIO IS NULL THEN CONCAT(NUM_CONHECIMENTO, 'CTE') ELSE NUM_ROMANEIO END AS NUM_ROMANEIO ",
                "\t\tFROM ouro_transportes.fato_carta_frete ",
                "\t\tWHERE DATA_CANCELAMENTO IS NULL AND DATA_EMISSAO >= '2021-01-01'",
                "\t\tUNION ",
                "\t\tSELECT DISTINCT(NUM_ROMANEIO) ",
                "\t\tFROM ouro_transportes.fato_cte ",
                "\t\tWHERE CANCELADA = 'Não' AND DATA_EMISSAO >= '2021-01-01'",
                "\t\tUNION",
                "\t\tSELECT DISTINCT(NUM_ROMANEIO) ",
                "\t\tFROM ouro_transportes.fato_nf ",
                "\t\tWHERE CANCELADA = 'Não' AND DATA_EMISSAO >= '2021-01-01'",
                "\t\t) t1",
                "",
                "\tLEFT JOIN (SELECT NUM_ROMANEIO, MAX(DATA_EMISSAO) AS DATA_EMISSAO_M, COB_RAZAO_SOCIAL, UNIDADE_NEGOCIO, CENTRO_CUSTO_GERENCIAL, source,",
                "            TRIM(UPPER(REPLACE(REPLACE(PLACA_TRACAO,'-', ''),' ',''))) AS PLACA_TRACAO,",
                "\t\t\t\t\t\treplace(replace(replace(PROP_CNPJ_CPF, '-', ''),'/',''),'.','') as PROP_CNPJ_CPF,",
                "\t\t\t\t\t\tCENTRO_CUSTO",
                "\t\t\t\t\t\tFROM ouro_transportes.fato_cte ",
                "\t\t\t\t\t\tWHERE STATUS_CTE IN ( 'Autorizado o uso do CT-e', 'Autorizado o uso do CTe','Autorizado o uso do CT-e.')",
                "\t\t\t\t\t\tAND CANCELADA = 'Não' ",
                "\t\t\t\t\t\tAND DATA_EMISSAO >= '2021-01-01'",
                "\t\t\t\t\t\tGROUP BY NUM_ROMANEIO, COB_RAZAO_SOCIAL, UNIDADE_NEGOCIO, CENTRO_CUSTO_GERENCIAL, source, PLACA_TRACAO, PROP_CNPJ_CPF, CENTRO_CUSTO",
                "\t\t\t\t\t\t) AS CTE",
                "\tON t1.NUM_ROMANEIO = CTE.NUM_ROMANEIO",
                "\t\t\t ",
                "\tLEFT JOIN (SELECT NUM_ROMANEIO, MAX(DATA_EMISSAO) AS DATA_EMISSAO_M, COB_RAZAO_SOCIAL, UNIDADE_NEGOCIO, DESCRICAO_ORGANIZACIONAL, source,",
                "            TRIM(UPPER(REPLACE(REPLACE(PLACA_TRACAO,'-', ''),' ',''))) AS PLACA_TRACAO,",
                "\t\t\t\t\t\treplace(replace(replace(PROP_CNPJ_CPF, '-', ''),'/',''),'.','') as PROP_CNPJ_CPF,",
                "\t\t\t\t\t\tCENTRO_CUSTO",
                "\t\t\t\t\t\tFROM ouro_transportes.fato_nf ",
                "\t\t\t\t\t\tWHERE CANCELADA = 'Não' ",
                "\t\t\t\t\t\tAND DATA_EMISSAO >= '2021-01-01'",
                "\t\t\t\t\t\tGROUP BY NUM_ROMANEIO, COB_RAZAO_SOCIAL, UNIDADE_NEGOCIO, DESCRICAO_ORGANIZACIONAL, source, PLACA_TRACAO, PROP_CNPJ_CPF, CENTRO_CUSTO",
                "\t\t\t\t\t\t) AS NF \t",
                "\tON t1.NUM_ROMANEIO = NF.NUM_ROMANEIO\t",
                "",
                "\tLEFT JOIN (SELECT ",
                "\t\t\t\t\t\tDISTINCT NUM_ROMANEIO,",
                "\t\t\t\t\t\tDATA_EMISSAO, ",
                "\t\t\t\t\t\tUNIDADE_NEGOCIO,",
                "\t\t\t\t\t\tCENTRO_CUSTO_GERENCIAL,",
                "\t\t\t\t\t\tsource,",
                "\t\t\t\t\t\tSUM(FRETE_CARRETEIRO) AS FRETE_VALOR -- COLOCAR MAXIMA DATA EMISSAO E VER OQ ACONTECE",
                "\t\t\t\t\t\tFROM ouro_transportes.fato_carta_frete ",
                "\t\t\t\t\t\tWHERE DATA_CANCELAMENTO IS NULL AND DATA_EMISSAO >= '2021-01-01'",
                "\t\t\t\t\t\tGROUP BY NUM_ROMANEIO, DATA_EMISSAO, UNIDADE_NEGOCIO, CENTRO_CUSTO_GERENCIAL, source",
                "\t\t\t\t\t\t) AS CFRETE \t",
                "\tON t1.NUM_ROMANEIO = CFRETE.NUM_ROMANEIO",
                "",
                "\tLEFT JOIN (SELECT ",
                "\t\t\t\t\t\tCONCAT(NUM_CONHECIMENTO, 'CTE') AS CHAVE_CONHECIMENTO, -- Apenas carta frete sem romaneio, pegar o numero conhecimento como chave",
                "\t\t\t\t\t\tDATA_EMISSAO, ",
                "\t\t\t\t\t\tUNIDADE_NEGOCIO,",
                "\t\t\t\t\t\tCENTRO_CUSTO_GERENCIAL,",
                "\t\t\t\t\t\tsource,",
                "\t\t\t\t\t\tSUM(FRETE_CARRETEIRO) AS FRETE_VALOR ",
                "\t\t\t\t\t\tFROM ouro_transportes.fato_carta_frete ",
                "\t\t\t\t\t\tWHERE source = 'LOGIX' -- Apenas no logix isso ocorre",
                "\t\t\t\t\t\tAND DATA_CANCELAMENTO IS NULL AND DATA_EMISSAO >= '2021-01-01'",
                "\t\t\t\t\t\tGROUP BY NUM_CONHECIMENTO, DATA_EMISSAO, UNIDADE_NEGOCIO, CENTRO_CUSTO_GERENCIAL, source",
                "\t\t\t\t\t\t) AS CFRETE_SEM_ROMANEIO \t",
                "\tON t1.NUM_ROMANEIO = CFRETE_SEM_ROMANEIO.CHAVE_CONHECIMENTO",
                "",
                "\tLEFT JOIN (SELECT DISTINCT NUM_ROMANEIO, ",
                "\t\t\t\t\t\tMAX(DATA_EMISSAO) AS DATA_EMISSAO, ",
                "\t\t\t\t\t\tCOUNT(DISTINCT(COB_RAZAO_SOCIAL)) AS CONTAGEM",
                "\t\t\t\t\t\tFROM ouro_transportes.fato_cte ",
                "\t\t\t\t\t\tGROUP BY NUM_ROMANEIO) AS CTE_DATA \t",
                "\tON t1.NUM_ROMANEIO = CTE_DATA.NUM_ROMANEIO\t",
                "",
                "\tLEFT JOIN (SELECT DISTINCT NUM_ROMANEIO, ",
                "\t\t\t\t\t\tMAX(DATA_EMISSAO) AS DATA_EMISSAO, ",
                "\t\t\t\t\t\tCOUNT(DISTINCT(COB_RAZAO_SOCIAL)) AS CONTAGEM",
                "\t\t\t\t\t\tFROM ouro_transportes.fato_nf ",
                "\t\t\t\t\t\tGROUP BY NUM_ROMANEIO) AS NF_DATA \t",
                "\tON t1.NUM_ROMANEIO = NF_DATA.NUM_ROMANEIO\t",
                "",
                "GROUP BY t1.NUM_ROMANEIO, COB_RAZAO_SOCIAL_C, UNIDADE_NEGOCIO_C, ",
                "CENTRO_CUSTO_GERENCIAL_C, source_C,",
                "PLACA_TRACAO_C, CFRETE.FRETE_VALOR, CONTAGEM_C, ",
                "FRETE_VALOR_C, PROP_CNPJ_CPF_C, CENTRO_CUSTO_C",
                "",
                "\t\", null, [EnableFolding=true]),",
                "    #\"Tipo Alterado\" = Table.TransformColumnTypes(Fonte,{{\"DATA_EMISSAO_C\", type date}, {\"DATA_EMISSAO_M\", type date}})",
                "   ",
                "in",
                "    #\"Tipo Alterado\""
              ],
              "type": "m"
            }
          }
        ]
      },
      {
        "name": "dimCENTRO_CUSTO",
        "annotations": [
          {
            "name": "PBI_Id",
            "value": "a3c32499f72e4b1a85ba1e1c6f99096e"
          }
        ],
        "columns": [
          {
            "name": "CENTRO_CUSTO",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "caa42bd8-516d-4fe6-b6ea-4c074178f1d7",
            "sourceColumn": "fato_cte[CENTRO_CUSTO]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          }
        ],
        "lineageTag": "82614707-699d-45ca-8d41-5ce90139b6f5",
        "partitions": [
          {
            "name": "dimCENTRO_CUSTO-308a1509-3c5e-4ecc-9da0-15b957e364cf",
            "mode": "import",
            "source": {
              "expression": [
                "",
                "DISTINCT(",
                "    UNION(",
                "        FILTER( VALUES( fato_cte[CENTRO_CUSTO] ), fato_cte[CENTRO_CUSTO] <> BLANK() ),",
                "        FILTER( VALUES( fato_nf[CENTRO_CUSTO] ), fato_nf[CENTRO_CUSTO] <> BLANK() )",
                "    )",
                ")"
              ],
              "type": "calculated"
            }
          }
        ]
      },
      {
        "name": "Analises",
        "annotations": [
          {
            "name": "PBI_Id",
            "value": "e8b9ada7aa6b4e938944a204c862e23c"
          }
        ],
        "columns": [
          {
            "name": "Analises",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "isDataTypeInferred": true,
            "isNameInferred": false,
            "lineageTag": "cf7552e6-813c-40cd-9214-988b940594f5",
            "relatedColumnDetails": {
              "groupByColumns": [
                {
                  "groupingColumn": "Analises Campos"
                }
              ]
            },
            "sortByColumn": "Analises Pedido",
            "sourceColumn": "[Value1]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "Analises Campos",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "extendedProperties": [
              {
                "name": "ParameterMetadata",
                "type": "json",
                "value": {
                  "kind": 2,
                  "version": 3
                }
              }
            ],
            "isDataTypeInferred": true,
            "isHidden": true,
            "isNameInferred": false,
            "lineageTag": "8143e510-9d3f-49f5-b18a-d48a3e4c49a7",
            "sortByColumn": "Analises Pedido",
            "sourceColumn": "[Value2]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "Analises Pedido",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "isDataTypeInferred": true,
            "isHidden": true,
            "isNameInferred": false,
            "lineageTag": "38c94171-fd66-4448-8607-201991645a6b",
            "sourceColumn": "[Value3]",
            "summarizeBy": "sum",
            "type": "calculatedTableColumn"
          }
        ],
        "lineageTag": "8bd879ef-c8b9-4cdc-bef0-53cf62edcec8",
        "partitions": [
          {
            "name": "Analises-3198891d-ade4-4dfc-a067-bfee6e8274ba",
            "mode": "import",
            "source": {
              "expression": [
                "{",
                "    (\"Receita Bruta\", NAMEOF('Medidas'[$ Receita Bruta (FINAL)]), 0),",
                "    (\"Receita Líquida\", NAMEOF('Medidas'[$ Receita Líquida]), 1),",
                "    (\"Despesa\", NAMEOF('Medidas'[$ Despesa Rateio]), 2),",
                "    (\"Ticket Medio\", NAMEOF('Medidas'[$ Ticket Medio (SIMPLIFICADO)]), 3),",
                "    (\"Qtd Viagens\", NAMEOF('Medidas'[Qtd Viagens]), 4)",
                "}"
              ],
              "type": "calculated"
            }
          }
        ]
      },
      {
        "name": "dimOPERACAO",
        "annotations": [
          {
            "name": "PBI_Id",
            "value": "3a97b34f17834902bef0c459b8402720"
          }
        ],
        "columns": [
          {
            "name": "OPERACAO",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "0ebaac31-3504-4eb1-890b-b55205c6ddd4",
            "sourceColumn": "fato_cte[OPERACAO]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "Operacao Unificada",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "expression": [
              "",
              "IF ( CONTAINSSTRING( dimOPERACAO[OPERACAO] , \"LOTACAO\"),",
              "    \"Lotação\",",
              "    IF ( CONTAINSSTRING( dimOPERACAO[OPERACAO] , \"FRAC\"),",
              "    \"Fracionado\",",
              "    IF ( CONTAINSSTRING( dimOPERACAO[OPERACAO] , \"DEVOLUCAO\"),",
              "    \"Devolução\",",
              "    \"Normal\")",
              "    ))"
            ],
            "isDataTypeInferred": true,
            "lineageTag": "5399763b-bb0f-4f0a-aeb1-949515286c09",
            "summarizeBy": "none",
            "type": "calculated"
          }
        ],
        "lineageTag": "abfc2ca6-3a35-4e73-a7ae-703e05022990",
        "partitions": [
          {
            "name": "dimOPERACAO-31b91c69-86ff-4b1e-9e72-44cc9abe3846",
            "mode": "import",
            "source": {
              "expression": [
                "",
                "DISTINCT(",
                "    UNION(",
                "        FILTER( VALUES( fato_cte[OPERACAO] ), fato_cte[OPERACAO] <> BLANK() ),",
                "        FILTER( VALUES( fato_nf[OPERACAO] ), fato_nf[OPERACAO] <> BLANK() ),",
                "        FILTER( VALUES( fato_carta_frete[OPERACAO] ), fato_carta_frete[OPERACAO] <> BLANK() )",
                "    )",
                ")"
              ],
              "type": "calculated"
            }
          }
        ]
      },
      {
        "name": "fato_frota_dias_sem_fat",
        "annotations": [
          {
            "name": "PBI_Id",
            "value": "a3621c970aeb4067a2f7cbfd63a824c2"
          }
        ],
        "columns": [
          {
            "name": "DataUltimaReceita",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "dateTime",
            "expression": [
              "",
              "CALCULATE(",
              "    MAX(fato_frota_dias_sem_fat[Date]), ",
              "    FILTER( fato_frota_dias_sem_fat,",
              "            fato_frota_dias_sem_fat[Placa] = EARLIER(fato_frota_dias_sem_fat[Placa]) && fato_frota_dias_sem_fat[Date] < EARLIER(fato_frota_dias_sem_fat[Date])",
              "))"
            ],
            "formatString": "General Date",
            "isDataTypeInferred": true,
            "lineageTag": "515d5a95-1916-4ac0-a053-6f60e1c0bd9a",
            "summarizeBy": "none",
            "type": "calculated"
          },
          {
            "name": "DiasEntreUltimosFaturamentos",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "expression": "DATEDIFF(fato_frota_dias_sem_fat[DataUltimaReceita], fato_frota_dias_sem_fat[Date],DAY)",
            "formatString": "0",
            "isDataTypeInferred": true,
            "lineageTag": "11370e6d-e1c6-4837-91d3-522fad59c230",
            "summarizeBy": "sum",
            "type": "calculated"
          },
          {
            "name": "DiasSemFatuarmentoAteHoje",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "expression": "DATEDIFF(fato_frota_dias_sem_fat[Date], TODAY(), DAY)",
            "formatString": "0",
            "isDataTypeInferred": true,
            "lineageTag": "70d1f31c-3d1b-4bc7-a640-e9c95d61c450",
            "summarizeBy": "sum",
            "type": "calculated"
          },
          {
            "name": "Placa",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "db842b9a-2c29-48a3-a7ea-e621201dcbac",
            "sourceColumn": "dimPLACA_FROTA[Placa]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "Date",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "dateTime",
            "formatString": "General Date",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "1f023ab2-c61b-4b56-bd9c-ea3e72a36afb",
            "sourceColumn": "Calendario[Date]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "Unidade Negocio",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "bb1c3ddc-0218-449b-af46-191339e25224",
            "sourceColumn": "dimPLACA_FROTA[Unidade Negocio]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "Receita",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "a1e2f958-6a1a-4a8f-aac4-6aa2a3979fec",
            "sourceColumn": "[Receita]",
            "summarizeBy": "sum",
            "type": "calculatedTableColumn"
          }
        ],
        "lineageTag": "f0921c59-899a-44d6-8fef-8fca63475ccc",
        "partitions": [
          {
            "name": "fato_frota_dias_sem_fat-598474b2-d886-42c9-9a69-065d543355b8",
            "mode": "import",
            "source": {
              "expression": [
                "",
                "",
                "SUMMARIZECOLUMNS(",
                "    dimPLACA_FROTA[Placa], Calendario[Date], dimPLACA_FROTA[Unidade Negocio],",
                "    \"Receita\", [$ Receita Bruta (FROTA)]",
                "    )",
                "  "
              ],
              "type": "calculated"
            }
          }
        ]
      },
      {
        "name": "dimPROP_CNPJ_CPF",
        "annotations": [
          {
            "name": "PBI_Id",
            "value": "105be4cfb94b4aecaa8eb306aae80b14"
          }
        ],
        "columns": [
          {
            "name": "PROP_CNPJ_CPF",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "02e44ea1-6a51-4ded-8e79-9ab0e8660e48",
            "sourceColumn": "fato_cte[PROP_CNPJ_CPF]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          }
        ],
        "lineageTag": "f0869162-b8a0-4ea8-b4d9-76962c017fa1",
        "partitions": [
          {
            "name": "dimPROP_CNPJ_CPF",
            "mode": "import",
            "source": {
              "expression": [
                "",
                "DISTINCT(",
                "    UNION(",
                "        FILTER( VALUES( fato_cte[PROP_CNPJ_CPF] ), fato_cte[PROP_CNPJ_CPF] <> BLANK() ),",
                "        FILTER( VALUES( fato_nf[PROP_CNPJ_CPF] ), fato_nf[PROP_CNPJ_CPF] <> BLANK() ),",
                "        FILTER( VALUES( fato_carta_frete[CNPJ_CPF_PROPRIETARIO_VEICULO] ), fato_carta_frete[CNPJ_CPF_PROPRIETARIO_VEICULO] <> BLANK() )",
                "    )",
                ")"
              ],
              "type": "calculated"
            }
          }
        ]
      },
      {
        "name": "dimPROP_RAZAO_SOCIAL",
        "annotations": [
          {
            "name": "PBI_Id",
            "value": "1a37f8289f9c40f6abf50223a5bdc583"
          }
        ],
        "columns": [
          {
            "name": "PROP_RAZAO_SOCIAL",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "fc587b9c-089a-4902-b487-6f88b99cb94f",
            "sourceColumn": "fato_cte[PROP_RAZAO_SOCIAL]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          }
        ],
        "lineageTag": "75c93238-0f29-4b59-bb15-bfb119f91b8e",
        "partitions": [
          {
            "name": "dimPROP_RAZAO_SOCIAL",
            "mode": "import",
            "source": {
              "expression": [
                "",
                "DISTINCT(",
                "    UNION(",
                "        FILTER( VALUES( fato_cte[PROP_RAZAO_SOCIAL] ), fato_cte[PROP_RAZAO_SOCIAL] <> BLANK() ),",
                "        FILTER( VALUES( fato_nf[PROP_RAZAO_SOCIAL] ), fato_nf[PROP_RAZAO_SOCIAL] <> BLANK() ),",
                "        FILTER( VALUES( fato_carta_frete[RAZAO_SOCIAL_PROPRIETARIO] ), fato_carta_frete[RAZAO_SOCIAL_PROPRIETARIO] <> BLANK() )",
                "    )",
                ")"
              ],
              "type": "calculated"
            }
          }
        ]
      },
      {
        "name": "dim_VEICULOS",
        "annotations": [
          {
            "name": "PBI_ResultType",
            "value": "Table"
          }
        ],
        "columns": [
          {
            "name": "TIPO_VEICULO",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "f3069b1c-5200-4575-9f75-dd02b2486564",
            "sourceColumn": "TIPO_VEICULO",
            "summarizeBy": "none"
          },
          {
            "name": "PARA VEICULO",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "de88669f-6aed-4415-b304-712a5e6949e5",
            "sourceColumn": "PARA VEICULO",
            "summarizeBy": "none"
          }
        ],
        "lineageTag": "cd370993-d78d-4fdf-b18f-e3dba9b15ab3",
        "partitions": [
          {
            "name": "dim_VEICULOS",
            "mode": "import",
            "source": {
              "expression": [
                "let",
                "    Fonte = Table.FromRows(Json.Document(Binary.Decompress(Binary.FromText(\"pVXLbuJAEPyVFieiJQvBXsi1GcYwiu1BzdhyXgeLWFoUwBIyfNDuKef9BP9YxhjChqcNFw7GVd1VXd1+fq4w9NGW4HCGrmCyUquwcBlOYnCiUfpnNh7FoGL9EybpBzTvk8prbQ8EZtC8DNgqDnSE20cJijz2AMPHLqcVcjqe/U7/xjBNP97GG1DrSDUI4MJGzeJQH9265VEPMzP9cJb/e1czGr92tBh1E26hg95FHtxCj7DLNV4EuGX4ASycz6MkBHsIRvObnFZgQpVkVyrizo3GdMbJPJp+Z/c9lncFFomeJGHludDP61u/J9Eyyttr19a6Vm0dlDJfjN7Dt7Ucw/zv9aPqD0IODdQsA98YKDX4GueHYpO/koXX+FKqPSVsoZBENgVcJPE0/beMJvCyaDSMEdz9NM/GAwaSFAKTrkLhlmmdeEcy7Mor1e5kqSzT16ac5Tkxu3zox0d3Fnpd/a+9KrJL2yMCxLOaXA9z56C0W40TxwoIh3rNNQqqrqZZpegJ6ab02czpqhZJhefRmVdFnSHiCsv3EzRhjYUByQGJ8hyraOaOFsxizxMu60sY2KjQkuQgYIeTwuIUOsXFnNlufJaaInlBT0lH+tw+eSLyhbQ462exuPT8Zd5LxrXtew7sf3xePwE=\", BinaryEncoding.Base64), Compression.Deflate)), let _t = ((type nullable text) meta [Serialized.Text = true]) in type table [TIPO_VEICULO = _t, #\"PARA VEICULO\" = _t]),",
                "    #\"Tipo Alterado\" = Table.TransformColumnTypes(Fonte,{{\"TIPO_VEICULO\", type text}, {\"PARA VEICULO\", type text}})",
                "in",
                "    #\"Tipo Alterado\""
              ],
              "type": "m"
            }
          }
        ]
      },
      {
        "name": "dim_MERCADORIA",
        "annotations": [
          {
            "name": "PBI_ResultType",
            "value": "Table"
          }
        ],
        "columns": [
          {
            "name": "MERCADORIA",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "4404c9cc-a7eb-4ca4-9a1a-89bed9296b3b",
            "sourceColumn": "MERCADORIA",
            "summarizeBy": "none"
          },
          {
            "name": "PARA CONTAINER",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "f2d47b40-9d0e-44c0-bf0f-0262274c263a",
            "sourceColumn": "PARA CONTAINER",
            "summarizeBy": "none"
          }
        ],
        "lineageTag": "267a0354-6a75-44a2-8a46-56f7fe83b2c2",
        "partitions": [
          {
            "name": "dim_MERCADORIA",
            "mode": "import",
            "source": {
              "expression": [
                "let",
                "    Fonte = Table.FromRows(Json.Document(Binary.Decompress(Binary.FromText(\"rVjBbhs3EP2VgYECDiA7tmSn7ZHanZWIcMkNyVUcpzm4jRH4khSx23PdHgIfcnJPOfZX9sf6uLuyZEm2xkAOttcSOZx5897McN++3dGRS8qcLcgWO4Mdy3Zal7SbKT9R1PxFE68sm2c77wZvd7AsKm3Z0/AAaxf/5v4NPvrlj4OD4Y+0R5XyijoLtvnHUcWes+brjM2KmaN1M0dzM9NsbTHp0n2Xc4ebTa2d3ZoKzkS1DRodXFT2Vc2r0Nx9eufl8MX+wcHBBpdm6lR/n/iOHjK2FqGNHoYLUzvP0VHOCDeXbFw+q/D31nvmov3iQTR79B9FNOI5wA7bTG+Fv/vQc+H1hL3K04acA3yacqZzR7uVyj0wW8/WGhMez1hz3doLtSmab15nG/fOQ1/G2OhXNXYG0rYwqmyuZ6zD9s0BWzlUWBCdV+VWINJhbHimcmQ0kKqjq7yr2LRnI79G2eaLIuWjzmqj0qeZK2msIvsWaGnihw8lfrgh+lCPQ2z+TrlMtNUTF1THZ0cla0eqHGu2kQdkmq8JKTUgu8/7UniX8/KvXc3LxkgStJlTWRSBupeoO4OLZFU1jduRKhXCsCrQc2I8VarE5vtugQjZS/Lp10bvkPccy36Cxl5PhF6qzGujOi2P64jnAQgU1VgbfYp0i2sCgyFpC5JCZVqtDAVdVobDYKpz704S4DilcrG5DkFabprbu40gpjZsxT4FNgV1dDac09iBuEYXMciSnUMYE/BciGTJcRlMTlgKQ+zImOvMOO9QbUB725WLQWBJzQgLSke/wczWEJIBV0cPeausLlulp4LAprlJFrtiYJPW2OxlzXVe6u1Wo03AvIFuUS0UvfQazKKXMviTNt2JKhCMlMsM/yE7KT+0s22J01He+/rCdwcMBNt8K1F/AqW5KLJFDrpUSE1GRvPqe6qSs7tCfViIY4ZUX6MV027b64va5vjmmbCsTQEylIsfaBiKMUyxucmshDqdN0s1q6VKhHjQKGqYUM0XuCQNCzJCqdhLsgUYglzeffukGaZvG26pv5rUQty+oMt2JqbsxxqJ3q7yxQBxtHHcu2e9L5apfizXFFkmN41mkvRZjeQ/NNFt8pLScanAcGyHFAfbiS5hQKG5bceHQWrIuyU0X0P8sNwvX20C2ytTgmRBddiHh4PUYOs5tSQxahsAakoY7c5ru1AgUWMJqiHN2Ft9ykHkdl/QqS/F9R3CbQAir6e6csmI7nZmymRyjqeRVvmxs31bjhi41IksYoXNetZOe31RW5lIVT+QigozCiRHUnR4jIHS0fGxWKb12OsCNST5n2OSspx0V6ZEkoNC2muoSK4qg5iWB50nVKTlxl4KO3tCcawhSL/gvBJRvju29s2NxjTWEz9rvlWpEYOEzfWkFjqg1q8fwovphvvzg6MHOuhUw2ZqqGiQqUMKJNJ3P8yz7OVNzxd1yWGufpcuLdmrGvcDwVS3PCY0t1q+I/NvDAiX0JThXuGeIE30xtE5lU2Hu0CvOuISWQzo+WG1lz5C+YkCSrhUyNbPsQXDcl3UIQ2AUoT64RMDYjst0vHoB6mTFatsSqWyE5duODMnJsO9a2J/IwR08wvjoAdPpUa029wE8JLb4aRTRfFcxu6OoTSOZlpJLwPjVPdT2+KVki/jm4EnGMVQN22qAEuu90AXLhTNbQv1cwoIOkVVrqb6sbvRH79eXjX/ffzt4uySfj//fPHh0yWe3l/8ef45PfSl99QZOhz9LK7X/XjcvToAGSQxJ4xfcwiIJbqxyvB39GJ/NBztj0ZUz8ifXVyev6fs09nVxccPVJ5dXZH+eP75StSE+aSdbFAmvCtV7GQW7t4bOFkrX7xSQReVzcXh/liVubHfzp62drRjg+DlzdKtb8GHRWSywJYklOivKhAt6YgItzWkon3rcu+di7Tpa2hGTbAo/X90IBy1psq4bmqhw8MXwrMSYL3S2vF5AvUImbelozw90uGGSJ/wVjb5hBRAysSVjJybJpuHd737Hw==\", BinaryEncoding.Base64), Compression.Deflate)), let _t = ((type nullable text) meta [Serialized.Text = true]) in type table [MERCADORIA = _t, #\"PARA CONTAINER\" = _t]),",
                "    #\"Tipo Alterado\" = Table.TransformColumnTypes(Fonte,{{\"MERCADORIA\", type text}, {\"PARA CONTAINER\", type text}})",
                "in",
                "    #\"Tipo Alterado\""
              ],
              "type": "m"
            }
          }
        ]
      },
      {
        "name": "dimMOTORISTA",
        "annotations": [
          {
            "name": "PBI_ResultType",
            "value": "Table"
          }
        ],
        "columns": [
          {
            "name": "NOME_MOTORISTA",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "ac996bc8-f505-44e7-a14b-3faa5314aed4",
            "sourceColumn": "NOME_MOTORISTA",
            "summarizeBy": "none"
          },
          {
            "name": "CNPJ_CPF_MOTORISTA_C",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "b5ea4034-8ea4-4c1c-a15e-484fd6d845fa",
            "sourceColumn": "CNPJ_CPF_MOTORISTA_C",
            "summarizeBy": "none"
          }
        ],
        "lineageTag": "a8b44684-a895-4390-a192-9e976efb7c24",
        "partitions": [
          {
            "name": "dimMOTORISTA",
            "mode": "import",
            "source": {
              "expression": [
                "let",
                "    Fonte = Value.NativeQuery(Databricks.Catalogs(\"adb-1220993250695902.2.azuredatabricks.net\", \"/sql/1.0/warehouses/6b94e3b6ef796336\", [Catalog=\"hive_metastore\", Database=null, EnableAutomaticProxyDiscovery=null]){[Name=\"hive_metastore\",Kind=\"Database\"]}[Data], \"",
                "  ",
                "  with get_motoristas_unicos as (",
                "",
                "  select distinct NOME_MOTORISTA from ouro_transportes.fato_cte",
                "  union ",
                "  select distinct NOME_MOTORISTA from ouro_transportes.fato_nf",
                "  union",
                "  select distinct NOME_MOTORISTA from ouro_transportes.fato_carta_frete",
                ")",
                "",
                "select distinct ",
                "trim(gmu.NOME_MOTORISTA) as NOME_MOTORISTA, ",
                "gcpf.CNPJ_CPF_MOTORISTA_C",
                "from get_motoristas_unicos gmu",
                "left join (",
                "  select distinct ",
                "  trim(NOME_MOTORISTA) as NOME_MOTORISTA, ",
                "  max(CNPJ_CPF_MOTORISTA) as CNPJ_CPF_MOTORISTA_C ",
                "  from ouro_transportes.fato_carta_frete",
                "  group by all",
                ") gcpf",
                "",
                "on trim(gmu.NOME_MOTORISTA) = trim(gcpf.NOME_MOTORISTA)",
                "and gmu.NOME_MOTORISTA is not null",
                "and gcpf.NOME_MOTORISTA is not null",
                "",
                "    \", null, [EnableFolding=true]),",
                "    #\"Duplicatas Removidas\" = Table.Distinct(Fonte, {\"NOME_MOTORISTA\"}),",
                "    #\"Linhas Filtradas\" = Table.SelectRows(#\"Duplicatas Removidas\", each [NOME_MOTORISTA] <> null and [NOME_MOTORISTA] <> \"\")",
                "   ",
                "in",
                "    #\"Linhas Filtradas\""
              ],
              "type": "m"
            }
          }
        ]
      },
      {
        "name": "dim_CONHECIMENTO_NF",
        "annotations": [
          {
            "name": "PBI_ResultType",
            "value": "Table"
          }
        ],
        "columns": [
          {
            "name": "CHAVE_CONHECIMENTO_NF",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "1f35291b-6edc-4f81-aa73-f5fb05bc4512",
            "sourceColumn": "CHAVE_CONHECIMENTO_NF",
            "summarizeBy": "none"
          },
          {
            "name": "PEDIDO_SHIPMENT",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "392e4a4f-7a46-405c-871f-10f180bb7d5e",
            "sourceColumn": "PEDIDO_SHIPMENT",
            "summarizeBy": "none"
          },
          {
            "name": "DOCUMENTO",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "244dcec0-541f-4f8f-9870-dc224ae1ece7",
            "sourceColumn": "DOCUMENTO",
            "summarizeBy": "none"
          }
        ],
        "lineageTag": "ac97761e-85e4-4b10-97bb-0367d80964eb",
        "partitions": [
          {
            "name": "dim_CONHECIMENTO_NF",
            "mode": "import",
            "source": {
              "expression": [
                "let",
                "    Fonte = Value.NativeQuery(Databricks.Catalogs(\"adb-1220993250695902.2.azuredatabricks.net\", \"/sql/1.0/warehouses/6b94e3b6ef796336\", [Catalog=\"hive_metastore\", Database=null, EnableAutomaticProxyDiscovery=null]){[Name=\"hive_metastore\",Kind=\"Database\"]}[Data], ",
                "    \"select distinct",
                "    tf.CHAVE_CONHECIMENTO_NF,",
                "    tf.DOCUMENTO,",
                "    tf.PEDIDO_SHIPMENT",
                "from(",
                "    select distinct ",
                "    concat(NUM_ROMANEIO, UNIDADE_NEGOCIO, cast(array_agg(distinct NUM_CONHECIMENTO) as string)) AS CHAVE_CONHECIMENTO_NF,",
                "    cast(NOTAS_FISCAIS as string) as DOCUMENTO,",
                "    PEDIDO_SHIPMENT",
                "    --COUNT(DISTINCT NOTAS_FISCAIS) AS contagem_distinta_notas",
                "    from ouro_transportes.fato_cte",
                "    where data_emissao >= '2023-01-01'",
                "    and source = 'KMM'",
                "    and NUM_ROMANEIO is not null ",
                "    and NUM_CONHECIMENTO is not null",
                "    and STATUS_CTE is not null",
                "   ",
                "    group by NUM_ROMANEIO, UNIDADE_NEGOCIO, NOTAS_FISCAIS, PEDIDO_SHIPMENT",
                "    --having contagem_distinta_notas >=2",
                "",
                " union all",
                "",
                "    select distinct ",
                "    concat(NUM_ROMANEIO, UNIDADE_NEGOCIO, '[]') AS CHAVE_CONHECIMENTO_NF,",
                "    cast(array_agg(distinct NOTAS_FISCAIS) as string) as DOCUMENTO,",
                "    null as PEDIDO_SHIPMENT",
                "    --count(distinct NOTAS_FISCAIS) AS contagem_distinta_notas",
                "    from ouro_transportes.fato_nf",
                "    where data_emissao >= '2023-01-01'",
                "    and source = 'KMM'",
                "    and NUM_ROMANEIO is not null ",
                "    and NUM_NOTA_FISCAL is not null",
                "    --and NUM_ROMANEIO = '774413'",
                "    group by all",
                "",
                ") tf\", null, [EnableFolding=true]),",
                "    #\"Duplicatas Removidas\" = Table.Distinct(Fonte, {\"CHAVE_CONHECIMENTO_NF\"})",
                "   ",
                "in",
                "    #\"Duplicatas Removidas\""
              ],
              "type": "m"
            }
          }
        ]
      },
      {
        "name": "dimCENTRO_CUSTO_ROMANEIO",
        "annotations": [
          {
            "name": "PBI_Id",
            "value": "974e57bb785e4e3392f8cd39f67681a9"
          }
        ],
        "columns": [
          {
            "name": "CENTROS_CUSTO_ROMANEIO",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "6b4b5a81-08a5-4ef3-a29c-ff69954bdfc2",
            "sourceColumn": "fato_cte[CENTROS_CUSTO_ROMANEIO]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "PARA",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "expression": [
              "",
              "VAR centro_custo_ajustado = ",
              "TRIM(SUBSTITUTE(SUBSTITUTE(dimCENTRO_CUSTO_ROMANEIO[CENTROS_CUSTO_ROMANEIO], \"Padrão\", \"C.C Indefinido\"),\",\", \"+\"))",
              "",
              "RETURN",
              "centro_custo_ajustado",
              ""
            ],
            "isDataTypeInferred": true,
            "lineageTag": "b6a2f1a4-d7f5-4001-8bfb-5cb6efec161c",
            "summarizeBy": "none",
            "type": "calculated"
          },
          {
            "name": "PARA SEM UF",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "expression": [
              "",
              "VAR centro_custo_sem_uf =  ",
              "TRIM(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(dimCENTRO_CUSTO_ROMANEIO[PARA], \"SP\", \"\"), \"SC\", \"\"),\"PR\", \"\"),\"BA\", \"\"))",
              "",
              "RETURN",
              "SWITCH(",
              "    TRUE(),",
              "    centro_custo_sem_uf IN {\"DTA+ INTC\", \"INTC+ DTA\"}, \"DTA+ INTC\",",
              "    centro_custo_sem_uf",
              ")",
              ""
            ],
            "isDataTypeInferred": true,
            "lineageTag": "402fc517-c0d8-4909-a0be-cf5cd48cd161",
            "summarizeBy": "none",
            "type": "calculated"
          }
        ],
        "lineageTag": "d1542313-38cd-4fdc-abe7-c8cee9739a7b",
        "partitions": [
          {
            "name": "dimCENTRO_CUSTO_ROMANEIO",
            "mode": "import",
            "source": {
              "expression": [
                "",
                "DISTINCT(",
                "    UNION(",
                "        FILTER( VALUES( FATO_CTE[CENTROS_CUSTO_ROMANEIO] ), FATO_CTE[CENTROS_CUSTO_ROMANEIO] <> BLANK() ),",
                "        FILTER( VALUES( FATO_NF[CENTROS_CUSTO_ROMANEIO]),FATO_NF[CENTROS_CUSTO_ROMANEIO]<> BLANK() )",
                "    )",
                ")"
              ],
              "type": "calculated"
            }
          }
        ]
      },
      {
        "name": "CG Inteligência Tempo",
        "calculationGroup": {
          "calculationItems": [
            {
              "name": "YoY",
              "expression": [
                "",
                "CALCULATE(",
                "    SELECTEDMEASURE(),",
                "    SAMEPERIODLASTYEAR(Calendario[Date])",
                ")"
              ]
            }
          ]
        },
        "columns": [
          {
            "name": "Grupo de cálculo",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "941b4d93-4117-43f6-89bd-34cbde705d8c",
            "sortByColumn": "Ordinal",
            "sourceColumn": "Name",
            "summarizeBy": "none"
          },
          {
            "name": "Ordinal",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "80181b1a-a985-4820-9e1a-5110d160adfd",
            "sourceColumn": "Ordinal",
            "summarizeBy": "sum"
          }
        ],
        "lineageTag": "459b89cb-45a5-4bec-a2d9-cb29243266fc",
        "partitions": [
          {
            "name": "CG Inteligência Tempo",
            "mode": "import",
            "source": {
              "type": "calculationGroup"
            }
          }
        ]
      }
    ]
  }
}